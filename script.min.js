const _0x55984a=_0x594c;(function(_0x459ae4,_0x42e218){const _0x306f01=_0x594c,_0x15700b=_0x459ae4();while(!![]){try{const _0x17d78d=parseInt(_0x306f01(0x28b))/0x1+-parseInt(_0x306f01(0x29a))/0x2*(parseInt(_0x306f01(0x2a6))/0x3)+-parseInt(_0x306f01(0x1e2))/0x4*(-parseInt(_0x306f01(0x261))/0x5)+-parseInt(_0x306f01(0x218))/0x6*(-parseInt(_0x306f01(0x21e))/0x7)+parseInt(_0x306f01(0x267))/0x8*(parseInt(_0x306f01(0x2a5))/0x9)+-parseInt(_0x306f01(0x1f9))/0xa+parseInt(_0x306f01(0x22d))/0xb*(-parseInt(_0x306f01(0x216))/0xc);if(_0x17d78d===_0x42e218)break;else _0x15700b['push'](_0x15700b['shift']());}catch(_0x210327){_0x15700b['push'](_0x15700b['shift']());}}}(_0x1081,0x77e45));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';function _0x1081(){const _0x5ebf05=['reset-data-btn','\x20(พิมพ์\x20\x27primary\x27\x20หรือ\x20\x27secondary\x27):','พลศึกษา','DOMContentLoaded','includes','วิทยาศาสตร์และเทคโนโลยีเพิ่มเติม','font-mono\x20text-sm\x20whitespace-pre\x20px-1','round','64773XvTLKs','10932lMWfMH','ภาษาอังกฤษเพิ่มเติม','visual-rm',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','unshift','/artifacts/','projectId','flex\x20items-center\x20justify-between\x20p-2.5\x20bg-white\x20border\x20border-gray-300\x20rounded-lg','utils','progress-bar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-medium\x20text-gray-800\x22>','div','admin-close-btn','parse','width','readingLines','className','semesterInfo','ประถม','completion-bar','bg-green-500','</p>','4PPMdcD','bg-gray-100','ภาษาไทย','admin-btn','2741','.admin-edit-btn','rmLines','admin-error','ไม่พบผู้ใช้ที่ต้องการแก้ไข','Error\x20adding\x20password:','tab-content-','join','array','กรุณาใส่รหัสผ่าน\x20Admin:','progress-text','login-btn','ตลอดปีการศึกษา\x20','querySelector','copy-btn-3','คุณแน่ใจหรือไม่ว่าต้องการล้างข้อมูลที่อัปโหลดทั้งหมด?\x20(ไฟล์ที่อัปโหลดจะหายไป)','bg-blue-500','exists','<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-gray-700\x20mb-2\x20whitespace-nowrap\x22>ชื่อ-สกุล</div>','1742320vrkItm','SheetNames','รหัสผ่านนี้ถูกใช้แล้ว','hover:bg-green-600','welcome-message','innerHTML','password','querySelectorAll','remove','scoresLines','extractedData','admin-user-list-container','ป้องกันการทุจริต','output-scores','<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-blue-600\x20mb-2\x20whitespace-nowrap\x22>','Initialization\x20failed:','programpp-91f08','admin-name-input','ไม่สามารถอ่านไฟล์\x20','admin-template-select','programpp-91f08.firebaseapp.com','G-W19QNQQR25','.tab-btn','เกิดข้อผิดพลาดในการอ่านไฟล์\x20','nameList','pass','.admin-delete-btn','length','textarea','12DRruem','keypress','84vyGyGZ','classList','getElementById','store','map','results','53053CcxJrg','100','การงานอาชีพ','flex-shrink-0\x20p-3\x20pr-4\x20border-r-2\x20border-gray-300','รายงาน1','output-rm','Sheets','border-blue-600','body','/public/data/user_data/','find','ศิลปะ','logout-btn','รหัสผ่าน\x20Admin\x20ไม่ถูกต้อง','</div>','6886649HerNwM','createElement','AIzaSyBHmJ7M5qf20lKPTB9_aE2Ppa0-jTryuuI','text-blue-600','Debug','password-input','trimEnd','secondary','active','value','คัดลอก\x20(เฉพาะข้อมูล)','encode_cell','คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้ที่มีรหัสผ่าน\x20\x22','<p\x20class=\x22text-gray-500\x22>กำลังโหลด...</p>','read','error-message','สังคมศึกษา\x20ศาสนาและวัฒนธรรม','execCommand','.tab-content','output-reading','addEventListener','วิทยาศาสตร์และเทคโนโลยี','passwords','output-attributes','change','visual-attributes','copy-btn-4','attrLines','hidden','ภาษาอังกฤษ','\x09\x09\x09\x09','select','\x09\x09\x09\x09\x09\x09\x09','add','values','visual-scores','click','output-competency','showTab','programpp-91f08.firebasestorage.app','some','removeChild','คำเตือน:\x20การลบผู้ใช้นี้จะลบข้อมูลไฟล์ทั้งหมดที่ผู้ใช้นี้อัปโหลดไว้ด้วย\x20ยืนยันหรือไม่?','font-medium','primary','ไม่พบชีต\x20‘Home’\x20ในไฟล์:\x20','Home','/public/data/passwords/password_list','copy-btn-5','file-upload','target','\x20ได้','4085845rvqoio','Error\x20editing\x20user:','สุขศึกษาและพลศึกษา','push','template','วิทยาศาสตร์และเทคโนโลยีพื้นฐาน','752dPLoNE','ยินดีต้อนรับ,\x20','\x22\x20class=\x22admin-edit-btn\x20text-blue-500\x20hover:text-blue-700\x20font-medium\x20text-sm\x20mr-3\x22>แก้ไข</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','error','data','style','415403943738','name','appendChild','textContent','fill','compLines','\x20ข้อมูลไฟล์ที่อัปโหลดไว้ทั้งหมดจะถูกลบ\x20ยืนยันหรือไม่?','forEach','\x22\x20class=\x22admin-delete-btn\x20text-red-500\x20hover:text-red-700\x20font-medium\x20text-sm\x22>ลบ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','onerror','every','visual-competency','Enter','100\x09100\x09100','main-app','เกิดข้อผิดพลาด:\x20','ประวัติศาสตร์','error-text','คัดลอกแล้ว!','การงานอาชีพพื้นฐาน','กำลังเตรียมไฟล์...\x20(0/','ตลอดปี','ignored','สุขศึกษา','การงานอาชีพเพิ่มเติม','opacity','default-app-id','มัธยม','\x20border-r-2\x20border-dashed\x20border-gray-300','keys','409443bVGKnT','Initialization\x20failed:\x20','dataset','max','flex-shrink-0\x20p-3','progress-container','กำลังประมวลผลไฟล์\x20','\x22projectId\x22\x20not\x20provided','trim','<p\x20class=\x22text-gray-500\x22>ยังไม่มีผู้ใช้งาน</p>','semester-info','undefined','message','files','tab-btn-','394nZLyie','คุณได้เปลี่ยน\x20\x22แบบ\x22\x20ของผู้ใช้\x20','กรุณากรอกทั้งชื่อและรหัสผ่าน'];_0x1081=function(){return _0x5ebf05;};return _0x1081();}import{getAuth,signInAnonymously,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,deleteDoc,setLogLevel}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const PRIMARY_TEMPLATE=[_0x55984a(0x1e4),'คณิตศาสตร์',_0x55984a(0x242),_0x55984a(0x23d),_0x55984a(0x27d),_0x55984a(0x263),_0x55984a(0x229),_0x55984a(0x220),_0x55984a(0x24a),_0x55984a(0x2a7),'ป้องกันการทุจริต'],SECONDARY_TEMPLATE=['ภาษาไทย','คณิตศาสตร์พื้นฐาน','คณิตศาสตร์เพิ่มเติม',_0x55984a(0x266),_0x55984a(0x2a2),_0x55984a(0x23d),'ประวัติศาสตร์',_0x55984a(0x284),_0x55984a(0x29f),_0x55984a(0x229),_0x55984a(0x280),_0x55984a(0x285),'ภาษาอังกฤษพื้นฐาน','ภาษาอังกฤษเพิ่มเติม',_0x55984a(0x205)];let db,auth,appId=_0x55984a(0x287),passwordListDocRef,userDataDocRef,currentUserPassword=null,currentUserName=null,currentUserTemplate=null,activeResults=[],processedDataStore={};const loginScreen=document[_0x55984a(0x21a)]('login-screen'),adminPanel=document['getElementById']('admin-panel'),mainApp=document['getElementById'](_0x55984a(0x27b)),adminBtn=document[_0x55984a(0x21a)](_0x55984a(0x1e5)),loginBtn=document[_0x55984a(0x21a)](_0x55984a(0x1f1)),passwordInput=document[_0x55984a(0x21a)](_0x55984a(0x232)),loginError=document['getElementById']('login-error'),logoutBtn=document['getElementById'](_0x55984a(0x22a)),resetDataBtn=document[_0x55984a(0x21a)](_0x55984a(0x29d)),adminCloseBtn=document['getElementById'](_0x55984a(0x2b2)),adminNameInput=document[_0x55984a(0x21a)](_0x55984a(0x20a)),adminPassInput=document[_0x55984a(0x21a)]('admin-pass-input'),adminTemplateSelect=document['getElementById'](_0x55984a(0x20c)),adminAddBtn=document[_0x55984a(0x21a)]('admin-add-btn'),adminUserListContainer=document[_0x55984a(0x21a)](_0x55984a(0x204)),adminError=document[_0x55984a(0x21a)](_0x55984a(0x1e9)),fileInput=document[_0x55984a(0x21a)](_0x55984a(0x25e)),resultsDiv=document[_0x55984a(0x21a)](_0x55984a(0x21d)),errorDiv=document['getElementById'](_0x55984a(0x23c)),errorText=document['getElementById'](_0x55984a(0x27e)),outputScores=document[_0x55984a(0x21a)](_0x55984a(0x206)),outputReading=document['getElementById'](_0x55984a(0x240)),outputRm=document[_0x55984a(0x21a)](_0x55984a(0x223)),outputAttributes=document[_0x55984a(0x21a)](_0x55984a(0x244)),outputCompetency=document[_0x55984a(0x21a)](_0x55984a(0x252)),visualScores=document[_0x55984a(0x21a)](_0x55984a(0x250)),visualReading=document[_0x55984a(0x21a)]('visual-reading'),visualRm=document[_0x55984a(0x21a)](_0x55984a(0x2a8)),visualAttributes=document[_0x55984a(0x21a)](_0x55984a(0x246)),visualCompetency=document[_0x55984a(0x21a)](_0x55984a(0x278)),copyBtn1=document[_0x55984a(0x21a)]('copy-btn-1'),copyBtn2=document[_0x55984a(0x21a)]('copy-btn-2'),copyBtn3=document[_0x55984a(0x21a)](_0x55984a(0x1f4)),copyBtn4=document['getElementById'](_0x55984a(0x247)),copyBtn5=document[_0x55984a(0x21a)](_0x55984a(0x25d)),semesterInfoEl=document[_0x55984a(0x21a)](_0x55984a(0x295)),progressContainer=document[_0x55984a(0x21a)](_0x55984a(0x290)),progressBar=document[_0x55984a(0x21a)](_0x55984a(0x2af)),progressText=document[_0x55984a(0x21a)](_0x55984a(0x1f0)),progressStatus=document[_0x55984a(0x21a)]('progress-status'),completionBar=document[_0x55984a(0x21a)](_0x55984a(0x1df));function showTab(_0x5adcaa){const _0x8a8fd9=_0x55984a;document[_0x8a8fd9(0x200)](_0x8a8fd9(0x20f))[_0x8a8fd9(0x274)](_0x55f1a8=>_0x55f1a8[_0x8a8fd9(0x219)][_0x8a8fd9(0x201)]('active','border-blue-600','text-blue-600',_0x8a8fd9(0x258))),document[_0x8a8fd9(0x200)](_0x8a8fd9(0x23f))[_0x8a8fd9(0x274)](_0x4fc285=>_0x4fc285[_0x8a8fd9(0x219)][_0x8a8fd9(0x24e)]('hidden'));const _0x27cfdb=document[_0x8a8fd9(0x21a)](_0x8a8fd9(0x299)+_0x5adcaa),_0x2c2902=document[_0x8a8fd9(0x21a)](_0x8a8fd9(0x1ec)+_0x5adcaa);if(_0x27cfdb)_0x27cfdb[_0x8a8fd9(0x219)][_0x8a8fd9(0x24e)](_0x8a8fd9(0x235),_0x8a8fd9(0x225),_0x8a8fd9(0x230),'font-medium');if(_0x2c2902)_0x2c2902[_0x8a8fd9(0x219)][_0x8a8fd9(0x201)](_0x8a8fd9(0x249));}window[_0x55984a(0x253)]=showTab;async function main(){const _0x42f56e=_0x55984a;try{const _0x3f06c1={'apiKey':_0x42f56e(0x22f),'authDomain':_0x42f56e(0x20d),'projectId':_0x42f56e(0x209),'storageBucket':_0x42f56e(0x254),'messagingSenderId':_0x42f56e(0x26d),'appId':'1:415403943738:web:f56ec72de49f81f0315203','measurementId':_0x42f56e(0x20e)},_0x8baa41=typeof __firebase_config!==_0x42f56e(0x296)?JSON[_0x42f56e(0x2b3)](__firebase_config):_0x3f06c1;appId=typeof __app_id!==_0x42f56e(0x296)?__app_id:'default-app-id';if(!_0x8baa41[_0x42f56e(0x2ac)])throw new Error(_0x42f56e(0x292));const _0x152c6d=initializeApp(_0x8baa41);db=getFirestore(_0x152c6d),auth=getAuth(_0x152c6d),setLogLevel(_0x42f56e(0x231));typeof __initial_auth_token!==_0x42f56e(0x296)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);const _0x2421f4=_0x42f56e(0x2ab)+appId+_0x42f56e(0x25c);passwordListDocRef=doc(db,_0x2421f4),loginBtn[_0x42f56e(0x241)](_0x42f56e(0x251),loginUser),adminBtn[_0x42f56e(0x241)](_0x42f56e(0x251),promptAdminAccess),adminCloseBtn[_0x42f56e(0x241)](_0x42f56e(0x251),closeAdminPanel),adminAddBtn[_0x42f56e(0x241)]('click',adminAddPassword),logoutBtn['addEventListener'](_0x42f56e(0x251),logoutUser),resetDataBtn[_0x42f56e(0x241)](_0x42f56e(0x251),resetAllData),passwordInput[_0x42f56e(0x241)](_0x42f56e(0x217),_0x3627b7=>{const _0x210247=_0x42f56e;if(_0x3627b7['key']===_0x210247(0x279))loginUser();}),fileInput[_0x42f56e(0x241)](_0x42f56e(0x245),handleFile),copyBtn1[_0x42f56e(0x241)]('click',()=>copyToClipboard(outputScores['textContent'],copyBtn1)),copyBtn2[_0x42f56e(0x241)](_0x42f56e(0x251),()=>copyToClipboard(outputRm[_0x42f56e(0x270)],copyBtn2)),copyBtn3[_0x42f56e(0x241)](_0x42f56e(0x251),()=>copyToClipboard(outputReading['textContent'],copyBtn3)),copyBtn4[_0x42f56e(0x241)]('click',()=>copyToClipboard(outputAttributes[_0x42f56e(0x270)],copyBtn4)),copyBtn5['addEventListener']('click',()=>copyToClipboard(outputCompetency[_0x42f56e(0x270)],copyBtn5)),loginScreen[_0x42f56e(0x219)]['remove']('hidden'),adminPanel['classList']['add'](_0x42f56e(0x249)),mainApp[_0x42f56e(0x219)]['add']('hidden');}catch(_0x4f06f2){console['error'](_0x42f56e(0x208),_0x4f06f2),showError(_0x42f56e(0x28c)+_0x4f06f2['message']),loginScreen[_0x42f56e(0x1fe)]='<p\x20class=\x22text-red-500\x22>Initialization\x20failed:\x20'+_0x4f06f2[_0x42f56e(0x297)]+'</p>';}}document['addEventListener'](_0x55984a(0x2a0),main);function loadDataFromStore(){const _0x497e74=_0x55984a;if(Object[_0x497e74(0x28a)](processedDataStore)[_0x497e74(0x214)]===0x0){resultsDiv[_0x497e74(0x219)]['add'](_0x497e74(0x249));return;}const _0x48404e=currentUserTemplate===_0x497e74(0x259)?PRIMARY_TEMPLATE:SECONDARY_TEMPLATE;let _0x51a1c5=null;const _0x3512c1=Math[_0x497e74(0x28e)](0x0,...Object[_0x497e74(0x24f)](processedDataStore)[_0x497e74(0x21c)](_0x2d7f12=>_0x2d7f12[_0x497e74(0x203)]['nameList']&&_0x2d7f12[_0x497e74(0x203)][_0x497e74(0x211)][_0x497e74(0x214)]||0x0)),_0x443b11=_0x48404e[_0x497e74(0x21c)](_0x54442a=>processedDataStore[_0x54442a])[_0x497e74(0x228)](_0x4db567=>_0x4db567&&_0x4db567[_0x497e74(0x203)]['nameList'][_0x497e74(0x214)]>0x0);let _0x391e59=_0x443b11?_0x443b11[_0x497e74(0x203)][_0x497e74(0x211)]:[];_0x391e59['length']<_0x3512c1&&(_0x391e59=[..._0x391e59,...Array(_0x3512c1-_0x391e59[_0x497e74(0x214)])[_0x497e74(0x271)]('')]);activeResults=_0x48404e[_0x497e74(0x21c)](_0x210c93=>{const _0x375d1d=_0x497e74,_0x2e3d77=processedDataStore[_0x210c93];if(_0x2e3d77){if(!_0x51a1c5)_0x51a1c5=_0x2e3d77[_0x375d1d(0x1dd)];const _0x414d6c=padExtractedData(_0x2e3d77['extractedData'],_0x3512c1);return{'fileIdentifier':_0x210c93,'extractedData':_0x414d6c};}else return{'fileIdentifier':_0x210c93,'extractedData':createEmptyData(_0x3512c1)};}),displaySemesterInfo(_0x51a1c5),mergeAndDisplayResults(activeResults,_0x391e59,_0x3512c1),resultsDiv[_0x497e74(0x219)]['remove']('hidden'),showTab(0x1);const _0x140531=_0x48404e[_0x497e74(0x277)](_0x13dc90=>processedDataStore[_0x13dc90]);_0x140531?completionBar[_0x497e74(0x219)][_0x497e74(0x201)](_0x497e74(0x249)):completionBar['classList']['add'](_0x497e74(0x249));}function _0x594c(_0x46856f,_0x1499a1){const _0x108139=_0x1081();return _0x594c=function(_0x594c68,_0x1f4af7){_0x594c68=_0x594c68-0x1dc;let _0x958772=_0x108139[_0x594c68];return _0x958772;},_0x594c(_0x46856f,_0x1499a1);}async function loginUser(){const _0x18561b=_0x55984a,_0x460903=passwordInput[_0x18561b(0x236)];if(!_0x460903)return;loginError['classList'][_0x18561b(0x24e)]('hidden');try{const _0x4e9cca=await getDoc(passwordListDocRef),_0x39401a=_0x4e9cca['data']()?.[_0x18561b(0x243)]||[],_0x4c3d6b=_0x39401a[_0x18561b(0x228)](_0xd2c218=>_0xd2c218[_0x18561b(0x1ff)]===_0x460903);if(_0x4c3d6b){currentUserPassword=_0x460903,currentUserName=_0x4c3d6b['name'],currentUserTemplate=_0x4c3d6b[_0x18561b(0x265)]||_0x18561b(0x259);const _0x51965d=_0x18561b(0x2ab)+appId+_0x18561b(0x227)+currentUserPassword;userDataDocRef=doc(db,_0x51965d);const _0xb15526=await getDoc(userDataDocRef);_0xb15526[_0x18561b(0x1f7)]()?processedDataStore=_0xb15526[_0x18561b(0x26b)]()[_0x18561b(0x21b)]||{}:processedDataStore={};loginScreen[_0x18561b(0x219)][_0x18561b(0x24e)]('hidden'),mainApp[_0x18561b(0x219)]['remove'](_0x18561b(0x249)),adminBtn['classList'][_0x18561b(0x24e)](_0x18561b(0x249));const _0x4c5408=document[_0x18561b(0x21a)](_0x18561b(0x1fd));_0x4c5408&&(_0x4c5408[_0x18561b(0x270)]=_0x18561b(0x268)+currentUserName+'\x20(แบบ:\x20'+(currentUserTemplate==='primary'?_0x18561b(0x1de):_0x18561b(0x288))+')'),fileInput['value']='',resetUI(),loadDataFromStore();}else loginError[_0x18561b(0x219)][_0x18561b(0x201)](_0x18561b(0x249));}catch(_0x53ad25){console[_0x18561b(0x26a)]('Login\x20error:',_0x53ad25),loginError[_0x18561b(0x1f3)]('span')[_0x18561b(0x270)]='เกิดข้อผิดพลาด:\x20'+_0x53ad25[_0x18561b(0x297)],loginError['classList'][_0x18561b(0x201)](_0x18561b(0x249));}}function logoutUser(){const _0x4ed1e6=_0x55984a;currentUserPassword=null,currentUserName=null,currentUserTemplate=null,processedDataStore={},userDataDocRef=null,mainApp['classList'][_0x4ed1e6(0x24e)](_0x4ed1e6(0x249)),loginScreen[_0x4ed1e6(0x219)][_0x4ed1e6(0x201)](_0x4ed1e6(0x249)),adminBtn[_0x4ed1e6(0x219)][_0x4ed1e6(0x201)](_0x4ed1e6(0x249)),passwordInput['value']='',loginError[_0x4ed1e6(0x219)][_0x4ed1e6(0x24e)](_0x4ed1e6(0x249));const _0x53e414=document[_0x4ed1e6(0x21a)](_0x4ed1e6(0x1fd));_0x53e414&&(_0x53e414[_0x4ed1e6(0x270)]='');}async function resetAllData(){const _0x27d307=_0x55984a;if(!userDataDocRef)return;if(confirm(_0x27d307(0x1f5))){processedDataStore={};try{await setDoc(userDataDocRef,{'store':{}});}catch(_0x21e739){showError('ไม่สามารถล้างข้อมูลบนเซิร์ฟเวอร์ได้:\x20'+_0x21e739[_0x27d307(0x297)]);}resetUI(),resultsDiv[_0x27d307(0x219)]['add']('hidden'),completionBar[_0x27d307(0x219)]['add']('hidden'),fileInput[_0x27d307(0x236)]='';}}function promptAdminAccess(){const _0x18b39a=_0x55984a,_0x38b074=prompt(_0x18b39a(0x1ef));if(_0x38b074===_0x18b39a(0x1e6))loginScreen[_0x18b39a(0x219)]['add'](_0x18b39a(0x249)),adminPanel['classList'][_0x18b39a(0x201)](_0x18b39a(0x249)),loadAdminPasswordList();else _0x38b074&&alert(_0x18b39a(0x22b));}function closeAdminPanel(){const _0x18a8d8=_0x55984a;adminPanel[_0x18a8d8(0x219)][_0x18a8d8(0x24e)]('hidden'),loginScreen[_0x18a8d8(0x219)][_0x18a8d8(0x201)](_0x18a8d8(0x249)),adminError[_0x18a8d8(0x219)][_0x18a8d8(0x24e)](_0x18a8d8(0x249));}async function loadAdminPasswordList(){const _0x3b6803=_0x55984a;adminUserListContainer[_0x3b6803(0x1fe)]=_0x3b6803(0x23a);try{const _0xe3257c=await getDoc(passwordListDocRef),_0x5e4c6d=_0xe3257c[_0x3b6803(0x26b)]()?.[_0x3b6803(0x243)]||[];adminUserListContainer['innerHTML']='';if(_0x5e4c6d[_0x3b6803(0x214)]===0x0){adminUserListContainer[_0x3b6803(0x1fe)]=_0x3b6803(0x294);return;}_0x5e4c6d['forEach'](_0x1fcd60=>{const _0x1e4ae7=_0x3b6803,_0x3cc654=document[_0x1e4ae7(0x22e)](_0x1e4ae7(0x2b1));_0x3cc654['className']=_0x1e4ae7(0x2ad);const _0x42248b=_0x1fcd60[_0x1e4ae7(0x265)]==='secondary'?_0x1e4ae7(0x288):_0x1e4ae7(0x1de);_0x3cc654[_0x1e4ae7(0x1fe)]=_0x1e4ae7(0x2b0)+_0x1fcd60[_0x1e4ae7(0x26e)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-gray-500\x20ml-2\x22>(รหัส:\x20'+_0x1fcd60[_0x1e4ae7(0x1ff)]+')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-blue-600\x20ml-2\x20font-medium\x22>(แบบ:\x20'+_0x42248b+_0x1e4ae7(0x2a9)+_0x1fcd60[_0x1e4ae7(0x1ff)]+_0x1e4ae7(0x269)+_0x1fcd60['password']+_0x1e4ae7(0x275),adminUserListContainer[_0x1e4ae7(0x26f)](_0x3cc654);}),document[_0x3b6803(0x200)](_0x3b6803(0x213))[_0x3b6803(0x274)](_0x21b781=>{const _0x1cdb6d=_0x3b6803;_0x21b781[_0x1cdb6d(0x241)](_0x1cdb6d(0x251),()=>adminDeletePassword(_0x21b781[_0x1cdb6d(0x28d)][_0x1cdb6d(0x212)]));}),document[_0x3b6803(0x200)](_0x3b6803(0x1e7))[_0x3b6803(0x274)](_0x97c713=>{const _0x52ecf8=_0x3b6803;_0x97c713[_0x52ecf8(0x241)](_0x52ecf8(0x251),()=>adminEditUser(_0x97c713[_0x52ecf8(0x28d)][_0x52ecf8(0x212)]));});}catch(_0x53a550){console['error']('Error\x20loading\x20password\x20list:',_0x53a550),adminUserListContainer[_0x3b6803(0x1fe)]='<p\x20class=\x22text-red-500\x22>ไม่สามารถโหลดรายชื่อได้:\x20'+_0x53a550[_0x3b6803(0x297)]+_0x3b6803(0x1e1);}}async function adminAddPassword(){const _0x233d96=_0x55984a,_0x5b305f=adminNameInput[_0x233d96(0x236)][_0x233d96(0x293)](),_0x1502f5=adminPassInput[_0x233d96(0x236)]['trim'](),_0x3d85da=adminTemplateSelect['value'];adminError[_0x233d96(0x219)][_0x233d96(0x24e)](_0x233d96(0x249));if(!_0x5b305f||!_0x1502f5){adminError[_0x233d96(0x270)]=_0x233d96(0x29c),adminError[_0x233d96(0x219)]['remove'](_0x233d96(0x249));return;}try{const _0x18fbf7=await getDoc(passwordListDocRef),_0x312e12=_0x18fbf7[_0x233d96(0x26b)]()?.[_0x233d96(0x243)]||[];if(_0x312e12[_0x233d96(0x255)](_0x522d6e=>_0x522d6e[_0x233d96(0x1ff)]===_0x1502f5)){adminError[_0x233d96(0x270)]=_0x233d96(0x1fb),adminError['classList'][_0x233d96(0x201)](_0x233d96(0x249));return;}const _0x26ae02=[..._0x312e12,{'name':_0x5b305f,'password':_0x1502f5,'template':_0x3d85da}];await setDoc(passwordListDocRef,{'passwords':_0x26ae02}),adminNameInput['value']='',adminPassInput[_0x233d96(0x236)]='',await loadAdminPasswordList();}catch(_0x518c47){console['error'](_0x233d96(0x1eb),_0x518c47),adminError[_0x233d96(0x270)]='เกิดข้อผิดพลาด:\x20'+_0x518c47[_0x233d96(0x297)],adminError[_0x233d96(0x219)][_0x233d96(0x201)](_0x233d96(0x249));}}async function adminEditUser(_0x1cb76d){const _0x395aeb=_0x55984a;try{const _0x12abb8=await getDoc(passwordListDocRef),_0x524559=_0x12abb8['data']()?.[_0x395aeb(0x243)]||[],_0x252c0e=_0x524559[_0x395aeb(0x228)](_0x1b831f=>_0x1b831f['password']===_0x1cb76d);if(!_0x252c0e){alert(_0x395aeb(0x1ea));return;}const _0x2f24d3=prompt('แก้ไขชื่อสำหรับรหัส\x20\x22'+_0x252c0e[_0x395aeb(0x1ff)]+'\x22\x20(กด\x20OK\x20เพื่อคงชื่อเดิม):',_0x252c0e['name']);if(_0x2f24d3===null)return;const _0x2098c4=_0x252c0e[_0x395aeb(0x265)]||'primary',_0x573a11=prompt('แก้ไข\x20\x22แบบ\x22\x20สำหรับ\x20'+_0x252c0e[_0x395aeb(0x26e)]+_0x395aeb(0x29e),_0x2098c4);if(_0x573a11===null)return;const _0x528f5a=_0x2f24d3[_0x395aeb(0x293)]()===''?_0x252c0e[_0x395aeb(0x26e)]:_0x2f24d3[_0x395aeb(0x293)](),_0x413ac9=_0x573a11[_0x395aeb(0x293)]()['toLowerCase']()===_0x395aeb(0x234)?_0x395aeb(0x234):_0x395aeb(0x259);if(_0x413ac9!==_0x2098c4){if(confirm(_0x395aeb(0x29b)+_0x528f5a+_0x395aeb(0x273))){const _0x7e4ad0=_0x395aeb(0x2ab)+appId+'/public/data/user_data/'+_0x1cb76d,_0x53e9ad=doc(db,_0x7e4ad0);await setDoc(_0x53e9ad,{'store':{}});}else return;}const _0x353f10=_0x524559[_0x395aeb(0x21c)](_0x57d7bd=>{const _0x273e0d=_0x395aeb;if(_0x57d7bd[_0x273e0d(0x1ff)]===_0x1cb76d)return{..._0x57d7bd,'name':_0x528f5a,'template':_0x413ac9};return _0x57d7bd;});await setDoc(passwordListDocRef,{'passwords':_0x353f10}),await loadAdminPasswordList();}catch(_0x2d9923){console[_0x395aeb(0x26a)](_0x395aeb(0x262),_0x2d9923),adminError[_0x395aeb(0x270)]=_0x395aeb(0x27c)+_0x2d9923['message'],adminError[_0x395aeb(0x219)][_0x395aeb(0x201)](_0x395aeb(0x249));}}async function adminDeletePassword(_0xc78b4e){const _0x4af5d9=_0x55984a;if(!confirm(_0x4af5d9(0x239)+_0xc78b4e+'\x22?'))return;if(!confirm(_0x4af5d9(0x257)))return;try{const _0x5bd08d='/artifacts/'+appId+'/public/data/user_data/'+_0xc78b4e,_0x430b9b=doc(db,_0x5bd08d);await deleteDoc(_0x430b9b);const _0x48bb93=await getDoc(passwordListDocRef),_0x4921b9=_0x48bb93[_0x4af5d9(0x26b)]()?.[_0x4af5d9(0x243)]||[],_0x4a6f34=_0x4921b9['filter'](_0x328489=>_0x328489[_0x4af5d9(0x1ff)]!==_0xc78b4e);await setDoc(passwordListDocRef,{'passwords':_0x4a6f34}),await loadAdminPasswordList();}catch(_0x5b2805){console['error']('Error\x20deleting\x20password:',_0x5b2805),adminError[_0x4af5d9(0x270)]=_0x4af5d9(0x27c)+_0x5b2805[_0x4af5d9(0x297)],adminError['classList'][_0x4af5d9(0x201)](_0x4af5d9(0x249));}}function findLastStudentRowIndex(_0xb6c4f2,_0x2fbfb3,_0x5ebd7e,_0x16a038){const _0x5f4bb1=_0x55984a;for(let _0xbc0d1f=_0x5ebd7e;_0xbc0d1f>=_0x2fbfb3;_0xbc0d1f--){const _0x5e115d=getCellValue(_0xb6c4f2,_0xbc0d1f,_0x16a038);if(_0x5e115d&&_0x5e115d[_0x5f4bb1(0x293)]()!=='')return _0xbc0d1f;}return _0x2fbfb3-0x1;}function createEmptyData(_0x36bcc0){const _0x393224=_0x55984a;if(_0x36bcc0<0x0)_0x36bcc0=0x0;const _0x1c734e=_0x36bcc0+0x1,_0x51b75b=Array(_0x36bcc0)[_0x393224(0x271)](''),_0x48edf8=['\x09\x09',...Array(_0x36bcc0)[_0x393224(0x271)]('\x09\x09')],_0xefe248=Array(_0x36bcc0)[_0x393224(0x271)](''),_0x3e56b2=currentUserTemplate===_0x393224(0x259)?_0x393224(0x27a):_0x393224(0x21f),_0x58f7db=currentUserTemplate===_0x393224(0x259)?'\x09\x09':'',_0x3d13dc=[_0x3e56b2,...Array(_0x36bcc0)['fill'](_0x58f7db)],_0x35c639=[Array(0x8)['fill']('100')[_0x393224(0x1ed)]('\x09'),...Array(_0x36bcc0)['fill'](_0x393224(0x24d))],_0x201947=[Array(0x5)[_0x393224(0x271)](_0x393224(0x21f))[_0x393224(0x1ed)]('\x09'),...Array(_0x36bcc0)['fill'](_0x393224(0x24b))];return{'scoresLines':_0x48edf8,'rmLines':_0xefe248,'readingLines':_0x3d13dc,'attrLines':_0x35c639,'compLines':_0x201947,'nameList':_0x51b75b,'numStudentRows':_0x36bcc0};}function padExtractedData(_0x17169f,_0x810980){const _0x201884=_0x55984a,_0x2f661f=_0x17169f['nameList']&&_0x17169f['nameList'][_0x201884(0x214)]||0x0;if(_0x2f661f>=_0x810980)return _0x17169f;const _0x32f3ae=_0x810980-_0x2f661f;if(_0x32f3ae<=0x0)return _0x17169f;const _0x1af8ad=currentUserTemplate===_0x201884(0x259)?'\x09\x09':'';return{'nameList':[..._0x17169f[_0x201884(0x211)],...Array(_0x32f3ae)[_0x201884(0x271)]('')],'scoresLines':[..._0x17169f[_0x201884(0x202)],...Array(_0x32f3ae)['fill']('\x09\x09')],'rmLines':[..._0x17169f[_0x201884(0x1e8)],...Array(_0x32f3ae)['fill']('')],'readingLines':[..._0x17169f[_0x201884(0x2b5)],...Array(_0x32f3ae)['fill'](_0x1af8ad)],'attrLines':[..._0x17169f[_0x201884(0x248)],...Array(_0x32f3ae)[_0x201884(0x271)](_0x201884(0x24d))],'compLines':[..._0x17169f[_0x201884(0x272)],...Array(_0x32f3ae)[_0x201884(0x271)](_0x201884(0x24b))],'numStudentRows':_0x810980};}async function handleFile(_0x10016d){const _0x3fc19c=_0x55984a;if(!currentUserTemplate||!userDataDocRef){showError('เกิดข้อผิดพลาด:\x20ไม่ได้เข้าสู่ระบบ');return;}const _0x1885a2=_0x10016d[_0x3fc19c(0x25f)][_0x3fc19c(0x298)];if(!_0x1885a2||_0x1885a2[_0x3fc19c(0x214)]===0x0)return;const _0x1c7498=_0x1885a2[_0x3fc19c(0x214)];resetUI(),resultsDiv[_0x3fc19c(0x219)][_0x3fc19c(0x24e)]('hidden'),errorDiv[_0x3fc19c(0x219)][_0x3fc19c(0x24e)](_0x3fc19c(0x249)),progressContainer[_0x3fc19c(0x219)]['remove'](_0x3fc19c(0x249)),progressStatus[_0x3fc19c(0x219)]['remove'](_0x3fc19c(0x249)),progressBar[_0x3fc19c(0x26c)][_0x3fc19c(0x2b4)]='0%',progressText['textContent']='0%',progressStatus[_0x3fc19c(0x270)]=_0x3fc19c(0x281)+_0x1c7498+')';const _0x1e2321=currentUserTemplate===_0x3fc19c(0x259)?PRIMARY_TEMPLATE:SECONDARY_TEMPLATE;let _0x46fa16=[];try{for(let _0x13d630=0x0;_0x13d630<_0x1c7498;_0x13d630++){const _0x4c615d=_0x1885a2[_0x13d630];progressStatus[_0x3fc19c(0x270)]=_0x3fc19c(0x291)+(_0x13d630+0x1)+'\x20จาก\x20'+_0x1c7498+':\x20'+_0x4c615d[_0x3fc19c(0x26e)];const _0x12f081=await new Promise((_0x25bfd7,_0xe65b5)=>{const _0x349431=_0x3fc19c,_0x426c88=new FileReader();_0x426c88['onload']=_0x4c2a0c=>{const _0x290d0c=_0x594c;try{const _0x1edf16=new Uint8Array(_0x4c2a0c['target']['result']),_0x138b9c=XLSX[_0x290d0c(0x23b)](_0x1edf16,{'type':_0x290d0c(0x1ee)}),_0x2c90c8=_0x290d0c(0x222),_0x45ec5e=_0x290d0c(0x25b);if(!_0x138b9c[_0x290d0c(0x1fa)]['includes'](_0x2c90c8))_0xe65b5('ไม่พบชีต\x20‘รายงาน1’\x20ในไฟล์:\x20'+_0x4c615d[_0x290d0c(0x26e)]);if(!_0x138b9c[_0x290d0c(0x1fa)][_0x290d0c(0x2a1)](_0x45ec5e))_0xe65b5(_0x290d0c(0x25a)+_0x4c615d[_0x290d0c(0x26e)]);const _0x3de372=_0x138b9c[_0x290d0c(0x224)][_0x2c90c8],_0x29cebe=_0x138b9c[_0x290d0c(0x224)][_0x45ec5e];let _0x5941e9=getCellValue(_0x29cebe,0xa,0x2)||_0x4c615d[_0x290d0c(0x26e)];const _0x17ddf1={'semesterLabel':getCellValue(_0x29cebe,0x3,0x4),'yearLabel':getCellValue(_0x29cebe,0x4,0x4),'semesterValue':getCellValue(_0x29cebe,0x3,0x5),'yearValue':getCellValue(_0x29cebe,0x4,0x5)};if(_0x1e2321[_0x290d0c(0x2a1)](_0x5941e9)){const _0x35c702=extractDataFromSheet(_0x3de372,currentUserTemplate);processedDataStore[_0x5941e9]={'extractedData':_0x35c702,'semesterInfo':_0x17ddf1},_0x25bfd7({'fileIdentifier':_0x5941e9,'extractedData':_0x35c702,'semesterInfo':_0x17ddf1,'ignored':![]});}else _0x25bfd7({'fileIdentifier':_0x5941e9,'extractedData':null,'semesterInfo':_0x17ddf1,'ignored':!![]});}catch(_0x50ffd1){_0xe65b5(_0x290d0c(0x210)+_0x4c615d[_0x290d0c(0x26e)]+':\x20'+_0x50ffd1['message']);}},_0x426c88[_0x349431(0x276)]=()=>_0xe65b5(_0x349431(0x20b)+_0x4c615d[_0x349431(0x26e)]+_0x349431(0x260)),_0x426c88['readAsArrayBuffer'](_0x4c615d);});!_0x12f081[_0x3fc19c(0x283)]&&_0x46fa16[_0x3fc19c(0x264)](_0x12f081);const _0x5e94ca=Math[_0x3fc19c(0x2a4)]((_0x13d630+0x1)/_0x1c7498*0x64);progressBar['style'][_0x3fc19c(0x2b4)]=_0x5e94ca+'%',progressText[_0x3fc19c(0x270)]=_0x5e94ca+'%';}if(_0x46fa16[_0x3fc19c(0x214)]>0x0)displaySemesterInfo(_0x46fa16[0x0][_0x3fc19c(0x1dd)]);else{if(Object[_0x3fc19c(0x28a)](processedDataStore)[_0x3fc19c(0x214)]>0x0){const _0xc8d5fb=_0x1e2321[_0x3fc19c(0x228)](_0x31470e=>processedDataStore[_0x31470e]);_0xc8d5fb&&displaySemesterInfo(processedDataStore[_0xc8d5fb]['semesterInfo']);}else displaySemesterInfo(null);}progressStatus[_0x3fc19c(0x270)]='กำลังจัดเรียงข้อมูล...';const _0x66c24b=Math[_0x3fc19c(0x28e)](0x0,...Object[_0x3fc19c(0x24f)](processedDataStore)['map'](_0x752d5c=>_0x752d5c[_0x3fc19c(0x203)][_0x3fc19c(0x211)]&&_0x752d5c['extractedData'][_0x3fc19c(0x211)][_0x3fc19c(0x214)]||0x0)),_0x346152=_0x1e2321[_0x3fc19c(0x21c)](_0xdacfe7=>processedDataStore[_0xdacfe7])[_0x3fc19c(0x228)](_0x3c9eba=>_0x3c9eba&&_0x3c9eba[_0x3fc19c(0x203)][_0x3fc19c(0x211)][_0x3fc19c(0x214)]>0x0);let _0x4c2aeb=_0x346152?_0x346152[_0x3fc19c(0x203)][_0x3fc19c(0x211)]:[];_0x4c2aeb[_0x3fc19c(0x214)]<_0x66c24b&&(_0x4c2aeb=[..._0x4c2aeb,...Array(_0x66c24b-_0x4c2aeb['length'])['fill']('')]);activeResults=_0x1e2321['map'](_0x1f388a=>{const _0x55b745=processedDataStore[_0x1f388a];if(_0x55b745){const _0x366544=padExtractedData(_0x55b745['extractedData'],_0x66c24b);return{'fileIdentifier':_0x1f388a,'extractedData':_0x366544};}else return{'fileIdentifier':_0x1f388a,'extractedData':createEmptyData(_0x66c24b)};});try{await setDoc(userDataDocRef,{'store':processedDataStore});}catch(_0x46812d){showError('ไม่สามารถบันทึกข้อมูลไฟล์ได้:\x20'+_0x46812d['message']);}mergeAndDisplayResults(activeResults,_0x4c2aeb,_0x66c24b),resultsDiv[_0x3fc19c(0x219)][_0x3fc19c(0x201)](_0x3fc19c(0x249)),showTab(0x1),progressStatus[_0x3fc19c(0x270)]='ประมวลผลเสร็จสิ้น!',setTimeout(()=>{const _0x5b7450=_0x3fc19c;progressContainer[_0x5b7450(0x219)][_0x5b7450(0x24e)](_0x5b7450(0x249)),progressStatus[_0x5b7450(0x219)][_0x5b7450(0x24e)](_0x5b7450(0x249));},0x5dc);const _0x4afaa2=_0x1e2321[_0x3fc19c(0x277)](_0x58002a=>processedDataStore[_0x58002a]);_0x4afaa2?completionBar[_0x3fc19c(0x219)][_0x3fc19c(0x201)]('hidden'):completionBar[_0x3fc19c(0x219)][_0x3fc19c(0x24e)]('hidden');}catch(_0x564d36){showError(_0x564d36),fileInput['value']='',progressContainer[_0x3fc19c(0x219)]['add'](_0x3fc19c(0x249)),progressStatus[_0x3fc19c(0x219)][_0x3fc19c(0x24e)](_0x3fc19c(0x249));}}function resetUI(){const _0x146083=_0x55984a;outputScores[_0x146083(0x270)]='',outputReading['textContent']='',outputRm[_0x146083(0x270)]='',outputAttributes[_0x146083(0x270)]='',outputCompetency[_0x146083(0x270)]='',visualScores[_0x146083(0x1fe)]='',visualReading['innerHTML']='',visualRm[_0x146083(0x1fe)]='',visualAttributes[_0x146083(0x1fe)]='',visualCompetency[_0x146083(0x1fe)]='';if(semesterInfoEl)semesterInfoEl[_0x146083(0x270)]='';if(completionBar)completionBar[_0x146083(0x219)]['add']('hidden');[copyBtn1,copyBtn2,copyBtn3,copyBtn4,copyBtn5][_0x146083(0x274)](_0x3a9104=>{const _0x12762b=_0x146083;_0x3a9104&&(_0x3a9104[_0x12762b(0x270)]=_0x12762b(0x237),_0x3a9104[_0x12762b(0x219)][_0x12762b(0x201)]('bg-blue-500','bg-red-500'),_0x3a9104[_0x12762b(0x219)]['add'](_0x12762b(0x1e0),'hover:bg-green-600'));});if(progressContainer)progressContainer[_0x146083(0x219)]['add'](_0x146083(0x249));if(progressStatus)progressStatus[_0x146083(0x219)][_0x146083(0x24e)]('hidden');}function showError(_0x396c77){const _0x2633af=_0x55984a;errorText[_0x2633af(0x270)]=_0x396c77,errorDiv['classList'][_0x2633af(0x201)]('hidden');}function getCellValue(_0x45d42d,_0x38a36d,_0xf30eb0){const _0x124341=_0x55984a,_0x41b7a6=_0x45d42d[XLSX[_0x124341(0x2ae)][_0x124341(0x238)]({'r':_0x38a36d,'c':_0xf30eb0})];if(!_0x41b7a6)return'';return _0x41b7a6['w']!==null&&_0x41b7a6['w']!==undefined?String(_0x41b7a6['w']):_0x41b7a6['v']!==null&&_0x41b7a6['v']!==undefined?String(_0x41b7a6['v']):'';}function displaySemesterInfo(_0xe770f2){const _0x15ebac=_0x55984a;if(!semesterInfoEl)return;if(!_0xe770f2){semesterInfoEl['textContent']='';return;}const {semesterLabel:_0x5f54fe,yearLabel:_0x2cae45,semesterValue:_0x4b6b36,yearValue:_0x210848}=_0xe770f2;let _0x3c477e='';_0x4b6b36&&_0x210848&&(_0x4b6b36['includes'](_0x15ebac(0x282))?_0x3c477e=_0x15ebac(0x1f2)+_0x210848:_0x3c477e=(_0x5f54fe||'ภาคเรียนที่')+'\x20'+_0x4b6b36+'\x20'+(_0x2cae45||'ปีการศึกษา')+'\x20'+_0x210848),semesterInfoEl[_0x15ebac(0x270)]=_0x3c477e;}function extractDataFromSheet(_0x21f6c3,_0x3eb0c7){const _0x347987=_0x55984a,_0x5cd73d=findLastStudentRowIndex(_0x21f6c3,0x6,0x37,0x3),_0x2cc933=_0x5cd73d<0x6?0x0:_0x5cd73d-0x6+0x1;let _0x1ac513=[],_0x1edb7b=[],_0x58101d=[],_0x392094=[],_0x2b425b=[],_0x102449=[];if(_0x2cc933>0x0){for(let _0x5489b6=0x6;_0x5489b6<=_0x5cd73d;_0x5489b6++){_0x1ac513['push'](getCellValue(_0x21f6c3,_0x5489b6,0x3));}for(let _0x52ba5b=0x5;_0x52ba5b<=_0x5cd73d;_0x52ba5b++){_0x1edb7b[_0x347987(0x264)]([getCellValue(_0x21f6c3,_0x52ba5b,0x4),getCellValue(_0x21f6c3,_0x52ba5b,0x5),getCellValue(_0x21f6c3,_0x52ba5b,0x6)]['join']('\x09'));}for(let _0x5d4c7d=0x6;_0x5d4c7d<=_0x5cd73d;_0x5d4c7d++){let _0x3612df=getCellValue(_0x21f6c3,_0x5d4c7d,0x7)[_0x347987(0x293)]();_0x58101d['push'](_0x3612df==='ร'||_0x3612df==='มส'?_0x3612df:'');}if(_0x3eb0c7===_0x347987(0x259)){_0x392094[_0x347987(0x264)]('100\x09100\x09100');for(let _0x4d0fc9=0x6;_0x4d0fc9<=_0x5cd73d;_0x4d0fc9++){_0x392094[_0x347987(0x264)]([getCellValue(_0x21f6c3,_0x4d0fc9,0x8),getCellValue(_0x21f6c3,_0x4d0fc9,0x9),getCellValue(_0x21f6c3,_0x4d0fc9,0xa)][_0x347987(0x1ed)]('\x09'));}}else{_0x392094[_0x347987(0x264)]('100');for(let _0x5d5dcf=0x6;_0x5d5dcf<=_0x5cd73d;_0x5d5dcf++){_0x392094['push'](getCellValue(_0x21f6c3,_0x5d5dcf,0xb));}}let _0x1029db=[];for(let _0x19f571=0xd;_0x19f571<=0x14;_0x19f571++)_0x1029db[_0x347987(0x264)](_0x347987(0x21f));_0x2b425b[_0x347987(0x264)](_0x1029db[_0x347987(0x1ed)]('\x09'));for(let _0x733ac5=0x6;_0x733ac5<=_0x5cd73d;_0x733ac5++){let _0x5bf6f8=[];for(let _0x2012e5=0xd;_0x2012e5<=0x14;_0x2012e5++)_0x5bf6f8[_0x347987(0x264)](getCellValue(_0x21f6c3,_0x733ac5,_0x2012e5));_0x2b425b[_0x347987(0x264)](_0x5bf6f8[_0x347987(0x1ed)]('\x09'));}let _0x3b4088=[];for(let _0x3ee70d=0x19;_0x3ee70d<=0x1d;_0x3ee70d++)_0x3b4088[_0x347987(0x264)]('100');_0x102449[_0x347987(0x264)](_0x3b4088[_0x347987(0x1ed)]('\x09'));for(let _0xf1dfc6=0x6;_0xf1dfc6<=_0x5cd73d;_0xf1dfc6++){let _0x5c1433=[];for(let _0x25a2ba=0x19;_0x25a2ba<=0x1d;_0x25a2ba++)_0x5c1433[_0x347987(0x264)](getCellValue(_0x21f6c3,_0xf1dfc6,_0x25a2ba));_0x102449[_0x347987(0x264)](_0x5c1433[_0x347987(0x1ed)]('\x09'));}}else{_0x1edb7b[_0x347987(0x264)]('\x09\x09'),_0x392094[_0x347987(0x264)](_0x3eb0c7===_0x347987(0x259)?'100\x09100\x09100':_0x347987(0x21f));let _0x25a4cd=[];for(let _0x54536b=0xd;_0x54536b<=0x14;_0x54536b++)_0x25a4cd[_0x347987(0x264)]('100');_0x2b425b['push'](_0x25a4cd['join']('\x09'));let _0x2e3fcb=[];for(let _0x37a574=0x19;_0x37a574<=0x1d;_0x37a574++)_0x2e3fcb['push'](_0x347987(0x21f));_0x102449[_0x347987(0x264)](_0x2e3fcb[_0x347987(0x1ed)]('\x09'));}return{'scoresLines':_0x1edb7b,'rmLines':_0x58101d,'readingLines':_0x392094,'attrLines':_0x2b425b,'compLines':_0x102449,'nameList':_0x1ac513,'numStudentRows':_0x2cc933};}function buildVisualBlock(_0x6ad4ac,_0x5bfe9e,_0x3559ef,_0x1a85db,_0x5f12f4){const _0x2f1682=_0x55984a;_0x3559ef['innerHTML']='';const _0x168d4d=_0x1a85db,_0x2b928f=document[_0x2f1682(0x22e)]('div');_0x2b928f[_0x2f1682(0x1dc)]=_0x2f1682(0x221),_0x2b928f[_0x2f1682(0x1fe)]=_0x2f1682(0x1f8);const _0x24f871=document['createElement'](_0x2f1682(0x2b1));_0x2b928f['appendChild'](_0x24f871);let _0x2b941d=[..._0x168d4d];if(_0x5bfe9e!=='rmLines'&&_0x2b941d[_0x2f1682(0x214)]>0x0)_0x2b941d['unshift']('');else _0x5bfe9e!=='rmLines'&&_0x2b941d['length']===0x0&&_0x2b941d[_0x2f1682(0x2aa)]('');_0x2b941d['forEach']((_0x5c12d1,_0x8f6bb7)=>{const _0x296a24=_0x2f1682,_0x5cf076=document['createElement']('div');_0x5cf076[_0x296a24(0x1dc)]='font-mono\x20text-sm\x20whitespace-pre\x20text-gray-600\x20px-1';if(_0x8f6bb7%0x2!==0x0)_0x5cf076[_0x296a24(0x219)][_0x296a24(0x24e)]('bg-gray-100');_0x5cf076[_0x296a24(0x270)]=_0x5c12d1||'\u00a0',_0x24f871[_0x296a24(0x26f)](_0x5cf076);}),_0x3559ef[_0x2f1682(0x26f)](_0x2b928f),_0x6ad4ac['forEach']((_0x56af29,_0x4abc4f)=>{const _0xf7ce5=_0x2f1682,{fileIdentifier:_0x1a9e6a,extractedData:_0x5cd33a}=_0x56af29,_0x2ada84=document[_0xf7ce5(0x22e)](_0xf7ce5(0x2b1));_0x2ada84['className']=_0xf7ce5(0x28f);if(_0x4abc4f<_0x6ad4ac['length']-0x1)_0x2ada84[_0xf7ce5(0x1dc)]+=_0xf7ce5(0x289);_0x2ada84[_0xf7ce5(0x1fe)]=_0xf7ce5(0x207)+_0x1a9e6a+_0xf7ce5(0x22c);const _0xc0f949=document[_0xf7ce5(0x22e)](_0xf7ce5(0x2b1));_0x2ada84[_0xf7ce5(0x26f)](_0xc0f949);const _0x172d82=_0x5cd33a&&_0x5cd33a[_0x5bfe9e]?_0x5cd33a[_0x5bfe9e]:createEmptyData(_0x5f12f4)[_0x5bfe9e];_0x172d82[_0xf7ce5(0x274)]((_0x216913,_0x4abfde)=>{const _0x4d1c5c=_0xf7ce5,_0x2c9c02=document['createElement'](_0x4d1c5c(0x2b1));_0x2c9c02[_0x4d1c5c(0x1dc)]=_0x4d1c5c(0x2a3);if(_0x4abfde%0x2!==0x0)_0x2c9c02[_0x4d1c5c(0x219)][_0x4d1c5c(0x24e)](_0x4d1c5c(0x1e3));_0x2c9c02[_0x4d1c5c(0x270)]=_0x216913||'\u00a0',_0xc0f949['appendChild'](_0x2c9c02);}),_0x3559ef['appendChild'](_0x2ada84);});}function mergeAndDisplayResults(_0x58e321,_0xf73292,_0x3c770d){const _0x462ce3=_0x55984a,_0x24fbbf=(_0x26bc87,_0xf6d052)=>{const _0x481383=_0x594c;let _0x5c7ee2='';for(let _0x53b443=0x0;_0x53b443<_0xf6d052;_0x53b443++){let _0x5e4882=[];for(const _0x3bcbf2 of _0x58e321){const _0x203eb7=_0x3bcbf2[_0x481383(0x203)]&&_0x3bcbf2['extractedData'][_0x26bc87]&&_0x3bcbf2[_0x481383(0x203)][_0x26bc87][_0x53b443]!==undefined?_0x3bcbf2[_0x481383(0x203)][_0x26bc87][_0x53b443]:createEmptyData(_0x3c770d)[_0x26bc87][_0x53b443];_0x26bc87==='readingLines'&&currentUserTemplate!==_0x481383(0x259)?_0x5e4882[_0x481383(0x264)](_0x203eb7+'\x09\x09'):_0x5e4882[_0x481383(0x264)](_0x203eb7);}_0x5c7ee2+=_0x5e4882['join']('\x09')+'\x0a';}return _0x5c7ee2[_0x481383(0x233)]();},_0x5530d4={'scoresLines':_0x3c770d+0x1,'rmLines':_0x3c770d,'readingLines':_0x3c770d+0x1,'attrLines':_0x3c770d+0x1,'compLines':_0x3c770d+0x1};outputScores['textContent']=_0x24fbbf(_0x462ce3(0x202),_0x5530d4['scoresLines']),outputRm[_0x462ce3(0x270)]=_0x24fbbf(_0x462ce3(0x1e8),_0x5530d4['rmLines']),outputReading[_0x462ce3(0x270)]=_0x24fbbf('readingLines',_0x5530d4[_0x462ce3(0x2b5)]),outputAttributes[_0x462ce3(0x270)]=_0x24fbbf('attrLines',_0x5530d4[_0x462ce3(0x248)]),outputCompetency[_0x462ce3(0x270)]=_0x24fbbf(_0x462ce3(0x272),_0x5530d4['compLines']),buildVisualBlock(_0x58e321,'scoresLines',visualScores,_0xf73292,_0x3c770d),buildVisualBlock(_0x58e321,_0x462ce3(0x1e8),visualRm,_0xf73292,_0x3c770d),buildVisualBlock(_0x58e321,_0x462ce3(0x2b5),visualReading,_0xf73292,_0x3c770d),buildVisualBlock(_0x58e321,_0x462ce3(0x248),visualAttributes,_0xf73292,_0x3c770d),buildVisualBlock(_0x58e321,_0x462ce3(0x272),visualCompetency,_0xf73292,_0x3c770d);}function copyToClipboard(_0x2568f4,_0x2ccc60){const _0x2d48d1=_0x55984a,_0x127dbb=document[_0x2d48d1(0x22e)](_0x2d48d1(0x215));_0x127dbb[_0x2d48d1(0x236)]=_0x2568f4,_0x127dbb[_0x2d48d1(0x26c)]['position']='fixed',_0x127dbb[_0x2d48d1(0x26c)][_0x2d48d1(0x286)]=0x0,document[_0x2d48d1(0x226)]['appendChild'](_0x127dbb),_0x127dbb[_0x2d48d1(0x24c)]();try{document[_0x2d48d1(0x23e)]('copy');const _0x2ddbbd=_0x2ccc60[_0x2d48d1(0x270)];_0x2ccc60[_0x2d48d1(0x270)]=_0x2d48d1(0x27f),_0x2ccc60[_0x2d48d1(0x219)][_0x2d48d1(0x201)]('bg-green-500',_0x2d48d1(0x1fc)),_0x2ccc60['classList'][_0x2d48d1(0x24e)](_0x2d48d1(0x1f6)),setTimeout(()=>{const _0x502ae4=_0x2d48d1;_0x2ccc60['textContent']=_0x2ddbbd,_0x2ccc60[_0x502ae4(0x219)]['remove'](_0x502ae4(0x1f6)),_0x2ccc60[_0x502ae4(0x219)][_0x502ae4(0x24e)](_0x502ae4(0x1e0),_0x502ae4(0x1fc));},0x5dc);}catch(_0x126d10){console[_0x2d48d1(0x26a)]('Failed\x20to\x20copy\x20text:\x20',_0x126d10);}document[_0x2d48d1(0x226)][_0x2d48d1(0x256)](_0x127dbb);}
