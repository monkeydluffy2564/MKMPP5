const _0x131b70=_0x3a2a;(function(_0x41eefc,_0xca0008){const _0x23243f=_0x3a2a,_0xac1210=_0x41eefc();while(!![]){try{const _0x17c07d=-parseInt(_0x23243f(0x1a0))/0x1*(-parseInt(_0x23243f(0x1c3))/0x2)+-parseInt(_0x23243f(0x15c))/0x3+parseInt(_0x23243f(0x13e))/0x4+-parseInt(_0x23243f(0x187))/0x5+parseInt(_0x23243f(0x1ba))/0x6+-parseInt(_0x23243f(0x18f))/0x7+-parseInt(_0x23243f(0x180))/0x8;if(_0x17c07d===_0xca0008)break;else _0xac1210['push'](_0xac1210['shift']());}catch(_0x1fa423){_0xac1210['push'](_0xac1210['shift']());}}}(_0x1428,0x49f6d));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,deleteDoc,setLogLevel}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const PRIMARY_TEMPLATE={'subjects':[_0x131b70(0x1a2),_0x131b70(0x1a4),_0x131b70(0x1cb),_0x131b70(0x199),'ประวัติศาสตร์','สุขศึกษาและพลศึกษา','ศิลปะ',_0x131b70(0x18a),_0x131b70(0x13c),'ภาษาอังกฤษเพิ่มเติม',_0x131b70(0x14e)],'shortNames':[_0x131b70(0x13a),_0x131b70(0x148),_0x131b70(0x13d),_0x131b70(0x16e),_0x131b70(0x1b3),_0x131b70(0x1af),'ศิลปะ',_0x131b70(0x18a),'อังกฤษ',_0x131b70(0x153),_0x131b70(0xf3)],'credits':[0x4,0x4,0x3,0x2,0x1,0x1,0x2,0x2,0x2,0x1,0x1]},SECONDARY_TEMPLATE={'subjects':[_0x131b70(0x1a2),_0x131b70(0x15f),_0x131b70(0x175),'วิทยาศาสตร์และเทคโนโลยีพื้นฐาน',_0x131b70(0x12b),'สังคมศึกษา\x20ศาสนาและวัฒนธรรม',_0x131b70(0x14a),'สุขศึกษา',_0x131b70(0x139),_0x131b70(0x150),_0x131b70(0x193),_0x131b70(0x10f),_0x131b70(0x17f),_0x131b70(0x129),_0x131b70(0x14e)],'shortNames':[_0x131b70(0x13a),'คณิต','คณิตเพิ่ม','วิทย์','วิทย์เพิ่ม',_0x131b70(0x16e),_0x131b70(0x1b3),_0x131b70(0x1ac),_0x131b70(0x1af),_0x131b70(0x150),_0x131b70(0x184),_0x131b70(0x183),_0x131b70(0x178),_0x131b70(0x153),_0x131b70(0xf3)],'credits':[1.5,1.5,0.5,1.5,0.5,1.5,0.5,0.5,0.5,0x1,0x1,0.5,1.5,0.5,0.5]};let db,auth,appId=_0x131b70(0x167),passwordListDocRef,userDataDocRef,currentUserPassword=null,currentUserName=null,currentUserTemplate=null,activeResults=[],processedDataStore={};const loginScreen=document[_0x131b70(0x140)](_0x131b70(0x18d)),adminPanel=document['getElementById']('admin-panel'),mainApp=document[_0x131b70(0x140)](_0x131b70(0x121)),adminBtn=document[_0x131b70(0x140)](_0x131b70(0x11e)),loginBtn=document[_0x131b70(0x140)](_0x131b70(0x132)),passwordInput=document[_0x131b70(0x140)](_0x131b70(0xf6)),loginError=document[_0x131b70(0x140)](_0x131b70(0x1a6)),logoutBtn=document['getElementById'](_0x131b70(0x160)),resetDataBtn=document[_0x131b70(0x140)](_0x131b70(0x1e0)),adminCloseBtn=document[_0x131b70(0x140)](_0x131b70(0x141)),adminNameInput=document[_0x131b70(0x140)]('admin-name-input'),adminPassInput=document[_0x131b70(0x140)](_0x131b70(0x1dc)),adminTemplateSelect=document[_0x131b70(0x140)]('admin-template-select'),adminAddBtn=document['getElementById'](_0x131b70(0x18c)),adminUserListContainer=document[_0x131b70(0x140)](_0x131b70(0x11f)),adminError=document[_0x131b70(0x140)]('admin-error'),fileInput=document[_0x131b70(0x140)](_0x131b70(0x1cd)),resultsDiv=document['getElementById']('results'),errorDiv=document[_0x131b70(0x140)](_0x131b70(0x161)),errorText=document[_0x131b70(0x140)](_0x131b70(0x1c7)),outputScores=document[_0x131b70(0x140)](_0x131b70(0x128)),outputReading=document[_0x131b70(0x140)]('output-reading'),outputRm=document[_0x131b70(0x140)](_0x131b70(0x192)),outputAttributes=document[_0x131b70(0x140)](_0x131b70(0x1b9)),outputCompetency=document[_0x131b70(0x140)](_0x131b70(0x101)),visualScores=document['getElementById'](_0x131b70(0x179)),visualReading=document[_0x131b70(0x140)](_0x131b70(0x1ae)),visualRm=document['getElementById']('visual-rm'),visualAttributes=document[_0x131b70(0x140)]('visual-attributes'),visualCompetency=document[_0x131b70(0x140)](_0x131b70(0x1d5)),copyBtn1=document[_0x131b70(0x140)]('copy-btn-1'),copyBtn2=document[_0x131b70(0x140)](_0x131b70(0x130)),copyBtn3=document['getElementById']('copy-btn-3'),copyBtn4=document[_0x131b70(0x140)]('copy-btn-4'),copyBtn5=document[_0x131b70(0x140)](_0x131b70(0x111)),semesterInfoEl=document[_0x131b70(0x140)](_0x131b70(0x104)),outputIndividual=document[_0x131b70(0x140)]('output-individual'),visualIndividual=document['getElementById'](_0x131b70(0x1b1)),copyBtn6=document[_0x131b70(0x140)]('copy-btn-6'),progressContainer=document[_0x131b70(0x140)](_0x131b70(0x15a)),progressBar=document[_0x131b70(0x140)](_0x131b70(0x14c)),progressText=document[_0x131b70(0x140)]('progress-text'),progressStatus=document[_0x131b70(0x140)](_0x131b70(0x145)),completionBar=document[_0x131b70(0x140)](_0x131b70(0xf8));function showTab(_0x12c247){const _0x4eb511=_0x131b70;document['querySelectorAll'](_0x4eb511(0x1df))[_0x4eb511(0x191)](_0x101748=>_0x101748[_0x4eb511(0x19b)][_0x4eb511(0x10b)](_0x4eb511(0x1e4),_0x4eb511(0x169),_0x4eb511(0x1dd),'font-medium')),document[_0x4eb511(0x162)](_0x4eb511(0x142))['forEach'](_0x5c4a85=>_0x5c4a85[_0x4eb511(0x19b)][_0x4eb511(0x147)]('hidden'));const _0x16b8fb=document[_0x4eb511(0x140)](_0x4eb511(0x112)+_0x12c247),_0x19309a=document[_0x4eb511(0x140)](_0x4eb511(0x154)+_0x12c247);if(_0x16b8fb)_0x16b8fb[_0x4eb511(0x19b)]['add'](_0x4eb511(0x1e4),_0x4eb511(0x169),_0x4eb511(0x1dd),_0x4eb511(0x17c));_0x19309a&&(_0x19309a[_0x4eb511(0x19b)][_0x4eb511(0x10b)](_0x4eb511(0xfc)),_0x19309a[_0x4eb511(0x19b)][_0x4eb511(0x147)](_0x4eb511(0x1bb)));}window[_0x131b70(0x1a7)]=showTab;function _0x3a2a(_0x276b34,_0x5d0098){const _0x1428b3=_0x1428();return _0x3a2a=function(_0x3a2a93,_0x4abd14){_0x3a2a93=_0x3a2a93-0xf1;let _0x5cafb2=_0x1428b3[_0x3a2a93];return _0x5cafb2;},_0x3a2a(_0x276b34,_0x5d0098);}async function main(){const _0x164f3d=_0x131b70;try{const _0x5cd83f={'apiKey':'AIzaSyBHmJ7M5qf20lKPTB9_aE2Ppa0-jTryuuI','authDomain':'programpp-91f08.firebaseapp.com','projectId':'programpp-91f08','storageBucket':_0x164f3d(0x11c),'messagingSenderId':_0x164f3d(0x19c),'appId':_0x164f3d(0x190),'measurementId':'G-W19QNQQR25'},_0x103cd9=typeof __firebase_config!=='undefined'?JSON[_0x164f3d(0x1da)](__firebase_config):_0x5cd83f;appId=typeof __app_id!==_0x164f3d(0x1e2)?__app_id:'default-app-id';if(!_0x103cd9[_0x164f3d(0xf5)])throw new Error(_0x164f3d(0x1b4));const _0x55f87a=initializeApp(_0x103cd9);db=getFirestore(_0x55f87a),auth=getAuth(_0x55f87a),setLogLevel(_0x164f3d(0x126));typeof __initial_auth_token!==_0x164f3d(0x1e2)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);const _0x5893f1=_0x164f3d(0x16f)+appId+_0x164f3d(0x157);passwordListDocRef=doc(db,_0x5893f1),loginBtn[_0x164f3d(0x100)](_0x164f3d(0x108),loginUser),adminBtn[_0x164f3d(0x100)](_0x164f3d(0x108),promptAdminAccess),adminCloseBtn[_0x164f3d(0x100)]('click',closeAdminPanel),adminAddBtn[_0x164f3d(0x100)](_0x164f3d(0x108),adminAddPassword),logoutBtn[_0x164f3d(0x100)]('click',logoutUser),resetDataBtn[_0x164f3d(0x100)](_0x164f3d(0x108),resetAllData),passwordInput[_0x164f3d(0x100)](_0x164f3d(0x188),_0x42ba85=>{const _0x24a2ad=_0x164f3d;if(_0x42ba85[_0x24a2ad(0x166)]===_0x24a2ad(0x159))loginUser();}),fileInput[_0x164f3d(0x100)](_0x164f3d(0x1c0),handleFile),copyBtn1[_0x164f3d(0x100)](_0x164f3d(0x108),()=>copyToClipboard(outputScores[_0x164f3d(0x14d)],copyBtn1)),copyBtn2[_0x164f3d(0x100)](_0x164f3d(0x108),()=>copyToClipboard(outputRm['textContent'],copyBtn2)),copyBtn3['addEventListener'](_0x164f3d(0x108),()=>copyToClipboard(outputReading[_0x164f3d(0x14d)],copyBtn3)),copyBtn4[_0x164f3d(0x100)](_0x164f3d(0x108),()=>copyToClipboard(outputAttributes['textContent'],copyBtn4)),copyBtn5[_0x164f3d(0x100)](_0x164f3d(0x108),()=>copyToClipboard(outputCompetency['textContent'],copyBtn5)),copyBtn6[_0x164f3d(0x100)](_0x164f3d(0x108),()=>copyToClipboard(outputIndividual[_0x164f3d(0x14d)],copyBtn6)),loginScreen[_0x164f3d(0x19b)][_0x164f3d(0x10b)](_0x164f3d(0xfc)),adminPanel[_0x164f3d(0x19b)][_0x164f3d(0x147)](_0x164f3d(0xfc)),mainApp[_0x164f3d(0x19b)][_0x164f3d(0x147)]('hidden');}catch(_0x483f2e){console[_0x164f3d(0x163)]('Initialization\x20failed:',_0x483f2e),showError('Initialization\x20failed:\x20'+_0x483f2e[_0x164f3d(0x155)]),loginScreen['innerHTML']=_0x164f3d(0x15d)+_0x483f2e[_0x164f3d(0x155)]+_0x164f3d(0x116);}}document[_0x131b70(0x100)](_0x131b70(0xff),main);function loadDataFromStore(){const _0x146641=_0x131b70;if(Object[_0x146641(0x1d8)](processedDataStore)[_0x146641(0x118)]===0x0){resultsDiv[_0x146641(0x19b)][_0x146641(0x147)](_0x146641(0xfc));return;}const _0x1f34ac=currentUserTemplate===_0x146641(0x122)?PRIMARY_TEMPLATE['subjects']:SECONDARY_TEMPLATE[_0x146641(0x171)];let _0x3e0cfa=null;const _0x159b60=Math[_0x146641(0x1c6)](0x0,...Object['values'](processedDataStore)[_0x146641(0x1e1)](_0x220644=>_0x220644[_0x146641(0x105)]['nameList']&&_0x220644[_0x146641(0x105)][_0x146641(0x1b7)][_0x146641(0x118)]||0x0)),_0x4c1701=_0x1f34ac[_0x146641(0x1e1)](_0x354d4e=>processedDataStore[_0x354d4e])[_0x146641(0x1b8)](_0xc621c=>_0xc621c&&_0xc621c[_0x146641(0x105)][_0x146641(0x1b7)][_0x146641(0x118)]>0x0);let _0x33f9e8=_0x4c1701?_0x4c1701[_0x146641(0x105)][_0x146641(0x1b7)]:[];_0x33f9e8[_0x146641(0x118)]<_0x159b60&&(_0x33f9e8=[..._0x33f9e8,...Array(_0x159b60-_0x33f9e8[_0x146641(0x118)])['fill']('')]);activeResults=_0x1f34ac['map'](_0x48fadd=>{const _0x498190=_0x146641,_0x1f3fc0=processedDataStore[_0x48fadd];if(_0x1f3fc0){if(!_0x3e0cfa)_0x3e0cfa=_0x1f3fc0[_0x498190(0x1a5)];const _0x49462c=padExtractedData(_0x1f3fc0[_0x498190(0x105)],_0x159b60);return{'fileIdentifier':_0x48fadd,'extractedData':_0x49462c};}else return{'fileIdentifier':_0x48fadd,'extractedData':createEmptyData(_0x159b60)};}),displaySemesterInfo(_0x3e0cfa),mergeAndDisplayResults(activeResults,_0x33f9e8,_0x159b60),resultsDiv[_0x146641(0x19b)][_0x146641(0x10b)](_0x146641(0xfc)),showTab(0x1);const _0x10dcd5=_0x1f34ac[_0x146641(0x1a8)](_0x4d6437=>processedDataStore[_0x4d6437]);_0x10dcd5?completionBar[_0x146641(0x19b)][_0x146641(0x10b)]('hidden'):completionBar[_0x146641(0x19b)][_0x146641(0x147)]('hidden');}async function loginUser(){const _0x19c91c=_0x131b70,_0x40bca6=passwordInput[_0x19c91c(0x11d)];if(!_0x40bca6)return;loginError[_0x19c91c(0x19b)][_0x19c91c(0x147)](_0x19c91c(0xfc));try{const _0x183fa1=await getDoc(passwordListDocRef),_0x1e387f=_0x183fa1['data']()?.[_0x19c91c(0x1b5)]||[],_0x10bb91=_0x1e387f[_0x19c91c(0x1b8)](_0x45d335=>_0x45d335[_0x19c91c(0x177)]===_0x40bca6);if(_0x10bb91){currentUserPassword=_0x40bca6,currentUserName=_0x10bb91[_0x19c91c(0x107)],currentUserTemplate=_0x10bb91[_0x19c91c(0x127)]||_0x19c91c(0x122);const _0x37c1e8='/artifacts/'+appId+_0x19c91c(0x113)+currentUserPassword;userDataDocRef=doc(db,_0x37c1e8);const _0x56996d=await getDoc(userDataDocRef);_0x56996d[_0x19c91c(0x119)]()?processedDataStore=_0x56996d[_0x19c91c(0x12c)]()[_0x19c91c(0x164)]||{}:processedDataStore={};loginScreen[_0x19c91c(0x19b)][_0x19c91c(0x147)](_0x19c91c(0xfc)),mainApp['classList'][_0x19c91c(0x10b)](_0x19c91c(0xfc)),adminBtn['classList'][_0x19c91c(0x147)](_0x19c91c(0xfc));const _0x3a8d68=document[_0x19c91c(0x140)](_0x19c91c(0xfd));_0x3a8d68&&(_0x3a8d68[_0x19c91c(0x14d)]='ยินดีต้อนรับ,\x20'+currentUserName+_0x19c91c(0x1a9)+(currentUserTemplate===_0x19c91c(0x122)?_0x19c91c(0x143):_0x19c91c(0x1d0))+')'),fileInput[_0x19c91c(0x11d)]='',resetUI(),loadDataFromStore();}else loginError['classList']['remove'](_0x19c91c(0xfc));}catch(_0x1b1415){console[_0x19c91c(0x163)](_0x19c91c(0x176),_0x1b1415),loginError['querySelector']('span')[_0x19c91c(0x14d)]=_0x19c91c(0xf4)+_0x1b1415[_0x19c91c(0x155)],loginError[_0x19c91c(0x19b)][_0x19c91c(0x10b)](_0x19c91c(0xfc));}}function logoutUser(){const _0x34fc22=_0x131b70;currentUserPassword=null,currentUserName=null,currentUserTemplate=null,processedDataStore={},userDataDocRef=null,mainApp['classList'][_0x34fc22(0x147)]('hidden'),loginScreen[_0x34fc22(0x19b)][_0x34fc22(0x10b)](_0x34fc22(0xfc)),adminBtn[_0x34fc22(0x19b)]['remove'](_0x34fc22(0xfc)),passwordInput['value']='',loginError[_0x34fc22(0x19b)][_0x34fc22(0x147)]('hidden');const _0x230b32=document[_0x34fc22(0x140)](_0x34fc22(0xfd));_0x230b32&&(_0x230b32[_0x34fc22(0x14d)]='');}async function resetAllData(){const _0x522e3f=_0x131b70;if(!userDataDocRef)return;if(window[_0x522e3f(0x12a)](_0x522e3f(0x11a))){processedDataStore={};try{await setDoc(userDataDocRef,{'store':{}});}catch(_0x3b968d){showError('ไม่สามารถล้างข้อมูลบนเซิร์ฟเวอร์ได้:\x20'+_0x3b968d['message']);}resetUI(),resultsDiv[_0x522e3f(0x19b)][_0x522e3f(0x147)](_0x522e3f(0xfc)),completionBar['classList'][_0x522e3f(0x147)](_0x522e3f(0xfc)),fileInput[_0x522e3f(0x11d)]='';}}function promptAdminAccess(){const _0x444094=_0x131b70,_0x41ccc0=prompt('กรุณาใส่รหัสผ่าน\x20Admin:');if(_0x41ccc0==='2741')loginScreen[_0x444094(0x19b)][_0x444094(0x147)](_0x444094(0xfc)),adminPanel['classList'][_0x444094(0x10b)](_0x444094(0xfc)),loadAdminPasswordList();else _0x41ccc0&&alert(_0x444094(0x1d3));}function _0x1428(){const _0x359340=['confirm','วิทยาศาสตร์และเทคโนโลยีเพิ่มเติม','data','\x22\x20class=\x22admin-delete-btn\x20text-red-500\x20hover:text-red-700\x20font-medium\x20text-sm\x22>ลบ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20class=\x22text-gray-500\x22>กำลังโหลด...</p>','100\x09100\x09100','copy-btn-2','onerror','login-btn','div','<td>','คำเตือน:\x20การลบผู้ใช้นี้จะลบข้อมูลไฟล์ทั้งหมดที่ผู้ใช้นี้อัปโหลดไว้ด้วย\x20ยืนยันหรือไม่?','gpa','รายงาน1','\x20ได้','พลศึกษา','ไทย','<td','ภาษาอังกฤษ','วิทย์','1871752WcObmG','toLowerCase','getElementById','admin-close-btn','.tab-content','ประถม','position','progress-status','read','add','คณิต','thead','ประวัติศาสตร์','rank','progress-bar','textContent','ป้องกันการทุจริต','scoresLines','ศิลปะ','width','tbody','อังกฤษเพิ่ม','tab-content-','message','flex-shrink-0\x20p-3','/public/data/passwords/password_list','.admin-delete-btn','Enter','progress-container','removeChild','543171vBUFLy','<p\x20class=\x22text-red-500\x22>Initialization\x20failed:\x20','เกิดข้อผิดพลาด:\x20ไม่ได้เข้าสู่ระบบ','คณิตศาสตร์พื้นฐาน','logout-btn','error-message','querySelectorAll','error','store','style','key','default-app-id','unshift','border-blue-600','Home','originalIndex','ไม่สามารถบันทึกข้อมูลไฟล์ได้:\x20','Sheets','สังคม','/artifacts/','array','subjects','push','trimEnd','pass','คณิตศาสตร์เพิ่มเติม','Login\x20error:','password','อังกฤษ','visual-scores','appendChild','ชื่อ-สกุล\x09เกรดเฉลี่ย\x09อันดับ\x09','font-medium','ภาคเรียนที่','bg-green-500','ภาษาอังกฤษพื้นฐาน','3029424PJBFJZ','<th>','readingLines','การงานเพิ่ม','การงาน','round','\x20(พิมพ์\x20\x27primary\x27\x20หรือ\x20\x27secondary\x27):','2102945vzMywM','keypress','dataset','การงานอาชีพ','grades','admin-add-btn','login-screen','encode_cell','1201151gdBNBa','1:415403943738:web:f56ec72de49f81f0315203','forEach','output-rm','การงานอาชีพพื้นฐาน','tr.row-highlight','.admin-edit-btn','secondary','body','closest','สังคมศึกษา\x20ศาสนาและวัฒนธรรม','textarea','classList','415403943738','แก้ไข\x20\x22แบบ\x22\x20สำหรับ\x20','</div>','className','8179GBUqnm','flex\x20items-center\x20justify-between\x20p-2.5\x20bg-white\x20border\x20border-gray-300\x20rounded-lg','ภาษาไทย','\x22\x20(กด\x20OK\x20เพื่อคงชื่อเดิม):','คณิตศาสตร์','semesterInfo','login-error','showTab','every','\x20(แบบ:\x20','font-mono\x20text-sm\x20whitespace-pre\x20text-gray-600\x20px-1','utils','สุข','\x20border-r-2\x20border-dashed\x20border-gray-300','visual-reading','พละ','คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้ที่มีรหัสผ่าน\x20\x22','visual-individual','แก้ไขชื่อสำหรับรหัส\x20\x22','ประวัติ','\x22projectId\x22\x20not\x20provided','passwords','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-medium\x20text-gray-800\x22>','nameList','find','output-attributes','3615138BtrkNf','flex','ประมวลผลเสร็จสิ้น!','join','innerHTML','split','change','Error\x20adding\x20password:','คุณได้เปลี่ยน\x20\x22แบบ\x22\x20ของผู้ใช้\x20','94dOcAvL','values','createElement','max','error-text','row-highlight','Error\x20editing\x20user:','SheetNames','วิทยาศาสตร์และเทคโนโลยี','ตลอดปี','file-upload','font-mono\x20text-sm\x20whitespace-pre\x20px-1','คัดลอก\x20(เฉพาะข้อมูล)','มัธยม','copy','Error\x20deleting\x20password:','รหัสผ่าน\x20Admin\x20ไม่ถูกต้อง','</tr>','visual-competency','กำลังประมวลผลไฟล์\x20','\x22\x20class=\x22admin-edit-btn\x20text-blue-500\x20hover:text-blue-700\x20font-medium\x20text-sm\x20mr-3\x22>แก้ไข</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','keys','กำลังจัดเรียงข้อมูล...','parse','\x09\x09\x09\x09\x09\x09\x09','admin-pass-input','text-blue-600','bg-red-500','.tab-btn','reset-data-btn','map','undefined','flex-shrink-0\x20p-3\x20pr-4\x20border-r-2\x20border-gray-300','active','เกิดข้อผิดพลาดในการอ่านไฟล์\x20','รหัสผ่านนี้ถูกใช้แล้ว','ต้านทุจริต','เกิดข้อผิดพลาด:\x20','projectId','password-input','</th>','completion-bar','includes','\x09\x09\x09\x09','rmLines','hidden','welcome-message','compLines','DOMContentLoaded','addEventListener','output-competency',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','fill','semester-info','extractedData','hover:bg-green-600','name','click','bg-gray-100','\x20จาก\x20','remove','attrLines','ignored','100','การงานอาชีพเพิ่มเติม','target','copy-btn-5','tab-btn-','/public/data/user_data/','readAsArrayBuffer','bg-blue-500','</p>','ไม่พบชีต\x20‘รายงาน1’\x20ในไฟล์:\x20','length','exists','คุณแน่ใจหรือไม่ว่าต้องการล้างข้อมูลที่อัปโหลดทั้งหมด?\x20(ไฟล์ที่อัปโหลดจะหายไป)','trim','programpp-91f08.firebasestorage.app','value','admin-btn','admin-user-list-container','</td>','main-app','primary','ไม่สามารถอ่านไฟล์\x20','toFixed','<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-gray-700\x20mb-2\x20whitespace-nowrap\x22>ชื่อ-สกุล</div>','Debug','template','output-scores','ภาษาอังกฤษเพิ่มเติม'];_0x1428=function(){return _0x359340;};return _0x1428();}function closeAdminPanel(){const _0x6031fe=_0x131b70;adminPanel[_0x6031fe(0x19b)][_0x6031fe(0x147)]('hidden'),loginScreen[_0x6031fe(0x19b)][_0x6031fe(0x10b)](_0x6031fe(0xfc)),adminError[_0x6031fe(0x19b)][_0x6031fe(0x147)](_0x6031fe(0xfc));}async function loadAdminPasswordList(){const _0x4781da=_0x131b70;adminUserListContainer[_0x4781da(0x1be)]=_0x4781da(0x12e);try{const _0xd56fdf=await getDoc(passwordListDocRef),_0xdeffe=_0xd56fdf[_0x4781da(0x12c)]()?.[_0x4781da(0x1b5)]||[];adminUserListContainer[_0x4781da(0x1be)]='';if(_0xdeffe[_0x4781da(0x118)]===0x0){adminUserListContainer[_0x4781da(0x1be)]='<p\x20class=\x22text-gray-500\x22>ยังไม่มีผู้ใช้งาน</p>';return;}_0xdeffe[_0x4781da(0x191)](_0x14797c=>{const _0x16c71e=_0x4781da,_0x47c1fd=document[_0x16c71e(0x1c5)](_0x16c71e(0x133));_0x47c1fd['className']=_0x16c71e(0x1a1);const _0x1a5ba9=_0x14797c[_0x16c71e(0x127)]==='secondary'?_0x16c71e(0x1d0):_0x16c71e(0x143);_0x47c1fd[_0x16c71e(0x1be)]=_0x16c71e(0x1b6)+_0x14797c['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-gray-500\x20ml-2\x22>(รหัส:\x20'+_0x14797c[_0x16c71e(0x177)]+')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-blue-600\x20ml-2\x20font-medium\x22>(แบบ:\x20'+_0x1a5ba9+_0x16c71e(0x102)+_0x14797c['password']+_0x16c71e(0x1d7)+_0x14797c[_0x16c71e(0x177)]+_0x16c71e(0x12d),adminUserListContainer[_0x16c71e(0x17a)](_0x47c1fd);}),document[_0x4781da(0x162)](_0x4781da(0x158))['forEach'](_0x710e70=>{const _0x44df19=_0x4781da;_0x710e70[_0x44df19(0x100)](_0x44df19(0x108),()=>adminDeletePassword(_0x710e70[_0x44df19(0x189)]['pass']));}),document['querySelectorAll'](_0x4781da(0x195))[_0x4781da(0x191)](_0x52c585=>{const _0xf6ab71=_0x4781da;_0x52c585[_0xf6ab71(0x100)](_0xf6ab71(0x108),()=>adminEditUser(_0x52c585[_0xf6ab71(0x189)][_0xf6ab71(0x174)]));});}catch(_0x2aa940){console['error']('Error\x20loading\x20password\x20list:',_0x2aa940),adminUserListContainer['innerHTML']='<p\x20class=\x22text-red-500\x22>ไม่สามารถโหลดรายชื่อได้:\x20'+_0x2aa940[_0x4781da(0x155)]+'</p>';}}async function adminAddPassword(){const _0x422617=_0x131b70,_0x5f0b7b=adminNameInput[_0x422617(0x11d)][_0x422617(0x11b)](),_0x33da19=adminPassInput[_0x422617(0x11d)][_0x422617(0x11b)](),_0x2f0d93=adminTemplateSelect[_0x422617(0x11d)];adminError[_0x422617(0x19b)][_0x422617(0x147)](_0x422617(0xfc));if(!_0x5f0b7b||!_0x33da19){adminError[_0x422617(0x14d)]='กรุณากรอกทั้งชื่อและรหัสผ่าน',adminError[_0x422617(0x19b)]['remove']('hidden');return;}try{const _0x4f36bb=await getDoc(passwordListDocRef),_0x1fed7a=_0x4f36bb[_0x422617(0x12c)]()?.[_0x422617(0x1b5)]||[];if(_0x1fed7a['some'](_0x1a9e49=>_0x1a9e49[_0x422617(0x177)]===_0x33da19)){adminError[_0x422617(0x14d)]=_0x422617(0xf2),adminError[_0x422617(0x19b)][_0x422617(0x10b)](_0x422617(0xfc));return;}const _0xc97de1=[..._0x1fed7a,{'name':_0x5f0b7b,'password':_0x33da19,'template':_0x2f0d93}];await setDoc(passwordListDocRef,{'passwords':_0xc97de1}),adminNameInput['value']='',adminPassInput[_0x422617(0x11d)]='',await loadAdminPasswordList();}catch(_0x180153){console[_0x422617(0x163)](_0x422617(0x1c1),_0x180153),adminError[_0x422617(0x14d)]='เกิดข้อผิดพลาด:\x20'+_0x180153['message'],adminError[_0x422617(0x19b)][_0x422617(0x10b)](_0x422617(0xfc));}}async function adminEditUser(_0x12a598){const _0x39d582=_0x131b70;try{const _0x4e5482=await getDoc(passwordListDocRef),_0x3c9738=_0x4e5482[_0x39d582(0x12c)]()?.[_0x39d582(0x1b5)]||[],_0x465c2f=_0x3c9738[_0x39d582(0x1b8)](_0x59474d=>_0x59474d[_0x39d582(0x177)]===_0x12a598);if(!_0x465c2f){alert('ไม่พบผู้ใช้ที่ต้องการแก้ไข');return;}const _0x5b4215=prompt(_0x39d582(0x1b2)+_0x465c2f[_0x39d582(0x177)]+_0x39d582(0x1a3),_0x465c2f[_0x39d582(0x107)]);if(_0x5b4215===null)return;const _0x530a0a=_0x465c2f['template']||'primary',_0x44fe70=prompt(_0x39d582(0x19d)+_0x465c2f[_0x39d582(0x107)]+_0x39d582(0x186),_0x530a0a);if(_0x44fe70===null)return;const _0xb607ac=_0x5b4215['trim']()===''?_0x465c2f['name']:_0x5b4215['trim'](),_0x22bf70=_0x44fe70[_0x39d582(0x11b)]()[_0x39d582(0x13f)]()===_0x39d582(0x196)?'secondary':_0x39d582(0x122);if(_0x22bf70!==_0x530a0a){if(confirm(_0x39d582(0x1c2)+_0xb607ac+'\x20ข้อมูลไฟล์ที่อัปโหลดไว้ทั้งหมดจะถูกลบ\x20ยืนยันหรือไม่?')){const _0x3092ff='/artifacts/'+appId+_0x39d582(0x113)+_0x12a598,_0x3b57d2=doc(db,_0x3092ff);await setDoc(_0x3b57d2,{'store':{}});}else return;}const _0x14888b=_0x3c9738['map'](_0x510ad7=>{if(_0x510ad7['password']===_0x12a598)return{..._0x510ad7,'name':_0xb607ac,'template':_0x22bf70};return _0x510ad7;});await setDoc(passwordListDocRef,{'passwords':_0x14888b}),await loadAdminPasswordList();}catch(_0x59a99f){console[_0x39d582(0x163)](_0x39d582(0x1c9),_0x59a99f),adminError[_0x39d582(0x14d)]=_0x39d582(0xf4)+_0x59a99f[_0x39d582(0x155)],adminError[_0x39d582(0x19b)][_0x39d582(0x10b)](_0x39d582(0xfc));}}async function adminDeletePassword(_0x3ed897){const _0xae0ab9=_0x131b70;if(!confirm(_0xae0ab9(0x1b0)+_0x3ed897+'\x22?'))return;if(!confirm(_0xae0ab9(0x135)))return;try{const _0x346a60='/artifacts/'+appId+_0xae0ab9(0x113)+_0x3ed897,_0x58a585=doc(db,_0x346a60);await deleteDoc(_0x58a585);const _0x580599=await getDoc(passwordListDocRef),_0x3e8298=_0x580599[_0xae0ab9(0x12c)]()?.[_0xae0ab9(0x1b5)]||[],_0x24b701=_0x3e8298['filter'](_0x598ba5=>_0x598ba5[_0xae0ab9(0x177)]!==_0x3ed897);await setDoc(passwordListDocRef,{'passwords':_0x24b701}),await loadAdminPasswordList();}catch(_0x74ef25){console[_0xae0ab9(0x163)](_0xae0ab9(0x1d2),_0x74ef25),adminError[_0xae0ab9(0x14d)]=_0xae0ab9(0xf4)+_0x74ef25[_0xae0ab9(0x155)],adminError[_0xae0ab9(0x19b)][_0xae0ab9(0x10b)](_0xae0ab9(0xfc));}}function findLastStudentRowIndex(_0x43b4b6,_0xe21563,_0x541e13,_0x5a03c1){for(let _0x4e566e=_0x541e13;_0x4e566e>=_0xe21563;_0x4e566e--){const _0x3958c6=getCellValue(_0x43b4b6,_0x4e566e,_0x5a03c1);if(_0x3958c6&&_0x3958c6['trim']()!=='')return _0x4e566e;}return _0xe21563-0x1;}function createEmptyData(_0x460605){const _0x123535=_0x131b70;if(_0x460605<0x0)_0x460605=0x0;const _0x5d49a7=_0x460605+0x1,_0x1b459a=Array(_0x460605)['fill'](''),_0x42439e=['\x09\x09',...Array(_0x460605)[_0x123535(0x103)]('\x09\x09')],_0x28de84=Array(_0x460605)['fill'](''),_0x134f9a=currentUserTemplate==='primary'?_0x123535(0x12f):_0x123535(0x10e),_0x2f82b9=currentUserTemplate===_0x123535(0x122)?'\x09\x09':'',_0x197c3c=[_0x134f9a,...Array(_0x460605)[_0x123535(0x103)](_0x2f82b9)],_0x54bb8f=[Array(0x8)[_0x123535(0x103)](_0x123535(0x10e))[_0x123535(0x1bd)]('\x09'),...Array(_0x460605)['fill'](_0x123535(0x1db))],_0x52dfea=[Array(0x5)['fill'](_0x123535(0x10e))[_0x123535(0x1bd)]('\x09'),...Array(_0x460605)[_0x123535(0x103)](_0x123535(0xfa))];return{'scoresLines':_0x42439e,'rmLines':_0x28de84,'readingLines':_0x197c3c,'attrLines':_0x54bb8f,'compLines':_0x52dfea,'nameList':_0x1b459a,'numStudentRows':_0x460605};}function padExtractedData(_0x55f2a7,_0x15774c){const _0x7a73=_0x131b70,_0x1b5a1e=_0x55f2a7[_0x7a73(0x1b7)]&&_0x55f2a7[_0x7a73(0x1b7)]['length']||0x0;if(_0x1b5a1e>=_0x15774c)return _0x55f2a7;const _0x43737b=_0x15774c-_0x1b5a1e;if(_0x43737b<=0x0)return _0x55f2a7;const _0x5f0c82=currentUserTemplate==='primary'?'\x09\x09':'';return{'nameList':[..._0x55f2a7[_0x7a73(0x1b7)],...Array(_0x43737b)[_0x7a73(0x103)]('')],'scoresLines':[..._0x55f2a7[_0x7a73(0x14f)],...Array(_0x43737b)['fill']('\x09\x09')],'rmLines':[..._0x55f2a7[_0x7a73(0xfb)],...Array(_0x43737b)[_0x7a73(0x103)]('')],'readingLines':[..._0x55f2a7[_0x7a73(0x182)],...Array(_0x43737b)[_0x7a73(0x103)](_0x5f0c82)],'attrLines':[..._0x55f2a7[_0x7a73(0x10c)],...Array(_0x43737b)[_0x7a73(0x103)]('\x09\x09\x09\x09\x09\x09\x09')],'compLines':[..._0x55f2a7[_0x7a73(0xfe)],...Array(_0x43737b)[_0x7a73(0x103)](_0x7a73(0xfa))],'numStudentRows':_0x15774c};}async function handleFile(_0x2f9763){const _0x3c5b9c=_0x131b70;if(!currentUserTemplate||!userDataDocRef){showError(_0x3c5b9c(0x15e));return;}const _0x545dc0=_0x2f9763['target']['files'];if(!_0x545dc0||_0x545dc0['length']===0x0)return;const _0xb488f6=_0x545dc0[_0x3c5b9c(0x118)];resetUI(),resultsDiv[_0x3c5b9c(0x19b)]['add'](_0x3c5b9c(0xfc)),errorDiv[_0x3c5b9c(0x19b)]['add'](_0x3c5b9c(0xfc)),progressContainer[_0x3c5b9c(0x19b)][_0x3c5b9c(0x10b)](_0x3c5b9c(0xfc)),progressStatus['classList'][_0x3c5b9c(0x10b)](_0x3c5b9c(0xfc)),progressBar[_0x3c5b9c(0x165)][_0x3c5b9c(0x151)]='0%',progressText['textContent']='0%',progressStatus[_0x3c5b9c(0x14d)]='กำลังเตรียมไฟล์...\x20(0/'+_0xb488f6+')';const _0x2576b7=currentUserTemplate===_0x3c5b9c(0x122)?PRIMARY_TEMPLATE[_0x3c5b9c(0x171)]:SECONDARY_TEMPLATE[_0x3c5b9c(0x171)];let _0x47937f=[];try{for(let _0x4c03e6=0x0;_0x4c03e6<_0xb488f6;_0x4c03e6++){const _0x1b301b=_0x545dc0[_0x4c03e6];progressStatus[_0x3c5b9c(0x14d)]=_0x3c5b9c(0x1d6)+(_0x4c03e6+0x1)+_0x3c5b9c(0x10a)+_0xb488f6+':\x20'+_0x1b301b[_0x3c5b9c(0x107)];const _0x5af882=await new Promise((_0x3accfc,_0x21a54b)=>{const _0x2c0386=_0x3c5b9c,_0x371bad=new FileReader();_0x371bad['onload']=_0x1ffec2=>{const _0x5ef276=_0x3a2a;try{const _0x1b3fd1=new Uint8Array(_0x1ffec2['target']['result']),_0xb37107=XLSX[_0x5ef276(0x146)](_0x1b3fd1,{'type':_0x5ef276(0x170)}),_0x13e4be=_0x5ef276(0x137),_0x36f399=_0x5ef276(0x16a);if(!_0xb37107[_0x5ef276(0x1ca)]['includes'](_0x13e4be))_0x21a54b(_0x5ef276(0x117)+_0x1b301b['name']);if(!_0xb37107['SheetNames'][_0x5ef276(0xf9)](_0x36f399))_0x21a54b('ไม่พบชีต\x20‘Home’\x20ในไฟล์:\x20'+_0x1b301b[_0x5ef276(0x107)]);const _0xbfb7bd=_0xb37107[_0x5ef276(0x16d)][_0x13e4be],_0x2426a8=_0xb37107[_0x5ef276(0x16d)][_0x36f399];let _0x13aff9=getCellValue(_0x2426a8,0xa,0x2)||_0x1b301b[_0x5ef276(0x107)];const _0x2174c8={'semesterLabel':getCellValue(_0x2426a8,0x3,0x4),'yearLabel':getCellValue(_0x2426a8,0x4,0x4),'semesterValue':getCellValue(_0x2426a8,0x3,0x5),'yearValue':getCellValue(_0x2426a8,0x4,0x5)};if(_0x2576b7[_0x5ef276(0xf9)](_0x13aff9)){const _0x2b2bb5=extractDataFromSheet(_0xbfb7bd,currentUserTemplate);processedDataStore[_0x13aff9]={'extractedData':_0x2b2bb5,'semesterInfo':_0x2174c8},_0x3accfc({'fileIdentifier':_0x13aff9,'extractedData':_0x2b2bb5,'semesterInfo':_0x2174c8,'ignored':![]});}else _0x3accfc({'fileIdentifier':_0x13aff9,'extractedData':null,'semesterInfo':_0x2174c8,'ignored':!![]});}catch(_0x5c6539){_0x21a54b(_0x5ef276(0xf1)+_0x1b301b[_0x5ef276(0x107)]+':\x20'+_0x5c6539[_0x5ef276(0x155)]);}},_0x371bad[_0x2c0386(0x131)]=()=>_0x21a54b(_0x2c0386(0x123)+_0x1b301b[_0x2c0386(0x107)]+_0x2c0386(0x138)),_0x371bad[_0x2c0386(0x114)](_0x1b301b);});!_0x5af882[_0x3c5b9c(0x10d)]&&_0x47937f[_0x3c5b9c(0x172)](_0x5af882);const _0x1dce6b=Math[_0x3c5b9c(0x185)]((_0x4c03e6+0x1)/_0xb488f6*0x64);progressBar[_0x3c5b9c(0x165)][_0x3c5b9c(0x151)]=_0x1dce6b+'%',progressText[_0x3c5b9c(0x14d)]=_0x1dce6b+'%';}if(_0x47937f[_0x3c5b9c(0x118)]>0x0)displaySemesterInfo(_0x47937f[0x0][_0x3c5b9c(0x1a5)]);else{if(Object[_0x3c5b9c(0x1d8)](processedDataStore)[_0x3c5b9c(0x118)]>0x0){const _0xc005df=_0x2576b7[_0x3c5b9c(0x1b8)](_0x462f18=>processedDataStore[_0x462f18]);_0xc005df&&displaySemesterInfo(processedDataStore[_0xc005df][_0x3c5b9c(0x1a5)]);}else displaySemesterInfo(null);}progressStatus[_0x3c5b9c(0x14d)]=_0x3c5b9c(0x1d9);const _0x2c64fd=Math[_0x3c5b9c(0x1c6)](0x0,...Object[_0x3c5b9c(0x1c4)](processedDataStore)[_0x3c5b9c(0x1e1)](_0x37d3aa=>_0x37d3aa[_0x3c5b9c(0x105)][_0x3c5b9c(0x1b7)]&&_0x37d3aa[_0x3c5b9c(0x105)][_0x3c5b9c(0x1b7)][_0x3c5b9c(0x118)]||0x0)),_0x1210e4=_0x2576b7[_0x3c5b9c(0x1e1)](_0x1def54=>processedDataStore[_0x1def54])[_0x3c5b9c(0x1b8)](_0x2ae22f=>_0x2ae22f&&_0x2ae22f[_0x3c5b9c(0x105)][_0x3c5b9c(0x1b7)][_0x3c5b9c(0x118)]>0x0);let _0x530533=_0x1210e4?_0x1210e4['extractedData'][_0x3c5b9c(0x1b7)]:[];_0x530533[_0x3c5b9c(0x118)]<_0x2c64fd&&(_0x530533=[..._0x530533,...Array(_0x2c64fd-_0x530533['length'])[_0x3c5b9c(0x103)]('')]);activeResults=_0x2576b7[_0x3c5b9c(0x1e1)](_0x3081d1=>{const _0x125fed=_0x3c5b9c,_0x567cbf=processedDataStore[_0x3081d1];if(_0x567cbf){const _0x118e47=padExtractedData(_0x567cbf[_0x125fed(0x105)],_0x2c64fd);return{'fileIdentifier':_0x3081d1,'extractedData':_0x118e47};}else return{'fileIdentifier':_0x3081d1,'extractedData':createEmptyData(_0x2c64fd)};});try{await setDoc(userDataDocRef,{'store':processedDataStore});}catch(_0x38e970){showError(_0x3c5b9c(0x16c)+_0x38e970['message']);}mergeAndDisplayResults(activeResults,_0x530533,_0x2c64fd),resultsDiv['classList'][_0x3c5b9c(0x10b)](_0x3c5b9c(0xfc)),showTab(0x1),progressStatus[_0x3c5b9c(0x14d)]=_0x3c5b9c(0x1bc),setTimeout(()=>{const _0x51a518=_0x3c5b9c;progressContainer[_0x51a518(0x19b)][_0x51a518(0x147)](_0x51a518(0xfc)),progressStatus[_0x51a518(0x19b)]['add'](_0x51a518(0xfc));},0x5dc);const _0x26d271=_0x2576b7[_0x3c5b9c(0x1a8)](_0x40ed5e=>processedDataStore[_0x40ed5e]);_0x26d271?completionBar[_0x3c5b9c(0x19b)][_0x3c5b9c(0x10b)](_0x3c5b9c(0xfc)):completionBar[_0x3c5b9c(0x19b)][_0x3c5b9c(0x147)](_0x3c5b9c(0xfc));}catch(_0x3dc505){showError(_0x3dc505),fileInput['value']='',progressContainer[_0x3c5b9c(0x19b)][_0x3c5b9c(0x147)](_0x3c5b9c(0xfc)),progressStatus[_0x3c5b9c(0x19b)][_0x3c5b9c(0x147)](_0x3c5b9c(0xfc));}}function resetUI(){const _0xa9eea=_0x131b70;outputScores[_0xa9eea(0x14d)]='',outputReading[_0xa9eea(0x14d)]='',outputRm['textContent']='',outputAttributes[_0xa9eea(0x14d)]='',outputCompetency[_0xa9eea(0x14d)]='',outputIndividual[_0xa9eea(0x14d)]='',visualScores[_0xa9eea(0x1be)]='',visualReading['innerHTML']='',visualRm['innerHTML']='',visualAttributes[_0xa9eea(0x1be)]='',visualCompetency[_0xa9eea(0x1be)]='',visualIndividual[_0xa9eea(0x1be)]='';if(semesterInfoEl)semesterInfoEl[_0xa9eea(0x14d)]='';if(completionBar)completionBar[_0xa9eea(0x19b)][_0xa9eea(0x147)]('hidden');[copyBtn1,copyBtn2,copyBtn3,copyBtn4,copyBtn5,copyBtn6][_0xa9eea(0x191)](_0x335533=>{const _0x204630=_0xa9eea;_0x335533&&(_0x335533[_0x204630(0x14d)]=_0x204630(0x1cf),_0x335533[_0x204630(0x19b)]['remove'](_0x204630(0x115),_0x204630(0x1de)),_0x335533[_0x204630(0x19b)][_0x204630(0x147)](_0x204630(0x17e),_0x204630(0x106)));});if(progressContainer)progressContainer[_0xa9eea(0x19b)][_0xa9eea(0x147)](_0xa9eea(0xfc));if(progressStatus)progressStatus['classList'][_0xa9eea(0x147)](_0xa9eea(0xfc));}function showError(_0x49c700){const _0x18e762=_0x131b70;errorText['textContent']=_0x49c700,errorDiv[_0x18e762(0x19b)][_0x18e762(0x10b)](_0x18e762(0xfc));}function getCellValue(_0x20ab90,_0x29f965,_0x30f2a4){const _0x36ee17=_0x131b70,_0x1caf32=_0x20ab90[XLSX[_0x36ee17(0x1ab)][_0x36ee17(0x18e)]({'r':_0x29f965,'c':_0x30f2a4})];if(!_0x1caf32)return'';return _0x1caf32['w']!==null&&_0x1caf32['w']!==undefined?String(_0x1caf32['w']):_0x1caf32['v']!==null&&_0x1caf32['v']!==undefined?String(_0x1caf32['v']):'';}function displaySemesterInfo(_0x13c79c){const _0x15fdef=_0x131b70;if(!semesterInfoEl)return;if(!_0x13c79c){semesterInfoEl['textContent']='';return;}const {semesterLabel:_0x47a190,yearLabel:_0x550156,semesterValue:_0x32a8f9,yearValue:_0x1a9511}=_0x13c79c;let _0x5a7d2b='';_0x32a8f9&&_0x1a9511&&(_0x32a8f9['includes'](_0x15fdef(0x1cc))?_0x5a7d2b='ตลอดปีการศึกษา\x20'+_0x1a9511:_0x5a7d2b=(_0x47a190||_0x15fdef(0x17d))+'\x20'+_0x32a8f9+'\x20'+(_0x550156||'ปีการศึกษา')+'\x20'+_0x1a9511),semesterInfoEl[_0x15fdef(0x14d)]=_0x5a7d2b;}function extractDataFromSheet(_0x26c7b9,_0x20525a){const _0x28542c=_0x131b70,_0x49d7b6=findLastStudentRowIndex(_0x26c7b9,0x6,0x37,0x3),_0x1e027f=_0x49d7b6<0x6?0x0:_0x49d7b6-0x6+0x1;let _0x33460e=[],_0x351954=[],_0x5dcbde=[],_0x5f26df=[],_0x31513f=[],_0x437162=[];if(_0x1e027f>0x0){for(let _0x17de11=0x6;_0x17de11<=_0x49d7b6;_0x17de11++){_0x33460e[_0x28542c(0x172)](getCellValue(_0x26c7b9,_0x17de11,0x3));}for(let _0x383245=0x5;_0x383245<=_0x49d7b6;_0x383245++){const _0x369010=getCellValue(_0x26c7b9,_0x383245,0x4),_0x5af844=getCellValue(_0x26c7b9,_0x383245,0x5),_0x65494=getCellValue(_0x26c7b9,_0x383245,0x6);let _0x1943c6=_0x65494;if(_0x383245>0x5&&!isNaN(parseFloat(_0x65494)))_0x1943c6=scoreToGrade(parseFloat(_0x65494));else{if(_0x383245>0x5){const _0x445f08=getCellValue(_0x26c7b9,_0x383245,0x7)['trim']();_0x445f08==='ร'||_0x445f08==='มส'?_0x1943c6=_0x445f08:_0x1943c6=0x0;}}_0x351954[_0x28542c(0x172)]([_0x369010,_0x5af844,_0x1943c6]['join']('\x09'));}for(let _0x4267f2=0x6;_0x4267f2<=_0x49d7b6;_0x4267f2++){let _0x3ad751=getCellValue(_0x26c7b9,_0x4267f2,0x7)[_0x28542c(0x11b)]();_0x5dcbde['push'](_0x3ad751==='ร'||_0x3ad751==='มส'?_0x3ad751:'');}if(_0x20525a===_0x28542c(0x122)){_0x5f26df[_0x28542c(0x172)](_0x28542c(0x12f));for(let _0x3fb13f=0x6;_0x3fb13f<=_0x49d7b6;_0x3fb13f++){const _0x8689a4=getCellValue(_0x26c7b9,_0x3fb13f,0x8),_0x2d6f75=getCellValue(_0x26c7b9,_0x3fb13f,0x9),_0x2bdaac=getCellValue(_0x26c7b9,_0x3fb13f,0xa),_0x325106=!isNaN(parseFloat(_0x8689a4))?scoreToGrade(parseFloat(_0x8689a4)):_0x8689a4,_0x3ed27e=!isNaN(parseFloat(_0x2d6f75))?scoreToGrade(parseFloat(_0x2d6f75)):_0x2d6f75,_0x11af9e=!isNaN(parseFloat(_0x2bdaac))?scoreToGrade(parseFloat(_0x2bdaac)):_0x2bdaac;_0x5f26df[_0x28542c(0x172)]([_0x325106,_0x3ed27e,_0x11af9e][_0x28542c(0x1bd)]('\x09'));}}else{_0x5f26df[_0x28542c(0x172)]('100');for(let _0x2fe9ad=0x6;_0x2fe9ad<=_0x49d7b6;_0x2fe9ad++){const _0x246502=getCellValue(_0x26c7b9,_0x2fe9ad,0xb),_0x30456f=!isNaN(parseFloat(_0x246502))?scoreToGrade(parseFloat(_0x246502)):_0x246502;_0x5f26df[_0x28542c(0x172)](_0x30456f);}}let _0x2dd062=[];for(let _0x12f9a6=0xd;_0x12f9a6<=0x14;_0x12f9a6++)_0x2dd062[_0x28542c(0x172)]('100');_0x31513f[_0x28542c(0x172)](_0x2dd062[_0x28542c(0x1bd)]('\x09'));for(let _0xefc8d0=0x6;_0xefc8d0<=_0x49d7b6;_0xefc8d0++){let _0x1ccc88=[];for(let _0xd317d2=0xd;_0xd317d2<=0x14;_0xd317d2++){const _0x854ad4=getCellValue(_0x26c7b9,_0xefc8d0,_0xd317d2),_0x499488=!isNaN(parseFloat(_0x854ad4))?scoreToGrade(parseFloat(_0x854ad4)):_0x854ad4;_0x1ccc88[_0x28542c(0x172)](_0x499488);}_0x31513f[_0x28542c(0x172)](_0x1ccc88[_0x28542c(0x1bd)]('\x09'));}let _0x5e892c=[];for(let _0x1c9f76=0x19;_0x1c9f76<=0x1d;_0x1c9f76++)_0x5e892c[_0x28542c(0x172)](_0x28542c(0x10e));_0x437162[_0x28542c(0x172)](_0x5e892c[_0x28542c(0x1bd)]('\x09'));for(let _0xef5f62=0x6;_0xef5f62<=_0x49d7b6;_0xef5f62++){let _0x2add37=[];for(let _0x20cce1=0x19;_0x20cce1<=0x1d;_0x20cce1++){const _0x3befe5=getCellValue(_0x26c7b9,_0xef5f62,_0x20cce1),_0x4beef3=!isNaN(parseFloat(_0x3befe5))?scoreToGrade(parseFloat(_0x3befe5)):_0x3befe5;_0x2add37[_0x28542c(0x172)](_0x4beef3);}_0x437162['push'](_0x2add37['join']('\x09'));}}else{_0x351954[_0x28542c(0x172)]('\x09\x09'),_0x5f26df[_0x28542c(0x172)](_0x20525a===_0x28542c(0x122)?_0x28542c(0x12f):_0x28542c(0x10e));let _0x41ed4e=[];for(let _0x174e03=0xd;_0x174e03<=0x14;_0x174e03++)_0x41ed4e['push']('100');_0x31513f['push'](_0x41ed4e['join']('\x09'));let _0x20e4e8=[];for(let _0x90f3c4=0x19;_0x90f3c4<=0x1d;_0x90f3c4++)_0x20e4e8['push'](_0x28542c(0x10e));_0x437162[_0x28542c(0x172)](_0x20e4e8['join']('\x09'));}return{'scoresLines':_0x351954,'rmLines':_0x5dcbde,'readingLines':_0x5f26df,'attrLines':_0x31513f,'compLines':_0x437162,'nameList':_0x33460e,'numStudentRows':_0x1e027f};}function buildVisualBlock(_0x53c202,_0x26d3d3,_0x4d0b26,_0x260ada,_0x20cf66){const _0x5cfa61=_0x131b70;_0x4d0b26['innerHTML']='';const _0x1e4b8d=_0x260ada,_0x5bf34f=document[_0x5cfa61(0x1c5)](_0x5cfa61(0x133));_0x5bf34f[_0x5cfa61(0x19f)]=_0x5cfa61(0x1e3),_0x5bf34f[_0x5cfa61(0x1be)]=_0x5cfa61(0x125);const _0x46befb=document[_0x5cfa61(0x1c5)](_0x5cfa61(0x133));_0x5bf34f[_0x5cfa61(0x17a)](_0x46befb);let _0x3e2750=[..._0x1e4b8d];if(_0x26d3d3!==_0x5cfa61(0xfb)&&_0x3e2750[_0x5cfa61(0x118)]>0x0)_0x3e2750[_0x5cfa61(0x168)]('');else _0x26d3d3!==_0x5cfa61(0xfb)&&_0x3e2750['length']===0x0&&_0x3e2750[_0x5cfa61(0x168)]('');_0x3e2750['forEach']((_0x5f5bd5,_0x5db82f)=>{const _0x6ebf70=_0x5cfa61,_0xfb933f=document[_0x6ebf70(0x1c5)](_0x6ebf70(0x133));_0xfb933f[_0x6ebf70(0x19f)]=_0x6ebf70(0x1aa);if(_0x5db82f%0x2!==0x0)_0xfb933f[_0x6ebf70(0x19b)][_0x6ebf70(0x147)](_0x6ebf70(0x109));_0xfb933f['textContent']=_0x5f5bd5||'\u00a0',_0x46befb[_0x6ebf70(0x17a)](_0xfb933f);}),_0x4d0b26[_0x5cfa61(0x17a)](_0x5bf34f),_0x53c202[_0x5cfa61(0x191)]((_0x1dad42,_0x3ae952)=>{const _0x1d5183=_0x5cfa61,{fileIdentifier:_0x1a27be,extractedData:_0x66ca06}=_0x1dad42,_0xbe8f83=document['createElement'](_0x1d5183(0x133));_0xbe8f83['className']=_0x1d5183(0x156);if(_0x3ae952<_0x53c202[_0x1d5183(0x118)]-0x1)_0xbe8f83[_0x1d5183(0x19f)]+=_0x1d5183(0x1ad);_0xbe8f83[_0x1d5183(0x1be)]='<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-blue-600\x20mb-2\x20whitespace-nowrap\x22>'+_0x1a27be+_0x1d5183(0x19e);const _0x4f44af=document['createElement'](_0x1d5183(0x133));_0xbe8f83['appendChild'](_0x4f44af);const _0x37440c=_0x66ca06&&_0x66ca06[_0x26d3d3]?_0x66ca06[_0x26d3d3]:createEmptyData(_0x20cf66)[_0x26d3d3];_0x37440c['forEach']((_0x5ac218,_0x35314d)=>{const _0x33b552=_0x1d5183,_0x3a55f0=document[_0x33b552(0x1c5)](_0x33b552(0x133));_0x3a55f0['className']=_0x33b552(0x1ce);if(_0x35314d%0x2!==0x0)_0x3a55f0['classList'][_0x33b552(0x147)](_0x33b552(0x109));_0x3a55f0['textContent']=_0x5ac218||'\u00a0',_0x4f44af[_0x33b552(0x17a)](_0x3a55f0);}),_0x4d0b26[_0x1d5183(0x17a)](_0xbe8f83);});}function mergeAndDisplayResults(_0x3811ad,_0x2436fe,_0x5506b6){const _0x58e3e9=_0x131b70,_0x236019=(_0x332071,_0x467c4c)=>{const _0x578739=_0x3a2a;let _0x79a135='';for(let _0x37b06f=0x0;_0x37b06f<_0x467c4c;_0x37b06f++){let _0x2f4517=[];for(const _0x194797 of _0x3811ad){const _0x411224=_0x194797[_0x578739(0x105)]&&_0x194797[_0x578739(0x105)][_0x332071]&&_0x194797[_0x578739(0x105)][_0x332071][_0x37b06f]!==undefined?_0x194797[_0x578739(0x105)][_0x332071][_0x37b06f]:createEmptyData(_0x5506b6)[_0x332071][_0x37b06f];_0x332071===_0x578739(0x182)&&currentUserTemplate!==_0x578739(0x122)?_0x2f4517['push'](_0x411224+'\x09\x09'):_0x2f4517['push'](_0x411224);}_0x79a135+=_0x2f4517[_0x578739(0x1bd)]('\x09')+'\x0a';}return _0x79a135[_0x578739(0x173)]();},_0x549ed7={'scoresLines':_0x5506b6+0x1,'rmLines':_0x5506b6,'readingLines':_0x5506b6+0x1,'attrLines':_0x5506b6+0x1,'compLines':_0x5506b6+0x1};outputScores[_0x58e3e9(0x14d)]=_0x236019('scoresLines',_0x549ed7[_0x58e3e9(0x14f)]),outputRm['textContent']=_0x236019('rmLines',_0x549ed7['rmLines']),outputReading['textContent']=_0x236019(_0x58e3e9(0x182),_0x549ed7[_0x58e3e9(0x182)]),outputAttributes[_0x58e3e9(0x14d)]=_0x236019(_0x58e3e9(0x10c),_0x549ed7[_0x58e3e9(0x10c)]),outputCompetency['textContent']=_0x236019('compLines',_0x549ed7[_0x58e3e9(0xfe)]),buildVisualBlock(_0x3811ad,'scoresLines',visualScores,_0x2436fe,_0x5506b6),buildVisualBlock(_0x3811ad,_0x58e3e9(0xfb),visualRm,_0x2436fe,_0x5506b6),buildVisualBlock(_0x3811ad,'readingLines',visualReading,_0x2436fe,_0x5506b6),buildVisualBlock(_0x3811ad,'attrLines',visualAttributes,_0x2436fe,_0x5506b6),buildVisualBlock(_0x3811ad,_0x58e3e9(0xfe),visualCompetency,_0x2436fe,_0x5506b6),buildIndividualTab(_0x3811ad,_0x2436fe,_0x5506b6);}function copyToClipboard(_0xf837c3,_0x403fdf){const _0x93a8ee=_0x131b70,_0x450af1=document[_0x93a8ee(0x1c5)](_0x93a8ee(0x19a));_0x450af1[_0x93a8ee(0x11d)]=_0xf837c3,_0x450af1[_0x93a8ee(0x165)][_0x93a8ee(0x144)]='fixed',_0x450af1[_0x93a8ee(0x165)]['opacity']=0x0,document[_0x93a8ee(0x197)][_0x93a8ee(0x17a)](_0x450af1),_0x450af1['select']();try{document['execCommand'](_0x93a8ee(0x1d1));const _0x1203cb=_0x403fdf[_0x93a8ee(0x14d)];_0x403fdf[_0x93a8ee(0x14d)]='คัดลอกแล้ว!',_0x403fdf['classList'][_0x93a8ee(0x10b)](_0x93a8ee(0x17e),_0x93a8ee(0x106)),_0x403fdf[_0x93a8ee(0x19b)][_0x93a8ee(0x147)](_0x93a8ee(0x115)),setTimeout(()=>{const _0x5ac255=_0x93a8ee;_0x403fdf['textContent']=_0x1203cb,_0x403fdf[_0x5ac255(0x19b)]['remove'](_0x5ac255(0x115)),_0x403fdf[_0x5ac255(0x19b)]['add'](_0x5ac255(0x17e),_0x5ac255(0x106));},0x5dc);}catch(_0x48ca6f){console[_0x93a8ee(0x163)]('Failed\x20to\x20copy\x20text:\x20',_0x48ca6f);}document[_0x93a8ee(0x197)][_0x93a8ee(0x15b)](_0x450af1);}function scoreToGrade(_0x4229fd){if(_0x4229fd>=0x50)return 0x4;if(_0x4229fd>=0x4b)return 3.5;if(_0x4229fd>=0x46)return 0x3;if(_0x4229fd>=0x41)return 2.5;if(_0x4229fd>=0x3c)return 0x2;if(_0x4229fd>=0x37)return 1.5;if(_0x4229fd>=0x32)return 0x1;return 0x0;}function calculateGPA(_0x55be61,_0xc0a3,_0x3d8075){const _0x21ea47=_0x131b70;let _0x3ec9e8=0x0,_0xca9df5=0x0;for(let _0x5ed3dc=0x0;_0x5ed3dc<_0x55be61['length'];_0x5ed3dc++){if(_0xc0a3[_0x5ed3dc]!=='ร'&&_0xc0a3[_0x5ed3dc]!=='มส'){const _0x64f9c=isNaN(_0x55be61[_0x5ed3dc])?0x0:_0x55be61[_0x5ed3dc],_0x19181a=_0x3d8075[_0x5ed3dc];_0x3ec9e8+=_0x64f9c*_0x19181a,_0xca9df5+=_0x19181a;}}if(_0xca9df5===0x0)return 0x0['toFixed'](0x2);const _0x36545c=_0x3ec9e8/_0xca9df5;return _0x36545c[_0x21ea47(0x124)](0x2);}function calculateRanks(_0xd68439){const _0x170653=_0x131b70,_0x92cb05=_0xd68439[_0x170653(0x1e1)]((_0x2c0f39,_0x44c2a7)=>({'gpa':parseFloat(_0x2c0f39),'originalIndex':_0x44c2a7}));_0x92cb05['sort']((_0x583b1f,_0x3ce267)=>_0x3ce267['gpa']-_0x583b1f['gpa']);const _0x2ff134=new Array(_0xd68439[_0x170653(0x118)]);let _0x275c41=0x0,_0x327633=-0x1,_0x258fea=0x0;for(let _0x16143a=0x0;_0x16143a<_0x92cb05['length'];_0x16143a++){const _0x42b93b=_0x92cb05[_0x16143a];_0x42b93b[_0x170653(0x136)]!==_0x327633?(_0x275c41+=_0x258fea+0x1,_0x258fea=0x0,_0x327633=_0x42b93b[_0x170653(0x136)]):_0x258fea++,_0x2ff134[_0x42b93b[_0x170653(0x16b)]]=_0x275c41;}return _0x2ff134;}function buildIndividualTab(_0x39605a,_0x5db5a2,_0x3f21b6){const _0x2478bd=_0x131b70;visualIndividual['innerHTML']='',outputIndividual['textContent']='';if(_0x3f21b6===0x0){visualIndividual[_0x2478bd(0x1be)]='<p\x20class=\x22text-gray-500\x20text-center\x20p-4\x22>ไม่มีข้อมูลนักเรียน</p>';return;}const _0x207ec7=currentUserTemplate===_0x2478bd(0x122)?PRIMARY_TEMPLATE:SECONDARY_TEMPLATE,{shortNames:_0x2bf85b,credits:_0x724884}=_0x207ec7;let _0x9e6448=[];for(let _0x33250e=0x0;_0x33250e<_0x3f21b6;_0x33250e++){const _0x36a16b=_0x5db5a2[_0x33250e];let _0x567e5b=[],_0x2832bf=[];for(let _0x396f00=0x0;_0x396f00<_0x39605a[_0x2478bd(0x118)];_0x396f00++){const _0x5b4957=_0x39605a[_0x396f00],_0xd0685=_0x5b4957[_0x2478bd(0x105)]['scoresLines'][_0x33250e+0x1],_0x2f0b0e=_0x5b4957[_0x2478bd(0x105)][_0x2478bd(0xfb)][_0x33250e]||'';_0x2832bf[_0x2478bd(0x172)](_0x2f0b0e['trim']());if(_0xd0685){const _0x388f94=_0xd0685[_0x2478bd(0x1bf)]('\x09'),_0x296b5f=_0x388f94[0x2];if(_0x296b5f==='ร'||_0x296b5f==='มส'){_0x567e5b[_0x2478bd(0x172)](0x0);if(_0x2832bf[_0x396f00]==='')_0x2832bf[_0x396f00]=_0x296b5f;}else{const _0x30257a=parseFloat(_0x296b5f);let _0x37be5a=0x0;!isNaN(_0x30257a)&&(_0x30257a>0x4?_0x37be5a=scoreToGrade(_0x30257a):_0x37be5a=_0x30257a),_0x567e5b[_0x2478bd(0x172)](_0x37be5a);}}else _0x567e5b[_0x2478bd(0x172)](0x0);}const _0x56dc94=calculateGPA(_0x567e5b,_0x2832bf,_0x724884);_0x9e6448[_0x2478bd(0x172)]({'name':_0x36a16b,'grades':_0x567e5b,'rms':_0x2832bf,'gpa':_0x56dc94,'rank':0x0});}const _0x5e3692=_0x9e6448[_0x2478bd(0x1e1)](_0x508d1a=>_0x508d1a[_0x2478bd(0x136)]),_0xfdcb99=calculateRanks(_0x5e3692);_0x9e6448[_0x2478bd(0x191)]((_0x2e5c54,_0x1e7d0a)=>_0x2e5c54[_0x2478bd(0x14b)]=_0xfdcb99[_0x1e7d0a]);const _0x4b8e80=document[_0x2478bd(0x1c5)]('table'),_0x23465c=document[_0x2478bd(0x1c5)](_0x2478bd(0x149)),_0x225604=document[_0x2478bd(0x1c5)](_0x2478bd(0x152));let _0x43e4ff='<tr><th>ชื่อ-สกุล</th><th>เกรดเฉลี่ย</th><th>อันดับ</th>';_0x2bf85b[_0x2478bd(0x191)](_0x2357cd=>{const _0x50a401=_0x2478bd;_0x43e4ff+=_0x50a401(0x181)+_0x2357cd+_0x50a401(0xf7);}),_0x43e4ff+=_0x2478bd(0x1d4),_0x23465c['innerHTML']=_0x43e4ff;let _0x3dc799=_0x2478bd(0x17b)+_0x2bf85b[_0x2478bd(0x1bd)]('\x09')+'\x0a';_0x9e6448['forEach'](_0x58e830=>{const _0x532570=_0x2478bd;let _0x40cc65='<tr><td>'+_0x58e830[_0x532570(0x107)]+_0x532570(0x120);_0x40cc65+=_0x532570(0x134)+_0x58e830['gpa']+_0x532570(0x120),_0x40cc65+=_0x532570(0x134)+_0x58e830[_0x532570(0x14b)]+'</td>';let _0x397cf9=_0x58e830['name']+'\x09'+_0x58e830['gpa']+'\x09'+_0x58e830[_0x532570(0x14b)]+'\x09';_0x58e830[_0x532570(0x18b)][_0x532570(0x191)]((_0xdd1b20,_0x18b664)=>{const _0x256051=_0x532570,_0x403139=_0x58e830['rms'][_0x18b664]||_0xdd1b20,_0x1811e7=_0x403139===0x0||_0x403139==='0'||_0x403139==='ร'||_0x403139==='มส',_0x4ef2ed=_0x1811e7?'\x20class=\x22text-danger\x22':'';_0x40cc65+=_0x256051(0x13b)+_0x4ef2ed+'>'+_0x403139+_0x256051(0x120),_0x397cf9+=_0x403139+'\x09';}),_0x40cc65+=_0x532570(0x1d4),_0x225604['innerHTML']+=_0x40cc65,_0x3dc799+=_0x397cf9['trimEnd']()+'\x0a';}),_0x4b8e80[_0x2478bd(0x17a)](_0x23465c),_0x4b8e80['appendChild'](_0x225604),visualIndividual[_0x2478bd(0x17a)](_0x4b8e80),outputIndividual['textContent']=_0x3dc799['trim'](),_0x225604[_0x2478bd(0x100)](_0x2478bd(0x108),_0x30aeaf=>{const _0x502cb3=_0x2478bd,_0x356826=_0x30aeaf[_0x502cb3(0x110)][_0x502cb3(0x198)]('tr');if(!_0x356826)return;const _0x59ba5b=_0x225604['querySelector'](_0x502cb3(0x194));_0x59ba5b&&_0x59ba5b[_0x502cb3(0x19b)][_0x502cb3(0x10b)](_0x502cb3(0x1c8)),_0x59ba5b!==_0x356826&&_0x356826[_0x502cb3(0x19b)][_0x502cb3(0x147)](_0x502cb3(0x1c8));});}
