const _0x1f5355=_0x23f0;(function(_0x481f58,_0xf7d686){const _0xe79a96=_0x23f0,_0x3737ce=_0x481f58();while(!![]){try{const _0xc7094c=-parseInt(_0xe79a96(0x1a2))/0x1*(-parseInt(_0xe79a96(0x240))/0x2)+parseInt(_0xe79a96(0x239))/0x3*(parseInt(_0xe79a96(0x215))/0x4)+-parseInt(_0xe79a96(0x210))/0x5*(parseInt(_0xe79a96(0x1a8))/0x6)+-parseInt(_0xe79a96(0x1a9))/0x7*(-parseInt(_0xe79a96(0x20b))/0x8)+-parseInt(_0xe79a96(0x260))/0x9+parseInt(_0xe79a96(0x23f))/0xa+-parseInt(_0xe79a96(0x1b9))/0xb*(parseInt(_0xe79a96(0x1f6))/0xc);if(_0xc7094c===_0xf7d686)break;else _0x3737ce['push'](_0x3737ce['shift']());}catch(_0x108aca){_0x3737ce['push'](_0x3737ce['shift']());}}}(_0x3a9c,0x754c1));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,setLogLevel}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';let db,auth,appId=_0x1f5355(0x1dd),passwordListDocRef,settingsDocRef,currentUserPassword=null,currentUserName=null,activeResults=[],fullSavedOrder=[],activeTopicsOrderList,availableTopicsPoolList;const loginScreen=document[_0x1f5355(0x212)](_0x1f5355(0x214)),adminPanel=document[_0x1f5355(0x212)](_0x1f5355(0x250)),mainApp=document['getElementById'](_0x1f5355(0x1af)),adminBtn=document[_0x1f5355(0x212)]('admin-btn'),loginBtn=document['getElementById']('login-btn'),passwordInput=document[_0x1f5355(0x212)](_0x1f5355(0x1b1)),loginError=document[_0x1f5355(0x212)](_0x1f5355(0x1f8)),logoutBtn=document[_0x1f5355(0x212)]('logout-btn'),adminCloseBtn=document['getElementById']('admin-close-btn'),adminNameInput=document['getElementById'](_0x1f5355(0x1df)),adminPassInput=document[_0x1f5355(0x212)](_0x1f5355(0x25d)),adminAddBtn=document['getElementById'](_0x1f5355(0x261)),adminUserListContainer=document[_0x1f5355(0x212)](_0x1f5355(0x22e)),adminError=document[_0x1f5355(0x212)](_0x1f5355(0x1be)),fileInput=document[_0x1f5355(0x212)]('file-upload'),resultsDiv=document[_0x1f5355(0x212)](_0x1f5355(0x1d1)),errorDiv=document[_0x1f5355(0x212)](_0x1f5355(0x256)),errorText=document[_0x1f5355(0x212)](_0x1f5355(0x247)),outputScores=document[_0x1f5355(0x212)](_0x1f5355(0x23c)),outputReading=document[_0x1f5355(0x212)](_0x1f5355(0x19c)),outputRm=document[_0x1f5355(0x212)](_0x1f5355(0x1b0)),outputAttributes=document[_0x1f5355(0x212)](_0x1f5355(0x24d)),outputCompetency=document[_0x1f5355(0x212)](_0x1f5355(0x1e6)),visualScores=document['getElementById'](_0x1f5355(0x1ea)),visualReading=document[_0x1f5355(0x212)]('visual-reading'),visualRm=document[_0x1f5355(0x212)]('visual-rm'),visualAttributes=document[_0x1f5355(0x212)](_0x1f5355(0x268)),visualCompetency=document['getElementById'](_0x1f5355(0x1e2)),copyBtn1=document[_0x1f5355(0x212)](_0x1f5355(0x1a5)),copyBtn2=document[_0x1f5355(0x212)](_0x1f5355(0x20d)),copyBtn3=document[_0x1f5355(0x212)]('copy-btn-3'),copyBtn4=document['getElementById'](_0x1f5355(0x1f0)),copyBtn5=document[_0x1f5355(0x212)](_0x1f5355(0x1d8)),sortControls=document[_0x1f5355(0x212)](_0x1f5355(0x246)),openSortModalBtn=document[_0x1f5355(0x212)]('open-sort-modal-btn'),sortModal=document[_0x1f5355(0x212)](_0x1f5355(0x1d9)),closeSortModalBtn=document['getElementById'](_0x1f5355(0x1c5)),saveOrderBtn=document['getElementById'](_0x1f5355(0x225)),cancelSortBtn=document[_0x1f5355(0x212)](_0x1f5355(0x241)),resetOrderBtn=document[_0x1f5355(0x212)](_0x1f5355(0x1d5)),activeTopicsContainer=document['getElementById'](_0x1f5355(0x25c)),availableTopicsContainer=document[_0x1f5355(0x212)](_0x1f5355(0x1e8)),progressContainer=document[_0x1f5355(0x212)](_0x1f5355(0x235)),progressBar=document[_0x1f5355(0x212)](_0x1f5355(0x1b2)),progressText=document['getElementById'](_0x1f5355(0x1a1)),progressStatus=document['getElementById'](_0x1f5355(0x1c3));function showTab(_0x5efc7b){const _0x354e2b=_0x1f5355;document['querySelectorAll'](_0x354e2b(0x265))[_0x354e2b(0x1b3)](_0x1e8065=>_0x1e8065[_0x354e2b(0x203)][_0x354e2b(0x248)](_0x354e2b(0x22d),_0x354e2b(0x1ff),_0x354e2b(0x25e),_0x354e2b(0x1f3))),document[_0x354e2b(0x1f2)]('.tab-content')[_0x354e2b(0x1b3)](_0x1e0483=>_0x1e0483[_0x354e2b(0x203)][_0x354e2b(0x1eb)](_0x354e2b(0x1c7)));const _0x51641d=document[_0x354e2b(0x212)](_0x354e2b(0x242)+_0x5efc7b),_0xd6aba=document['getElementById'](_0x354e2b(0x1e5)+_0x5efc7b);if(_0x51641d)_0x51641d['classList'][_0x354e2b(0x1eb)](_0x354e2b(0x22d),'border-blue-600','text-blue-600','font-medium');if(_0xd6aba)_0xd6aba[_0x354e2b(0x203)][_0x354e2b(0x248)]('hidden');}window[_0x1f5355(0x1b8)]=showTab;async function main(){const _0x43e92c=_0x1f5355;try{const _0x15712d={'apiKey':'AIzaSyBHmJ7M5qf20lKPTB9_aE2Ppa0-jTryuuI','authDomain':'programpp-91f08.firebaseapp.com','projectId':_0x43e92c(0x257),'storageBucket':_0x43e92c(0x1cd),'messagingSenderId':_0x43e92c(0x1fe),'appId':_0x43e92c(0x216),'measurementId':_0x43e92c(0x25a)},_0x31f326=typeof __firebase_config!==_0x43e92c(0x1e4)?JSON[_0x43e92c(0x223)](__firebase_config):_0x15712d;appId=typeof __app_id!==_0x43e92c(0x1e4)?__app_id:_0x43e92c(0x1dd);if(!_0x31f326['projectId'])throw new Error(_0x43e92c(0x19b));const _0x5d1ae1=initializeApp(_0x31f326);db=getFirestore(_0x5d1ae1),auth=getAuth(_0x5d1ae1),setLogLevel(_0x43e92c(0x208));typeof __initial_auth_token!==_0x43e92c(0x1e4)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);const _0x540798=_0x43e92c(0x266)+appId+_0x43e92c(0x221);passwordListDocRef=doc(db,_0x540798),loginBtn['addEventListener'](_0x43e92c(0x1db),loginUser),adminBtn[_0x43e92c(0x238)](_0x43e92c(0x1db),promptAdminAccess),adminCloseBtn[_0x43e92c(0x238)]('click',closeAdminPanel),adminAddBtn[_0x43e92c(0x238)]('click',adminAddPassword),logoutBtn[_0x43e92c(0x238)]('click',logoutUser),passwordInput['addEventListener'](_0x43e92c(0x1cb),_0x1e4960=>{const _0x410999=_0x43e92c;if(_0x1e4960[_0x410999(0x228)]===_0x410999(0x1ed))loginUser();}),fileInput[_0x43e92c(0x238)](_0x43e92c(0x1fb),handleFile),copyBtn1[_0x43e92c(0x238)]('click',()=>copyToClipboard(outputScores[_0x43e92c(0x21b)],copyBtn1)),copyBtn2[_0x43e92c(0x238)](_0x43e92c(0x1db),()=>copyToClipboard(outputRm['textContent'],copyBtn2)),copyBtn3[_0x43e92c(0x238)](_0x43e92c(0x1db),()=>copyToClipboard(outputReading[_0x43e92c(0x21b)],copyBtn3)),copyBtn4['addEventListener'](_0x43e92c(0x1db),()=>copyToClipboard(outputAttributes[_0x43e92c(0x21b)],copyBtn4)),copyBtn5[_0x43e92c(0x238)]('click',()=>copyToClipboard(outputCompetency[_0x43e92c(0x21b)],copyBtn5)),openSortModalBtn[_0x43e92c(0x238)](_0x43e92c(0x1db),()=>{const _0x24d62e=_0x43e92c;populateSortModal(),sortModal[_0x24d62e(0x203)][_0x24d62e(0x248)](_0x24d62e(0x1c7));}),closeSortModalBtn[_0x43e92c(0x238)](_0x43e92c(0x1db),()=>sortModal['classList']['add'](_0x43e92c(0x1c7))),cancelSortBtn[_0x43e92c(0x238)]('click',()=>sortModal['classList'][_0x43e92c(0x1eb)](_0x43e92c(0x1c7))),saveOrderBtn[_0x43e92c(0x238)]('click',saveAndApplyOrder),resetOrderBtn['addEventListener'](_0x43e92c(0x1db),resetOrder),initializeSortable(),loginScreen[_0x43e92c(0x203)][_0x43e92c(0x248)](_0x43e92c(0x1c7)),adminPanel[_0x43e92c(0x203)]['add'](_0x43e92c(0x1c7)),mainApp['classList'][_0x43e92c(0x1eb)](_0x43e92c(0x1c7));}catch(_0x1b0c94){console[_0x43e92c(0x200)]('Initialization\x20failed:',_0x1b0c94),showError(_0x43e92c(0x258)+_0x1b0c94[_0x43e92c(0x1fa)]),loginScreen['innerHTML']=_0x43e92c(0x20e)+_0x1b0c94[_0x43e92c(0x1fa)]+_0x43e92c(0x254);}}document[_0x1f5355(0x238)](_0x1f5355(0x20a),main);async function loginUser(){const _0x52f753=_0x1f5355,_0x50ef1f=passwordInput['value'];if(!_0x50ef1f)return;loginError[_0x52f753(0x203)][_0x52f753(0x1eb)](_0x52f753(0x1c7));try{const _0x572823=await getDoc(passwordListDocRef),_0x95cdac=_0x572823['data']()?.[_0x52f753(0x22b)]||[],_0x40f912=_0x95cdac[_0x52f753(0x1f5)](_0x3a382c=>_0x3a382c['password']===_0x50ef1f);if(_0x40f912){currentUserPassword=_0x50ef1f,currentUserName=_0x40f912[_0x52f753(0x1d6)];const _0x1de6fd=_0x52f753(0x266)+appId+_0x52f753(0x264)+currentUserPassword;settingsDocRef=doc(db,_0x1de6fd),loginScreen['classList'][_0x52f753(0x1eb)](_0x52f753(0x1c7)),mainApp[_0x52f753(0x203)]['remove'](_0x52f753(0x1c7)),adminBtn['classList'][_0x52f753(0x1eb)](_0x52f753(0x1c7));const _0x36034f=document['getElementById'](_0x52f753(0x21c));_0x36034f&&(_0x36034f[_0x52f753(0x21b)]='ยินดีต้อนรับ,\x20'+currentUserName),fileInput['value']='',resetUI(),resultsDiv[_0x52f753(0x203)][_0x52f753(0x1eb)](_0x52f753(0x1c7)),sortControls[_0x52f753(0x203)][_0x52f753(0x1eb)](_0x52f753(0x1c7));}else loginError[_0x52f753(0x203)][_0x52f753(0x248)](_0x52f753(0x1c7));}catch(_0x507d07){console['error'](_0x52f753(0x245),_0x507d07),loginError['querySelector'](_0x52f753(0x21a))[_0x52f753(0x21b)]=_0x52f753(0x1cc)+_0x507d07['message'],loginError[_0x52f753(0x203)]['remove'](_0x52f753(0x1c7));}}function logoutUser(){const _0x7b2d1e=_0x1f5355;currentUserPassword=null,currentUserName=null,settingsDocRef=null,mainApp[_0x7b2d1e(0x203)]['add'](_0x7b2d1e(0x1c7)),loginScreen[_0x7b2d1e(0x203)][_0x7b2d1e(0x248)](_0x7b2d1e(0x1c7)),adminBtn[_0x7b2d1e(0x203)][_0x7b2d1e(0x248)](_0x7b2d1e(0x1c7)),passwordInput['value']='',loginError[_0x7b2d1e(0x203)][_0x7b2d1e(0x1eb)](_0x7b2d1e(0x1c7));const _0x248e71=document[_0x7b2d1e(0x212)](_0x7b2d1e(0x21c));_0x248e71&&(_0x248e71[_0x7b2d1e(0x21b)]='');}function _0x3a9c(){const _0x43fce1=['find','60636HbRfAc','ไม่สามารถบันทึกการจัดเรียงได้:\x20','login-error','children','message','change','.admin-edit-btn','ประมวลผลเสร็จสิ้น!','415403943738','border-blue-600','error','<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-gray-700\x20mb-2\x20whitespace-nowrap\x22>ชื่อ-สกุล</div>','Failed\x20to\x20copy\x20text:\x20','classList','password','กรุณาใส่รหัสผ่าน\x20Admin:','Error\x20resetting\x20order:\x20','fixed','Debug','createElement','DOMContentLoaded','184OgWlJg','available','copy-btn-2','<p\x20class=\x22text-red-500\x22>Initialization\x20failed:\x20',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','55ZrCEMP','files','getElementById','</span>','login-screen','1492DPJxSc','1:415403943738:web:f56ec72de49f81f0315203','result','data','shared-topics','span','textContent','welcome-message','SheetNames','Error\x20fetching\x20saved\x20order:\x20','scoresLines','ไม่สามารถรีเซ็ตการจัดเรียงได้:\x20','/public/data/passwords/password_list','className','parse','map','save-order-btn','รายงาน1','dataset','key','Error\x20deleting\x20password:','bg-gray-100','passwords','sortable-chosen','active','admin-user-list-container','attrLines','read','some','กำลังจัดเรียงข้อมูล...','rmLines','opacity','progress-container','order','trimEnd','addEventListener','957Mgvzhe','คุณแน่ใจหรือไม่ว่าต้องการลบการจัดเรียงที่บันทึกไว้ทั้งหมดสำหรับรหัสผ่านนี้?','กำลังประมวลผลไฟล์\x20','output-scores','appendChild','unshift','201820qojBFO','2986oHPFGp','cancel-sort-btn','tab-btn-','\x22\x20class=\x22admin-edit-btn\x20text-blue-500\x20hover:text-blue-700\x20font-medium\x20text-sm\x20mr-3\x22>แก้ไข</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','sort','Login\x20error:','sort-controls','error-text','remove','length','flex-shrink-0\x20p-3\x20pr-4\x20border-r-2\x20border-gray-300','onclick','filter','output-attributes','div','target','admin-panel','ไม่พบชีต\x20‘Home’\x20ในไฟล์:\x20','parentNode','\x20bg-red-500\x20hover:bg-red-600','</p>','คัดลอก\x20(เฉพาะข้อมูล)','error-message','programpp-91f08','Initialization\x20failed:\x20','รหัสผ่าน\x20Admin\x20ไม่ถูกต้อง','G-W19QNQQR25','เกิดข้อผิดพลาด:\x20ไม่ได้เข้าสู่ระบบ\x20(settingsDocRef\x20is\x20null)','active-topics-order','admin-pass-input','text-blue-600','Sheets','4992300DCRjym','admin-add-btn','Error\x20loading\x20password\x20list:','removeChild','/public/data/settings_by_password/','.tab-btn','/artifacts/','ไม่ได้เข้าสู่ระบบ','visual-attributes','\x22projectId\x22\x20not\x20provided','output-reading','hover:bg-green-600','readingLines','readAsArrayBuffer','fileIdentifier','progress-text','389uEKCgk','กรุณากรอกทั้งชื่อและรหัสผ่าน','sortable-item\x20flex\x20items-center\x20justify-between\x20p-2.5\x20bg-white\x20border\x20border-gray-300\x20rounded-lg\x20shadow-sm','copy-btn-1','push','2741','158658xlmfLC','195223Pmqifk','\x20border-r-2\x20border-dashed\x20border-gray-300','compLines','trim','encode_cell','nameList','main-app','output-rm','password-input','progress-bar','forEach','array','flex-shrink-0\x20p-3','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-medium\x20text-gray-800\x22>','bg-blue-500','showTab','77XgXENe','\x22\x20class=\x22admin-delete-btn\x20text-red-500\x20hover:text-red-700\x20font-medium\x20text-sm\x22>ลบ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22?\x20\x0a(ข้อมูลการจัดเรียงของผู้ใช้นี้จะยังคงอยู่\x20แต่จะไม่สามารถเข้าระบบได้อีก)','value','pass','admin-error','Error\x20adding\x20password:','100','\x20bg-green-500\x20hover:bg-green-600','innerHTML','progress-status','คัดลอกแล้ว!','close-sort-modal-btn','bg-red-500','hidden','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-gray-500\x20ml-2\x22>(รหัส:\x20','from','<span\x20class=\x22text-sm\x20font-medium\x20text-gray-800\x22>','keypress','เกิดข้อผิดพลาด:\x20','programpp-91f08.firebasestorage.app','style','indexOf','\x20ได้','results','onload','join','onerror','reset-order-btn','name','รหัสผ่านนี้ถูกใช้แล้ว','copy-btn-5','sort-modal','flex\x20items-center\x20justify-between\x20p-2.5\x20bg-white\x20border\x20border-gray-300\x20rounded-lg','click','width','default-app-id','extractedData','admin-name-input','Home','copy','visual-competency','<p\x20class=\x22text-gray-500\x22>กำลังโหลด...</p>','undefined','tab-content-','output-competency','includes','available-topics-pool','ไม่สามารถดึงข้อมูลการจัดเรียงที่บันทึกไว้ได้','visual-scores','add','คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้ที่มีรหัสผ่าน\x20\x22','Enter','execCommand','กำลังเตรียมไฟล์...\x20(0/','copy-btn-4','</div>','querySelectorAll','font-medium','<p\x20class=\x22text-gray-500\x22>ยังไม่มีผู้ใช้งาน</p>'];_0x3a9c=function(){return _0x43fce1;};return _0x3a9c();}function promptAdminAccess(){const _0xd32dce=_0x1f5355,_0x3d121c=prompt(_0xd32dce(0x205));if(_0x3d121c===_0xd32dce(0x1a7))loginScreen[_0xd32dce(0x203)][_0xd32dce(0x1eb)](_0xd32dce(0x1c7)),adminPanel[_0xd32dce(0x203)][_0xd32dce(0x248)](_0xd32dce(0x1c7)),loadAdminPasswordList();else _0x3d121c&&alert(_0xd32dce(0x259));}function closeAdminPanel(){const _0x4a2dd8=_0x1f5355;adminPanel[_0x4a2dd8(0x203)][_0x4a2dd8(0x1eb)](_0x4a2dd8(0x1c7)),loginScreen[_0x4a2dd8(0x203)][_0x4a2dd8(0x248)](_0x4a2dd8(0x1c7)),adminError['classList']['add'](_0x4a2dd8(0x1c7));}async function loadAdminPasswordList(){const _0x276f24=_0x1f5355;adminUserListContainer[_0x276f24(0x1c2)]=_0x276f24(0x1e3);try{const _0x44bbbf=await getDoc(passwordListDocRef),_0x1100ee=_0x44bbbf[_0x276f24(0x218)]()?.[_0x276f24(0x22b)]||[];adminUserListContainer[_0x276f24(0x1c2)]='';if(_0x1100ee['length']===0x0){adminUserListContainer[_0x276f24(0x1c2)]=_0x276f24(0x1f4);return;}_0x1100ee[_0x276f24(0x1b3)](_0x4fc2e6=>{const _0x515d27=_0x276f24,_0x27eca2=document[_0x515d27(0x209)]('div');_0x27eca2[_0x515d27(0x222)]=_0x515d27(0x1da),_0x27eca2['innerHTML']=_0x515d27(0x1b6)+_0x4fc2e6['name']+_0x515d27(0x1c8)+_0x4fc2e6[_0x515d27(0x204)]+_0x515d27(0x20f)+_0x4fc2e6['password']+_0x515d27(0x243)+_0x4fc2e6['password']+_0x515d27(0x1ba),adminUserListContainer[_0x515d27(0x23d)](_0x27eca2);}),document[_0x276f24(0x1f2)]('.admin-delete-btn')[_0x276f24(0x1b3)](_0x135149=>{const _0x5c4d94=_0x276f24;_0x135149[_0x5c4d94(0x238)]('click',()=>adminDeletePassword(_0x135149[_0x5c4d94(0x227)][_0x5c4d94(0x1bd)]));}),document['querySelectorAll'](_0x276f24(0x1fc))[_0x276f24(0x1b3)](_0x51cdda=>{const _0x51ab36=_0x276f24;_0x51cdda[_0x51ab36(0x238)](_0x51ab36(0x1db),()=>adminEditUserName(_0x51cdda[_0x51ab36(0x227)][_0x51ab36(0x1bd)]));});}catch(_0x543b88){console[_0x276f24(0x200)](_0x276f24(0x262),_0x543b88),adminUserListContainer[_0x276f24(0x1c2)]='<p\x20class=\x22text-red-500\x22>ไม่สามารถโหลดรายชื่อได้:\x20'+_0x543b88[_0x276f24(0x1fa)]+_0x276f24(0x254);}}async function adminAddPassword(){const _0x496cfe=_0x1f5355,_0x41e461=adminNameInput[_0x496cfe(0x1bc)][_0x496cfe(0x1ac)](),_0x386151=adminPassInput[_0x496cfe(0x1bc)]['trim']();adminError[_0x496cfe(0x203)][_0x496cfe(0x1eb)](_0x496cfe(0x1c7));if(!_0x41e461||!_0x386151){adminError['textContent']=_0x496cfe(0x1a3),adminError['classList'][_0x496cfe(0x248)](_0x496cfe(0x1c7));return;}try{const _0x2b39aa=await getDoc(passwordListDocRef),_0x14c558=_0x2b39aa[_0x496cfe(0x218)]()?.[_0x496cfe(0x22b)]||[];if(_0x14c558[_0x496cfe(0x231)](_0x477b6d=>_0x477b6d[_0x496cfe(0x204)]===_0x386151)){adminError[_0x496cfe(0x21b)]=_0x496cfe(0x1d7),adminError[_0x496cfe(0x203)][_0x496cfe(0x248)](_0x496cfe(0x1c7));return;}const _0x571ba4=[..._0x14c558,{'name':_0x41e461,'password':_0x386151}];await setDoc(passwordListDocRef,{'passwords':_0x571ba4}),adminNameInput[_0x496cfe(0x1bc)]='',adminPassInput[_0x496cfe(0x1bc)]='',await loadAdminPasswordList();}catch(_0x1e8054){console['error'](_0x496cfe(0x1bf),_0x1e8054),adminError[_0x496cfe(0x21b)]='เกิดข้อผิดพลาด:\x20'+_0x1e8054[_0x496cfe(0x1fa)],adminError['classList'][_0x496cfe(0x248)](_0x496cfe(0x1c7));}}function _0x23f0(_0x45913b,_0x12092a){const _0x3a9c53=_0x3a9c();return _0x23f0=function(_0x23f059,_0x2b65a1){_0x23f059=_0x23f059-0x19b;let _0x1236fb=_0x3a9c53[_0x23f059];return _0x1236fb;},_0x23f0(_0x45913b,_0x12092a);}async function adminEditUserName(_0x26bbd7){const _0x137721=_0x1f5355;try{const _0x55e3df=await getDoc(passwordListDocRef),_0x40a50f=_0x55e3df[_0x137721(0x218)]()?.['passwords']||[],_0x104eb2=_0x40a50f[_0x137721(0x1f5)](_0x3cf5b8=>_0x3cf5b8[_0x137721(0x204)]===_0x26bbd7);if(!_0x104eb2){alert('ไม่พบผู้ใช้ที่ต้องการแก้ไข');return;}const _0x3cb5ab=prompt('แก้ไขชื่อสำหรับรหัส\x20\x22'+_0x104eb2[_0x137721(0x204)]+'\x22:',_0x104eb2['name']);if(!_0x3cb5ab||_0x3cb5ab[_0x137721(0x1ac)]()===''||_0x3cb5ab[_0x137721(0x1ac)]()===_0x104eb2[_0x137721(0x1d6)])return;const _0x4c742c=_0x40a50f[_0x137721(0x224)](_0x19f325=>{const _0x2f5958=_0x137721;if(_0x19f325['password']===_0x26bbd7)return{..._0x19f325,'name':_0x3cb5ab[_0x2f5958(0x1ac)]()};return _0x19f325;});await setDoc(passwordListDocRef,{'passwords':_0x4c742c}),await loadAdminPasswordList();}catch(_0x18bd0a){console[_0x137721(0x200)]('Error\x20editing\x20name:',_0x18bd0a),adminError[_0x137721(0x21b)]='เกิดข้อผิดพลาด:\x20'+_0x18bd0a[_0x137721(0x1fa)],adminError[_0x137721(0x203)][_0x137721(0x248)](_0x137721(0x1c7));}}async function adminDeletePassword(_0x16d035){const _0xdd98ce=_0x1f5355;if(!confirm(_0xdd98ce(0x1ec)+_0x16d035+_0xdd98ce(0x1bb)))return;try{const _0x16cb7a=await getDoc(passwordListDocRef),_0x174c47=_0x16cb7a[_0xdd98ce(0x218)]()?.['passwords']||[],_0x1f1556=_0x174c47['filter'](_0x46b87c=>_0x46b87c[_0xdd98ce(0x204)]!==_0x16d035);await setDoc(passwordListDocRef,{'passwords':_0x1f1556}),await loadAdminPasswordList();}catch(_0x2c8f75){console[_0xdd98ce(0x200)](_0xdd98ce(0x229),_0x2c8f75),adminError[_0xdd98ce(0x21b)]=_0xdd98ce(0x1cc)+_0x2c8f75[_0xdd98ce(0x1fa)],adminError[_0xdd98ce(0x203)][_0xdd98ce(0x248)](_0xdd98ce(0x1c7));}}async function handleFile(_0x54ba47){const _0x32eeb0=_0x1f5355;if(!settingsDocRef){showError(_0x32eeb0(0x25b));return;}const _0x199e24=_0x54ba47[_0x32eeb0(0x24f)][_0x32eeb0(0x211)];if(!_0x199e24||_0x199e24['length']===0x0)return;const _0x2461fe=_0x199e24[_0x32eeb0(0x249)];resultsDiv[_0x32eeb0(0x203)][_0x32eeb0(0x1eb)]('hidden'),errorDiv[_0x32eeb0(0x203)][_0x32eeb0(0x1eb)](_0x32eeb0(0x1c7)),sortControls[_0x32eeb0(0x203)][_0x32eeb0(0x1eb)](_0x32eeb0(0x1c7)),resetUI(),progressContainer[_0x32eeb0(0x203)]['remove'](_0x32eeb0(0x1c7)),progressStatus['classList'][_0x32eeb0(0x248)](_0x32eeb0(0x1c7)),progressBar[_0x32eeb0(0x1ce)][_0x32eeb0(0x1dc)]='0%',progressText[_0x32eeb0(0x21b)]='0%',progressStatus[_0x32eeb0(0x21b)]=_0x32eeb0(0x1ef)+_0x2461fe+')';try{const _0x3630fe=await getDoc(settingsDocRef);fullSavedOrder=_0x3630fe['exists']()?_0x3630fe['data']()[_0x32eeb0(0x236)]||[]:[];}catch(_0x124137){console['error'](_0x32eeb0(0x21e),_0x124137),showError(_0x32eeb0(0x1e9)),fullSavedOrder=[];}activeResults=[];try{for(let _0x22d999=0x0;_0x22d999<_0x2461fe;_0x22d999++){const _0x449ae0=_0x199e24[_0x22d999];progressStatus['textContent']=_0x32eeb0(0x23b)+(_0x22d999+0x1)+'\x20จาก\x20'+_0x2461fe+':\x20'+_0x449ae0[_0x32eeb0(0x1d6)];const _0xf29505=await new Promise((_0x3ddbf1,_0x2723fc)=>{const _0x385020=_0x32eeb0,_0x57098e=new FileReader();_0x57098e[_0x385020(0x1d2)]=_0x583242=>{const _0x2e2dbc=_0x385020;try{const _0x304c33=new Uint8Array(_0x583242[_0x2e2dbc(0x24f)][_0x2e2dbc(0x217)]),_0x4322a5=XLSX[_0x2e2dbc(0x230)](_0x304c33,{'type':_0x2e2dbc(0x1b4)}),_0x83a921=_0x2e2dbc(0x226),_0x4f8ce1=_0x2e2dbc(0x1e0);if(!_0x4322a5[_0x2e2dbc(0x21d)][_0x2e2dbc(0x1e7)](_0x83a921))_0x2723fc('ไม่พบชีต\x20‘รายงาน1’\x20ในไฟล์:\x20'+_0x449ae0[_0x2e2dbc(0x1d6)]);if(!_0x4322a5[_0x2e2dbc(0x21d)][_0x2e2dbc(0x1e7)](_0x4f8ce1))_0x2723fc(_0x2e2dbc(0x251)+_0x449ae0[_0x2e2dbc(0x1d6)]);const _0x160c0f=_0x4322a5[_0x2e2dbc(0x25f)][_0x83a921],_0x138e72=_0x4322a5[_0x2e2dbc(0x25f)][_0x4f8ce1];let _0x34105e=getCellValue(_0x138e72,0xa,0x2)||_0x449ae0[_0x2e2dbc(0x1d6)];const _0x164480=extractDataFromSheet(_0x160c0f);_0x3ddbf1({'fileIdentifier':_0x34105e,'extractedData':_0x164480});}catch(_0x1d9b88){_0x2723fc('เกิดข้อผิดพลาดในการอ่านไฟล์\x20'+_0x449ae0[_0x2e2dbc(0x1d6)]+':\x20'+_0x1d9b88[_0x2e2dbc(0x1fa)]);}},_0x57098e[_0x385020(0x1d4)]=()=>_0x2723fc('ไม่สามารถอ่านไฟล์\x20'+_0x449ae0['name']+_0x385020(0x1d0)),_0x57098e[_0x385020(0x19f)](_0x449ae0);});activeResults[_0x32eeb0(0x1a6)](_0xf29505);const _0x10f121=Math['round']((_0x22d999+0x1)/_0x2461fe*0x64);progressBar[_0x32eeb0(0x1ce)][_0x32eeb0(0x1dc)]=_0x10f121+'%',progressText[_0x32eeb0(0x21b)]=_0x10f121+'%';}progressStatus[_0x32eeb0(0x21b)]=_0x32eeb0(0x232);if(fullSavedOrder[_0x32eeb0(0x249)]>0x0){const _0x189f60=activeResults[_0x32eeb0(0x224)](_0x2fd246=>_0x2fd246[_0x32eeb0(0x1a0)]),_0x4d3e59=fullSavedOrder['filter'](_0x29af0e=>_0x189f60[_0x32eeb0(0x1e7)](_0x29af0e)),_0x45f81b=_0x189f60[_0x32eeb0(0x24c)](_0x2d56a7=>!fullSavedOrder[_0x32eeb0(0x1e7)](_0x2d56a7)),_0x4f56c6=[..._0x4d3e59,..._0x45f81b];activeResults[_0x32eeb0(0x244)]((_0x11bb85,_0x264160)=>_0x4f56c6[_0x32eeb0(0x1cf)](_0x11bb85[_0x32eeb0(0x1a0)])-_0x4f56c6[_0x32eeb0(0x1cf)](_0x264160['fileIdentifier']));}mergeAndDisplayResults(activeResults),resultsDiv[_0x32eeb0(0x203)][_0x32eeb0(0x248)](_0x32eeb0(0x1c7)),sortControls[_0x32eeb0(0x203)][_0x32eeb0(0x248)](_0x32eeb0(0x1c7)),showTab(0x1),progressStatus[_0x32eeb0(0x21b)]=_0x32eeb0(0x1fd),setTimeout(()=>{const _0x45c634=_0x32eeb0;progressContainer[_0x45c634(0x203)][_0x45c634(0x1eb)]('hidden'),progressStatus['classList'][_0x45c634(0x1eb)](_0x45c634(0x1c7));},0x5dc);}catch(_0x37e2bc){showError(_0x37e2bc),fileInput[_0x32eeb0(0x1bc)]='',progressContainer['classList'][_0x32eeb0(0x1eb)](_0x32eeb0(0x1c7)),progressStatus[_0x32eeb0(0x203)][_0x32eeb0(0x1eb)](_0x32eeb0(0x1c7));}}function resetUI(){const _0x5ebca0=_0x1f5355;outputScores['textContent']='',outputReading[_0x5ebca0(0x21b)]='',outputRm[_0x5ebca0(0x21b)]='',outputAttributes[_0x5ebca0(0x21b)]='',outputCompetency['textContent']='',visualScores[_0x5ebca0(0x1c2)]='',visualReading[_0x5ebca0(0x1c2)]='',visualRm[_0x5ebca0(0x1c2)]='',visualAttributes[_0x5ebca0(0x1c2)]='',visualCompetency[_0x5ebca0(0x1c2)]='',[copyBtn1,copyBtn2,copyBtn3,copyBtn4,copyBtn5]['forEach'](_0x198998=>{const _0x1348a7=_0x5ebca0;_0x198998&&(_0x198998[_0x1348a7(0x21b)]=_0x1348a7(0x255),_0x198998[_0x1348a7(0x203)][_0x1348a7(0x248)](_0x1348a7(0x1b7),_0x1348a7(0x1c6)),_0x198998[_0x1348a7(0x203)][_0x1348a7(0x1eb)]('bg-green-500',_0x1348a7(0x19d)));});if(progressContainer)progressContainer[_0x5ebca0(0x203)][_0x5ebca0(0x1eb)](_0x5ebca0(0x1c7));if(progressStatus)progressStatus['classList'][_0x5ebca0(0x1eb)](_0x5ebca0(0x1c7));}function showError(_0x2c4fb6){const _0x522e75=_0x1f5355;errorText[_0x522e75(0x21b)]=_0x2c4fb6,errorDiv[_0x522e75(0x203)]['remove'](_0x522e75(0x1c7));}function getCellValue(_0x32350d,_0x1334d0,_0x18ace1){const _0x2b2425=_0x1f5355,_0x42ec31=_0x32350d[XLSX['utils'][_0x2b2425(0x1ad)]({'r':_0x1334d0,'c':_0x18ace1})];if(!_0x42ec31)return'';return _0x42ec31['w']!==null&&_0x42ec31['w']!==undefined?String(_0x42ec31['w']):_0x42ec31['v']!==null&&_0x42ec31['v']!==undefined?String(_0x42ec31['v']):'';}function extractDataFromSheet(_0x46fdcb){const _0x550e07=_0x1f5355;let _0x32d3ca=[],_0x5ea101=[],_0x30db9b=[],_0x293b4b=[_0x550e07(0x1c0)],_0x1418a1=[],_0x5a6f37=[];for(let _0x5f3df3=0x6;_0x5f3df3<=0x37;_0x5f3df3++)_0x32d3ca[_0x550e07(0x1a6)](getCellValue(_0x46fdcb,_0x5f3df3,0x3));for(let _0x1f1f84=0x5;_0x1f1f84<=0x37;_0x1f1f84++){_0x5ea101[_0x550e07(0x1a6)]([getCellValue(_0x46fdcb,_0x1f1f84,0x4),getCellValue(_0x46fdcb,_0x1f1f84,0x5),getCellValue(_0x46fdcb,_0x1f1f84,0x6)][_0x550e07(0x1d3)]('\x09'));}for(let _0x5b7693=0x6;_0x5b7693<=0x37;_0x5b7693++){let _0x3c8278=getCellValue(_0x46fdcb,_0x5b7693,0x7)[_0x550e07(0x1ac)]();_0x30db9b[_0x550e07(0x1a6)](_0x3c8278==='ร'||_0x3c8278==='มส'?_0x3c8278:'');}for(let _0x1f686c=0x6;_0x1f686c<=0x37;_0x1f686c++)_0x293b4b[_0x550e07(0x1a6)](getCellValue(_0x46fdcb,_0x1f686c,0xb));let _0x3fed18=[];for(let _0x2fe475=0xd;_0x2fe475<=0x14;_0x2fe475++)_0x3fed18['push'](_0x550e07(0x1c0));_0x1418a1[_0x550e07(0x1a6)](_0x3fed18[_0x550e07(0x1d3)]('\x09'));for(let _0x2ec420=0x6;_0x2ec420<=0x37;_0x2ec420++){let _0x9de462=[];for(let _0x268351=0xd;_0x268351<=0x14;_0x268351++)_0x9de462[_0x550e07(0x1a6)](getCellValue(_0x46fdcb,_0x2ec420,_0x268351));_0x1418a1[_0x550e07(0x1a6)](_0x9de462[_0x550e07(0x1d3)]('\x09'));}let _0x1ad218=[];for(let _0x46335e=0x19;_0x46335e<=0x1d;_0x46335e++)_0x1ad218[_0x550e07(0x1a6)](_0x550e07(0x1c0));_0x5a6f37[_0x550e07(0x1a6)](_0x1ad218['join']('\x09'));for(let _0x469572=0x6;_0x469572<=0x37;_0x469572++){let _0x3655c6=[];for(let _0x9f74d3=0x19;_0x9f74d3<=0x1d;_0x9f74d3++)_0x3655c6[_0x550e07(0x1a6)](getCellValue(_0x46fdcb,_0x469572,_0x9f74d3));_0x5a6f37[_0x550e07(0x1a6)](_0x3655c6[_0x550e07(0x1d3)]('\x09'));}return{'scoresLines':_0x5ea101,'rmLines':_0x30db9b,'readingLines':_0x293b4b,'attrLines':_0x1418a1,'compLines':_0x5a6f37,'nameList':_0x32d3ca};}function buildVisualBlock(_0x53591b,_0x5f1a98,_0x3e174f,_0x2af90f){const _0x119f43=_0x1f5355;_0x3e174f['innerHTML']='';if(_0x2af90f&&_0x2af90f['length']>0x0){const _0x286148=document[_0x119f43(0x209)](_0x119f43(0x24e));_0x286148[_0x119f43(0x222)]=_0x119f43(0x24a),_0x286148['innerHTML']=_0x119f43(0x201);const _0xd015fb=document['createElement'](_0x119f43(0x24e));_0x286148['appendChild'](_0xd015fb);let _0x11fdd5=[..._0x2af90f];if(_0x5f1a98!=='rmLines')_0x11fdd5[_0x119f43(0x23e)]('');_0x11fdd5[_0x119f43(0x1b3)]((_0x58f8f2,_0x5d1fb6)=>{const _0x265144=_0x119f43,_0x18735c=document[_0x265144(0x209)](_0x265144(0x24e));_0x18735c['className']='font-mono\x20text-sm\x20whitespace-pre\x20text-gray-600\x20px-1';if(_0x5d1fb6%0x2!==0x0)_0x18735c[_0x265144(0x203)]['add'](_0x265144(0x22a));_0x18735c[_0x265144(0x21b)]=_0x58f8f2||'\u00a0',_0xd015fb['appendChild'](_0x18735c);}),_0x3e174f[_0x119f43(0x23d)](_0x286148);}_0x53591b[_0x119f43(0x1b3)]((_0x7ba8e9,_0x383196)=>{const _0x5d7038=_0x119f43,{fileIdentifier:_0x5a284f,extractedData:_0x2bd88b}=_0x7ba8e9,_0x1d2c9d=document[_0x5d7038(0x209)](_0x5d7038(0x24e));_0x1d2c9d[_0x5d7038(0x222)]=_0x5d7038(0x1b5);if(_0x383196<_0x53591b['length']-0x1)_0x1d2c9d[_0x5d7038(0x222)]+=_0x5d7038(0x1aa);_0x1d2c9d['innerHTML']='<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-blue-600\x20mb-2\x20whitespace-nowrap\x22>'+_0x5a284f+_0x5d7038(0x1f1);const _0x3a8d42=document[_0x5d7038(0x209)](_0x5d7038(0x24e));_0x1d2c9d[_0x5d7038(0x23d)](_0x3a8d42);const _0x91062f=_0x2bd88b[_0x5f1a98]||[];_0x91062f[_0x5d7038(0x1b3)]((_0x5ac1f5,_0x5f3465)=>{const _0x10bbfd=_0x5d7038,_0x5402ef=document[_0x10bbfd(0x209)](_0x10bbfd(0x24e));_0x5402ef[_0x10bbfd(0x222)]='font-mono\x20text-sm\x20whitespace-pre\x20px-1';if(_0x5f3465%0x2!==0x0)_0x5402ef[_0x10bbfd(0x203)][_0x10bbfd(0x1eb)](_0x10bbfd(0x22a));_0x5402ef[_0x10bbfd(0x21b)]=_0x5ac1f5||'\u00a0',_0x3a8d42[_0x10bbfd(0x23d)](_0x5402ef);}),_0x3e174f[_0x5d7038(0x23d)](_0x1d2c9d);});}function mergeAndDisplayResults(_0x15d43e){const _0x568241=_0x1f5355,_0x29062c=(_0x47c945,_0xe401b9)=>{const _0x37f046=_0x23f0;let _0x499a48='';for(let _0x221849=0x0;_0x221849<_0xe401b9;_0x221849++){let _0x5e27c9=[];for(const _0x580196 of _0x15d43e){const _0x418732=_0x580196[_0x37f046(0x1de)][_0x47c945]?.[_0x221849]!==undefined?_0x580196[_0x37f046(0x1de)][_0x47c945][_0x221849]:'';_0x5e27c9['push'](_0x47c945===_0x37f046(0x19e)?_0x418732+'\x09\x09':_0x418732);}_0x499a48+=_0x5e27c9[_0x37f046(0x1d3)]('\x09')+'\x0a';}return _0x499a48[_0x37f046(0x237)]();},_0xe71649={'scoresLines':0x33,'rmLines':0x32,'readingLines':0x33,'attrLines':0x33,'compLines':0x33};outputScores[_0x568241(0x21b)]=_0x29062c(_0x568241(0x21f),_0xe71649[_0x568241(0x21f)]),outputRm[_0x568241(0x21b)]=_0x29062c(_0x568241(0x233),_0xe71649[_0x568241(0x233)]),outputReading['textContent']=_0x29062c(_0x568241(0x19e),_0xe71649[_0x568241(0x19e)]),outputAttributes[_0x568241(0x21b)]=_0x29062c(_0x568241(0x22f),_0xe71649[_0x568241(0x22f)]),outputCompetency[_0x568241(0x21b)]=_0x29062c('compLines',_0xe71649[_0x568241(0x1ab)]);const _0x2a961a=_0x15d43e[_0x568241(0x249)]>0x0?_0x15d43e[0x0][_0x568241(0x1de)][_0x568241(0x1ae)]:[];buildVisualBlock(_0x15d43e,_0x568241(0x21f),visualScores,_0x2a961a),buildVisualBlock(_0x15d43e,_0x568241(0x233),visualRm,_0x2a961a),buildVisualBlock(_0x15d43e,'readingLines',visualReading,_0x2a961a),buildVisualBlock(_0x15d43e,_0x568241(0x22f),visualAttributes,_0x2a961a),buildVisualBlock(_0x15d43e,_0x568241(0x1ab),visualCompetency,_0x2a961a);}function copyToClipboard(_0x4dff80,_0x55009d){const _0x587e48=_0x1f5355,_0x811218=document[_0x587e48(0x209)]('textarea');_0x811218[_0x587e48(0x1bc)]=_0x4dff80,_0x811218[_0x587e48(0x1ce)]['position']=_0x587e48(0x207),_0x811218['style'][_0x587e48(0x234)]=0x0,document['body'][_0x587e48(0x23d)](_0x811218),_0x811218['select']();try{document[_0x587e48(0x1ee)](_0x587e48(0x1e1));const _0xbddde5=_0x55009d[_0x587e48(0x21b)];_0x55009d[_0x587e48(0x21b)]=_0x587e48(0x1c4),_0x55009d[_0x587e48(0x203)][_0x587e48(0x248)]('bg-green-500','hover:bg-green-600'),_0x55009d[_0x587e48(0x203)][_0x587e48(0x1eb)](_0x587e48(0x1b7)),setTimeout(()=>{const _0x3c48cb=_0x587e48;_0x55009d['textContent']=_0xbddde5,_0x55009d[_0x3c48cb(0x203)]['remove'](_0x3c48cb(0x1b7)),_0x55009d[_0x3c48cb(0x203)][_0x3c48cb(0x1eb)]('bg-green-500',_0x3c48cb(0x19d));},0x5dc);}catch(_0xbc8d7){console[_0x587e48(0x200)](_0x587e48(0x202),_0xbc8d7);}document['body'][_0x587e48(0x263)](_0x811218);}function initializeSortable(){const _0x4e79eb=_0x1f5355,_0x5b2b4c={'group':_0x4e79eb(0x219),'animation':0x96,'ghostClass':'sortable-ghost','chosenClass':_0x4e79eb(0x22c)};activeTopicsOrderList=new Sortable(activeTopicsContainer,_0x5b2b4c),availableTopicsPoolList=new Sortable(availableTopicsContainer,_0x5b2b4c);}function createTopicElement(_0x5a1963,_0x39c7ca){const _0x1d0e21=_0x1f5355,_0x3519a8=document['createElement'](_0x1d0e21(0x24e));_0x3519a8[_0x1d0e21(0x227)]['id']=_0x5a1963,_0x3519a8['className']=_0x1d0e21(0x1a4),_0x3519a8[_0x1d0e21(0x1c2)]=_0x1d0e21(0x1ca)+_0x5a1963+_0x1d0e21(0x213);const _0x88ff0d=document['createElement']('button');return _0x88ff0d[_0x1d0e21(0x222)]='text-white\x20rounded-full\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center',_0x39c7ca===_0x1d0e21(0x22d)?(_0x88ff0d[_0x1d0e21(0x1c2)]='−',_0x88ff0d[_0x1d0e21(0x222)]+=_0x1d0e21(0x253),_0x88ff0d[_0x1d0e21(0x24b)]=()=>moveTopicItem(_0x3519a8,_0x1d0e21(0x20c))):(_0x88ff0d[_0x1d0e21(0x1c2)]='+',_0x88ff0d[_0x1d0e21(0x222)]+=_0x1d0e21(0x1c1),_0x88ff0d[_0x1d0e21(0x24b)]=()=>moveTopicItem(_0x3519a8,'active')),_0x3519a8['appendChild'](_0x88ff0d),_0x3519a8;}function moveTopicItem(_0x55fc7f,_0x1b7943){const _0x24832b=_0x1f5355,_0x464889=_0x55fc7f[_0x24832b(0x227)]['id'];_0x55fc7f[_0x24832b(0x252)][_0x24832b(0x263)](_0x55fc7f);const _0x3a0f82=createTopicElement(_0x464889,_0x1b7943);if(_0x1b7943===_0x24832b(0x22d))activeTopicsContainer[_0x24832b(0x23d)](_0x3a0f82);else availableTopicsContainer[_0x24832b(0x23d)](_0x3a0f82);}function populateSortModal(){const _0x470888=_0x1f5355;activeTopicsContainer['innerHTML']='',availableTopicsContainer['innerHTML']='';const _0x4bc1e7=activeResults[_0x470888(0x224)](_0x4b6cb5=>_0x4b6cb5[_0x470888(0x1a0)]);_0x4bc1e7[_0x470888(0x1b3)](_0x2f8180=>{const _0x3d3423=_0x470888;activeTopicsContainer[_0x3d3423(0x23d)](createTopicElement(_0x2f8180,_0x3d3423(0x22d)));});const _0x29e3a1=fullSavedOrder[_0x470888(0x24c)](_0x21394f=>!_0x4bc1e7['includes'](_0x21394f));_0x29e3a1['forEach'](_0x3758ae=>{const _0x4e5ef9=_0x470888;availableTopicsContainer['appendChild'](createTopicElement(_0x3758ae,_0x4e5ef9(0x20c)));});}async function saveAndApplyOrder(){const _0x117a89=_0x1f5355;if(!settingsDocRef)return showError(_0x117a89(0x267));const _0x5151c7=Array[_0x117a89(0x1c9)](activeTopicsContainer['children'])['map'](_0x341338=>_0x341338['dataset']['id']),_0x1dbb24=Array[_0x117a89(0x1c9)](availableTopicsContainer[_0x117a89(0x1f9)])[_0x117a89(0x224)](_0x2aa936=>_0x2aa936[_0x117a89(0x227)]['id']),_0x2ed92c=[..._0x5151c7,..._0x1dbb24];try{await setDoc(settingsDocRef,{'order':_0x2ed92c}),fullSavedOrder=_0x2ed92c,activeResults[_0x117a89(0x244)]((_0x128ada,_0x3055b7)=>_0x5151c7[_0x117a89(0x1cf)](_0x128ada['fileIdentifier'])-_0x5151c7['indexOf'](_0x3055b7[_0x117a89(0x1a0)])),resetUI(),mergeAndDisplayResults(activeResults),sortModal[_0x117a89(0x203)][_0x117a89(0x1eb)]('hidden');}catch(_0x42d36c){console[_0x117a89(0x200)]('Error\x20saving\x20order:\x20',_0x42d36c),showError(_0x117a89(0x1f7)+_0x42d36c[_0x117a89(0x1fa)]);}}async function resetOrder(){const _0x3d717d=_0x1f5355;if(!settingsDocRef)return showError(_0x3d717d(0x267));if(!confirm(_0x3d717d(0x23a)))return;try{await setDoc(settingsDocRef,{'order':[]}),fullSavedOrder=[],populateSortModal(),sortModal[_0x3d717d(0x203)][_0x3d717d(0x1eb)](_0x3d717d(0x1c7));}catch(_0x294886){console[_0x3d717d(0x200)](_0x3d717d(0x206),_0x294886),showError(_0x3d717d(0x220)+_0x294886['message']);}}