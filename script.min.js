const _0x45a38f=_0x515f;(function(_0x24599f,_0x2d35df){const _0x4f933b=_0x515f,_0x3d20f7=_0x24599f();while(!![]){try{const _0x5a5efb=parseInt(_0x4f933b(0x14d))/0x1*(-parseInt(_0x4f933b(0x179))/0x2)+-parseInt(_0x4f933b(0xe6))/0x3+-parseInt(_0x4f933b(0xde))/0x4+-parseInt(_0x4f933b(0x128))/0x5+-parseInt(_0x4f933b(0x117))/0x6*(-parseInt(_0x4f933b(0x162))/0x7)+-parseInt(_0x4f933b(0xd5))/0x8+-parseInt(_0x4f933b(0xea))/0x9*(-parseInt(_0x4f933b(0x152))/0xa);if(_0x5a5efb===_0x2d35df)break;else _0x3d20f7['push'](_0x3d20f7['shift']());}catch(_0x60a602){_0x3d20f7['push'](_0x3d20f7['shift']());}}}(_0x5002,0x40ef1));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,deleteDoc,setLogLevel}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const PRIMARY_TEMPLATE=['ภาษาไทย',_0x45a38f(0x145),'วิทยาศาสตร์และเทคโนโลยี',_0x45a38f(0xe2),'ประวัติศาสตร์',_0x45a38f(0x139),_0x45a38f(0x11c),_0x45a38f(0x18a),'ภาษาอังกฤษ','ภาษาอังกฤษเพิ่มเติม','ป้องกันการทุจริต'],SECONDARY_TEMPLATE=[_0x45a38f(0x123),_0x45a38f(0x148),_0x45a38f(0xfe),_0x45a38f(0x16c),_0x45a38f(0x101),_0x45a38f(0xe2),_0x45a38f(0x133),_0x45a38f(0x125),_0x45a38f(0xe1),'ศิลปะ',_0x45a38f(0x18b),'การงานอาชีพเพิ่มเติม','ภาษาอังกฤษพื้นฐาน','ภาษาอังกฤษเพิ่มเติม',_0x45a38f(0x157)];let db,auth,appId=_0x45a38f(0xdc),passwordListDocRef,userDataDocRef,currentUserPassword=null,currentUserName=null,currentUserTemplate=null,activeResults=[],processedDataStore={};const loginScreen=document[_0x45a38f(0x110)](_0x45a38f(0xd2)),adminPanel=document['getElementById']('admin-panel'),mainApp=document[_0x45a38f(0x110)](_0x45a38f(0x14f)),adminBtn=document[_0x45a38f(0x110)]('admin-btn'),loginBtn=document['getElementById'](_0x45a38f(0x156)),passwordInput=document[_0x45a38f(0x110)](_0x45a38f(0x129)),loginError=document[_0x45a38f(0x110)](_0x45a38f(0x154)),logoutBtn=document[_0x45a38f(0x110)](_0x45a38f(0x14e)),resetDataBtn=document[_0x45a38f(0x110)](_0x45a38f(0xf1)),adminCloseBtn=document[_0x45a38f(0x110)](_0x45a38f(0xdd)),adminNameInput=document[_0x45a38f(0x110)](_0x45a38f(0x17b)),adminPassInput=document[_0x45a38f(0x110)](_0x45a38f(0x122)),adminTemplateSelect=document[_0x45a38f(0x110)](_0x45a38f(0x126)),adminAddBtn=document[_0x45a38f(0x110)](_0x45a38f(0x167)),adminUserListContainer=document[_0x45a38f(0x110)](_0x45a38f(0x11a)),adminError=document[_0x45a38f(0x110)](_0x45a38f(0x10d)),fileInput=document[_0x45a38f(0x110)](_0x45a38f(0x120)),resultsDiv=document['getElementById']('results'),errorDiv=document[_0x45a38f(0x110)](_0x45a38f(0x18f)),errorText=document[_0x45a38f(0x110)](_0x45a38f(0x17d)),outputScores=document[_0x45a38f(0x110)]('output-scores'),outputReading=document[_0x45a38f(0x110)](_0x45a38f(0x195)),outputRm=document[_0x45a38f(0x110)]('output-rm'),outputAttributes=document['getElementById']('output-attributes'),outputCompetency=document[_0x45a38f(0x110)]('output-competency'),visualScores=document[_0x45a38f(0x110)]('visual-scores'),visualReading=document['getElementById'](_0x45a38f(0x175)),visualRm=document[_0x45a38f(0x110)](_0x45a38f(0xdf)),visualAttributes=document[_0x45a38f(0x110)](_0x45a38f(0xd7)),visualCompetency=document[_0x45a38f(0x110)](_0x45a38f(0x18d)),copyBtn1=document[_0x45a38f(0x110)]('copy-btn-1'),copyBtn2=document[_0x45a38f(0x110)](_0x45a38f(0x191)),copyBtn3=document[_0x45a38f(0x110)]('copy-btn-3'),copyBtn4=document[_0x45a38f(0x110)]('copy-btn-4'),copyBtn5=document[_0x45a38f(0x110)](_0x45a38f(0x19e)),semesterInfoEl=document[_0x45a38f(0x110)](_0x45a38f(0x16f)),progressContainer=document['getElementById'](_0x45a38f(0x143)),progressBar=document[_0x45a38f(0x110)](_0x45a38f(0x10a)),progressText=document[_0x45a38f(0x110)](_0x45a38f(0xf3)),progressStatus=document[_0x45a38f(0x110)](_0x45a38f(0x1a7)),completionBar=document[_0x45a38f(0x110)](_0x45a38f(0x13a));function showTab(_0x535211){const _0x4d0107=_0x45a38f;document[_0x4d0107(0x163)](_0x4d0107(0xe5))[_0x4d0107(0x1a0)](_0x5a1349=>_0x5a1349[_0x4d0107(0x155)][_0x4d0107(0x16d)](_0x4d0107(0xe8),_0x4d0107(0x135),_0x4d0107(0xfc),'font-medium')),document[_0x4d0107(0x163)]('.tab-content')[_0x4d0107(0x1a0)](_0x4ea1ea=>_0x4ea1ea[_0x4d0107(0x155)][_0x4d0107(0xd6)]('hidden'));const _0x12f4b0=document[_0x4d0107(0x110)]('tab-btn-'+_0x535211),_0x57fa84=document[_0x4d0107(0x110)](_0x4d0107(0x199)+_0x535211);if(_0x12f4b0)_0x12f4b0[_0x4d0107(0x155)][_0x4d0107(0xd6)](_0x4d0107(0xe8),_0x4d0107(0x135),'text-blue-600',_0x4d0107(0x124));if(_0x57fa84)_0x57fa84[_0x4d0107(0x155)][_0x4d0107(0x16d)](_0x4d0107(0x160));}window[_0x45a38f(0x102)]=showTab;async function main(){const _0x430db0=_0x45a38f;try{const _0x54ff72={'apiKey':_0x430db0(0x176),'authDomain':'programpp-91f08.firebaseapp.com','projectId':_0x430db0(0x109),'storageBucket':_0x430db0(0x10f),'messagingSenderId':_0x430db0(0x100),'appId':_0x430db0(0x121),'measurementId':_0x430db0(0x19a)},_0x53c489=typeof __firebase_config!==_0x430db0(0x136)?JSON[_0x430db0(0xdb)](__firebase_config):_0x54ff72;appId=typeof __app_id!==_0x430db0(0x136)?__app_id:_0x430db0(0xdc);if(!_0x53c489[_0x430db0(0x17f)])throw new Error(_0x430db0(0x13d));const _0x178691=initializeApp(_0x53c489);db=getFirestore(_0x178691),auth=getAuth(_0x178691),setLogLevel(_0x430db0(0xda));typeof __initial_auth_token!==_0x430db0(0x136)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);const _0x5118a9='/artifacts/'+appId+'/public/data/passwords/password_list';passwordListDocRef=doc(db,_0x5118a9),loginBtn[_0x430db0(0x144)](_0x430db0(0x12a),loginUser),adminBtn['addEventListener']('click',promptAdminAccess),adminCloseBtn[_0x430db0(0x144)]('click',closeAdminPanel),adminAddBtn[_0x430db0(0x144)](_0x430db0(0x12a),adminAddPassword),logoutBtn['addEventListener'](_0x430db0(0x12a),logoutUser),resetDataBtn['addEventListener'](_0x430db0(0x12a),resetAllData),passwordInput['addEventListener'](_0x430db0(0x104),_0x28cb4c=>{const _0x2ca415=_0x430db0;if(_0x28cb4c[_0x2ca415(0x15f)]===_0x2ca415(0x15b))loginUser();}),fileInput[_0x430db0(0x144)]('change',handleFile),copyBtn1['addEventListener']('click',()=>copyToClipboard(outputScores[_0x430db0(0x112)],copyBtn1)),copyBtn2['addEventListener'](_0x430db0(0x12a),()=>copyToClipboard(outputRm[_0x430db0(0x112)],copyBtn2)),copyBtn3[_0x430db0(0x144)](_0x430db0(0x12a),()=>copyToClipboard(outputReading[_0x430db0(0x112)],copyBtn3)),copyBtn4[_0x430db0(0x144)]('click',()=>copyToClipboard(outputAttributes[_0x430db0(0x112)],copyBtn4)),copyBtn5['addEventListener'](_0x430db0(0x12a),()=>copyToClipboard(outputCompetency['textContent'],copyBtn5)),loginScreen['classList'][_0x430db0(0x16d)](_0x430db0(0x160)),adminPanel['classList'][_0x430db0(0xd6)](_0x430db0(0x160)),mainApp[_0x430db0(0x155)][_0x430db0(0xd6)]('hidden');}catch(_0x3b9769){console[_0x430db0(0x180)](_0x430db0(0x197),_0x3b9769),showError(_0x430db0(0xf8)+_0x3b9769['message']),loginScreen[_0x430db0(0x119)]=_0x430db0(0x170)+_0x3b9769['message']+_0x430db0(0x107);}}document[_0x45a38f(0x144)](_0x45a38f(0x111),main);function loadDataFromStore(){const _0x42bc0c=_0x45a38f;if(Object[_0x42bc0c(0xfd)](processedDataStore)[_0x42bc0c(0xed)]===0x0){resultsDiv[_0x42bc0c(0x155)][_0x42bc0c(0xd6)](_0x42bc0c(0x160));return;}const _0x26cca2=currentUserTemplate==='primary'?PRIMARY_TEMPLATE:SECONDARY_TEMPLATE;let _0x354088=null;const _0x43a80b=Math[_0x42bc0c(0x159)](0x0,...Object[_0x42bc0c(0x134)](processedDataStore)[_0x42bc0c(0x18e)](_0x35fc2=>_0x35fc2[_0x42bc0c(0x17c)][_0x42bc0c(0xfa)]&&_0x35fc2[_0x42bc0c(0x17c)][_0x42bc0c(0xfa)][_0x42bc0c(0xed)]||0x0)),_0x5c8619=_0x26cca2['map'](_0x9c54f6=>processedDataStore[_0x9c54f6])[_0x42bc0c(0x186)](_0x47ad3e=>_0x47ad3e&&_0x47ad3e['extractedData'][_0x42bc0c(0xfa)][_0x42bc0c(0xed)]>0x0);let _0x994efb=_0x5c8619?_0x5c8619[_0x42bc0c(0x17c)][_0x42bc0c(0xfa)]:[];_0x994efb[_0x42bc0c(0xed)]<_0x43a80b&&(_0x994efb=[..._0x994efb,...Array(_0x43a80b-_0x994efb['length'])[_0x42bc0c(0x171)]('')]);activeResults=_0x26cca2['map'](_0x1f8ecd=>{const _0x5b55a6=_0x42bc0c,_0x2552fa=processedDataStore[_0x1f8ecd];if(_0x2552fa){if(!_0x354088)_0x354088=_0x2552fa['semesterInfo'];const _0x40b3a5=padExtractedData(_0x2552fa[_0x5b55a6(0x17c)],_0x43a80b);return{'fileIdentifier':_0x1f8ecd,'extractedData':_0x40b3a5};}else return{'fileIdentifier':_0x1f8ecd,'extractedData':createEmptyData(_0x43a80b)};}),displaySemesterInfo(_0x354088),mergeAndDisplayResults(activeResults,_0x994efb,_0x43a80b),resultsDiv[_0x42bc0c(0x155)]['remove'](_0x42bc0c(0x160)),showTab(0x1);const _0x24989c=_0x26cca2[_0x42bc0c(0x14a)](_0x4d38b4=>processedDataStore[_0x4d38b4]);_0x24989c?completionBar[_0x42bc0c(0x155)][_0x42bc0c(0x16d)]('hidden'):completionBar[_0x42bc0c(0x155)][_0x42bc0c(0xd6)]('hidden');}async function loginUser(){const _0x28a9b4=_0x45a38f,_0x7b972=passwordInput[_0x28a9b4(0x198)];if(!_0x7b972)return;loginError[_0x28a9b4(0x155)]['add'](_0x28a9b4(0x160));try{const _0xce3d48=await getDoc(passwordListDocRef),_0x48322e=_0xce3d48[_0x28a9b4(0x19f)]()?.[_0x28a9b4(0x118)]||[],_0x332b0e=_0x48322e[_0x28a9b4(0x186)](_0x1e12a5=>_0x1e12a5[_0x28a9b4(0x12d)]===_0x7b972);if(_0x332b0e){currentUserPassword=_0x7b972,currentUserName=_0x332b0e['name'],currentUserTemplate=_0x332b0e['template']||'primary';const _0x496fd4=_0x28a9b4(0x138)+appId+_0x28a9b4(0xef)+currentUserPassword;userDataDocRef=doc(db,_0x496fd4);const _0x486f13=await getDoc(userDataDocRef);_0x486f13[_0x28a9b4(0x15e)]()?processedDataStore=_0x486f13[_0x28a9b4(0x19f)]()[_0x28a9b4(0x10c)]||{}:processedDataStore={};loginScreen[_0x28a9b4(0x155)][_0x28a9b4(0xd6)]('hidden'),mainApp['classList'][_0x28a9b4(0x16d)]('hidden'),adminBtn['classList'][_0x28a9b4(0xd6)]('hidden');const _0x512d39=document['getElementById']('welcome-message');_0x512d39&&(_0x512d39[_0x28a9b4(0x112)]='ยินดีต้อนรับ,\x20'+currentUserName+_0x28a9b4(0x15d)+(currentUserTemplate===_0x28a9b4(0x188)?_0x28a9b4(0x168):_0x28a9b4(0x103))+')'),fileInput['value']='',resetUI(),loadDataFromStore();}else loginError[_0x28a9b4(0x155)][_0x28a9b4(0x16d)](_0x28a9b4(0x160));}catch(_0x284253){console['error'](_0x28a9b4(0x116),_0x284253),loginError[_0x28a9b4(0x150)](_0x28a9b4(0x172))[_0x28a9b4(0x112)]='เกิดข้อผิดพลาด:\x20'+_0x284253[_0x28a9b4(0x182)],loginError[_0x28a9b4(0x155)]['remove'](_0x28a9b4(0x160));}}function logoutUser(){const _0x4353bd=_0x45a38f;currentUserPassword=null,currentUserName=null,currentUserTemplate=null,processedDataStore={},userDataDocRef=null,mainApp['classList'][_0x4353bd(0xd6)]('hidden'),loginScreen[_0x4353bd(0x155)][_0x4353bd(0x16d)](_0x4353bd(0x160)),adminBtn[_0x4353bd(0x155)][_0x4353bd(0x16d)]('hidden'),passwordInput[_0x4353bd(0x198)]='',loginError[_0x4353bd(0x155)]['add'](_0x4353bd(0x160));const _0xb68b60=document[_0x4353bd(0x110)](_0x4353bd(0xff));_0xb68b60&&(_0xb68b60[_0x4353bd(0x112)]='');}async function resetAllData(){const _0x47fa27=_0x45a38f;if(!userDataDocRef)return;if(confirm('คุณแน่ใจหรือไม่ว่าต้องการล้างข้อมูลที่อัปโหลดทั้งหมด?\x20(ไฟล์ที่อัปโหลดจะหายไป)')){processedDataStore={};try{await setDoc(userDataDocRef,{'store':{}});}catch(_0x4d84af){showError(_0x47fa27(0xee)+_0x4d84af['message']);}resetUI(),resultsDiv[_0x47fa27(0x155)][_0x47fa27(0xd6)](_0x47fa27(0x160)),completionBar[_0x47fa27(0x155)][_0x47fa27(0xd6)](_0x47fa27(0x160)),fileInput[_0x47fa27(0x198)]='';}}function promptAdminAccess(){const _0x2a7f34=_0x45a38f,_0x37e75e=prompt(_0x2a7f34(0xd4));if(_0x37e75e===_0x2a7f34(0x10b))loginScreen[_0x2a7f34(0x155)][_0x2a7f34(0xd6)](_0x2a7f34(0x160)),adminPanel[_0x2a7f34(0x155)]['remove'](_0x2a7f34(0x160)),loadAdminPasswordList();else _0x37e75e&&alert(_0x2a7f34(0x1a9));}function closeAdminPanel(){const _0x37ff2e=_0x45a38f;adminPanel[_0x37ff2e(0x155)][_0x37ff2e(0xd6)](_0x37ff2e(0x160)),loginScreen[_0x37ff2e(0x155)][_0x37ff2e(0x16d)](_0x37ff2e(0x160)),adminError[_0x37ff2e(0x155)][_0x37ff2e(0xd6)](_0x37ff2e(0x160));}async function loadAdminPasswordList(){const _0x4a4ebc=_0x45a38f;adminUserListContainer[_0x4a4ebc(0x119)]=_0x4a4ebc(0x16a);try{const _0xa008e6=await getDoc(passwordListDocRef),_0x329f6d=_0xa008e6[_0x4a4ebc(0x19f)]()?.[_0x4a4ebc(0x118)]||[];adminUserListContainer['innerHTML']='';if(_0x329f6d['length']===0x0){adminUserListContainer['innerHTML']=_0x4a4ebc(0x164);return;}_0x329f6d[_0x4a4ebc(0x1a0)](_0x4bca76=>{const _0x103faf=_0x4a4ebc,_0x9238d9=document[_0x103faf(0x161)]('div');_0x9238d9[_0x103faf(0x153)]='flex\x20items-center\x20justify-between\x20p-2.5\x20bg-white\x20border\x20border-gray-300\x20rounded-lg';const _0xe31b30=_0x4bca76[_0x103faf(0x184)]===_0x103faf(0x10e)?_0x103faf(0x103):_0x103faf(0x168);_0x9238d9[_0x103faf(0x119)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-medium\x20text-gray-800\x22>'+_0x4bca76[_0x103faf(0x1a1)]+_0x103faf(0xfb)+_0x4bca76[_0x103faf(0x12d)]+_0x103faf(0x147)+_0xe31b30+_0x103faf(0xec)+_0x4bca76[_0x103faf(0x12d)]+_0x103faf(0x1a3)+_0x4bca76[_0x103faf(0x12d)]+'\x22\x20class=\x22admin-delete-btn\x20text-red-500\x20hover:text-red-700\x20font-medium\x20text-sm\x22>ลบ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',adminUserListContainer[_0x103faf(0x192)](_0x9238d9);}),document[_0x4a4ebc(0x163)](_0x4a4ebc(0x127))[_0x4a4ebc(0x1a0)](_0x348f65=>{const _0xadfe0f=_0x4a4ebc;_0x348f65[_0xadfe0f(0x144)](_0xadfe0f(0x12a),()=>adminDeletePassword(_0x348f65[_0xadfe0f(0x12e)][_0xadfe0f(0x13e)]));}),document['querySelectorAll'](_0x4a4ebc(0xd3))[_0x4a4ebc(0x1a0)](_0x236d24=>{const _0x51268c=_0x4a4ebc;_0x236d24[_0x51268c(0x144)](_0x51268c(0x12a),()=>adminEditUser(_0x236d24[_0x51268c(0x12e)]['pass']));});}catch(_0x443ca1){console[_0x4a4ebc(0x180)]('Error\x20loading\x20password\x20list:',_0x443ca1),adminUserListContainer[_0x4a4ebc(0x119)]='<p\x20class=\x22text-red-500\x22>ไม่สามารถโหลดรายชื่อได้:\x20'+_0x443ca1[_0x4a4ebc(0x182)]+_0x4a4ebc(0x107);}}async function adminAddPassword(){const _0x1fead3=_0x45a38f,_0x3266e8=adminNameInput[_0x1fead3(0x198)]['trim'](),_0x59de8e=adminPassInput['value'][_0x1fead3(0x131)](),_0xf683f6=adminTemplateSelect[_0x1fead3(0x198)];adminError[_0x1fead3(0x155)]['add'](_0x1fead3(0x160));if(!_0x3266e8||!_0x59de8e){adminError[_0x1fead3(0x112)]=_0x1fead3(0xe0),adminError[_0x1fead3(0x155)][_0x1fead3(0x16d)]('hidden');return;}try{const _0x241033=await getDoc(passwordListDocRef),_0x4db3c8=_0x241033[_0x1fead3(0x19f)]()?.['passwords']||[];if(_0x4db3c8['some'](_0x1b979a=>_0x1b979a[_0x1fead3(0x12d)]===_0x59de8e)){adminError[_0x1fead3(0x112)]=_0x1fead3(0xf5),adminError[_0x1fead3(0x155)][_0x1fead3(0x16d)](_0x1fead3(0x160));return;}const _0x585c2d=[..._0x4db3c8,{'name':_0x3266e8,'password':_0x59de8e,'template':_0xf683f6}];await setDoc(passwordListDocRef,{'passwords':_0x585c2d}),adminNameInput[_0x1fead3(0x198)]='',adminPassInput[_0x1fead3(0x198)]='',await loadAdminPasswordList();}catch(_0x345920){console[_0x1fead3(0x180)](_0x1fead3(0x165),_0x345920),adminError['textContent']=_0x1fead3(0xd9)+_0x345920['message'],adminError[_0x1fead3(0x155)][_0x1fead3(0x16d)](_0x1fead3(0x160));}}async function adminEditUser(_0xeab14c){const _0x147c02=_0x45a38f;try{const _0x21a4a4=await getDoc(passwordListDocRef),_0x11ce26=_0x21a4a4['data']()?.[_0x147c02(0x118)]||[],_0x27e4db=_0x11ce26[_0x147c02(0x186)](_0x3e322f=>_0x3e322f[_0x147c02(0x12d)]===_0xeab14c);if(!_0x27e4db){alert('ไม่พบผู้ใช้ที่ต้องการแก้ไข');return;}const _0x1f4fcf=prompt(_0x147c02(0xf4)+_0x27e4db[_0x147c02(0x12d)]+_0x147c02(0x14b),_0x27e4db[_0x147c02(0x1a1)]);if(_0x1f4fcf===null)return;const _0x50c856=_0x27e4db['template']||'primary',_0x23c4f6=prompt(_0x147c02(0x137)+_0x27e4db[_0x147c02(0x1a1)]+'\x20(พิมพ์\x20\x27primary\x27\x20หรือ\x20\x27secondary\x27):',_0x50c856);if(_0x23c4f6===null)return;const _0xc6f3e1=_0x1f4fcf['trim']()===''?_0x27e4db['name']:_0x1f4fcf[_0x147c02(0x131)](),_0x56a777=_0x23c4f6[_0x147c02(0x131)]()[_0x147c02(0x174)]()===_0x147c02(0x10e)?_0x147c02(0x10e):_0x147c02(0x188);if(_0x56a777!==_0x50c856){if(confirm(_0x147c02(0x132)+_0xc6f3e1+'\x20ข้อมูลไฟล์ที่อัปโหลดไว้ทั้งหมดจะถูกลบ\x20ยืนยันหรือไม่?')){const _0x34c26e=_0x147c02(0x138)+appId+'/public/data/user_data/'+_0xeab14c,_0x15d46a=doc(db,_0x34c26e);await setDoc(_0x15d46a,{'store':{}});}else return;}const _0x1c5ee7=_0x11ce26[_0x147c02(0x18e)](_0x438459=>{const _0x694270=_0x147c02;if(_0x438459[_0x694270(0x12d)]===_0xeab14c)return{..._0x438459,'name':_0xc6f3e1,'template':_0x56a777};return _0x438459;});await setDoc(passwordListDocRef,{'passwords':_0x1c5ee7}),await loadAdminPasswordList();}catch(_0x1260eb){console[_0x147c02(0x180)](_0x147c02(0x11b),_0x1260eb),adminError[_0x147c02(0x112)]=_0x147c02(0xd9)+_0x1260eb[_0x147c02(0x182)],adminError[_0x147c02(0x155)][_0x147c02(0x16d)](_0x147c02(0x160));}}function _0x5002(){const _0xe3a8a6=['innerHTML','admin-user-list-container','Error\x20editing\x20user:','ศิลปะ','style','push','ไม่สามารถอ่านไฟล์\x20','file-upload','1:415403943738:web:f56ec72de49f81f0315203','admin-pass-input','ภาษาไทย','font-medium','สุขศึกษา','admin-template-select','.admin-delete-btn','2150790DUvOwO','password-input','click','flex-shrink-0\x20p-3','read','password','dataset','\x09\x09\x09\x09\x09\x09\x09','Failed\x20to\x20copy\x20text:\x20','trim','คุณได้เปลี่ยน\x20\x22แบบ\x22\x20ของผู้ใช้\x20','ประวัติศาสตร์','values','border-blue-600','undefined','แก้ไข\x20\x22แบบ\x22\x20สำหรับ\x20','/artifacts/','สุขศึกษาและพลศึกษา','completion-bar','utils','removeChild','\x22projectId\x22\x20not\x20provided','pass','\x09\x09\x09\x09','Sheets','rmLines','position','progress-container','addEventListener','คณิตศาสตร์','ไม่พบชีต\x20‘รายงาน1’\x20ในไฟล์:\x20',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-blue-600\x20ml-2\x20font-medium\x22>(แบบ:\x20','คณิตศาสตร์พื้นฐาน','bg-gray-100','every','\x22\x20(กด\x20OK\x20เพื่อคงชื่อเดิม):','fixed','150yxhTaA','logout-btn','main-app','querySelector','ประมวลผลเสร็จสิ้น!','30FvRZus','className','login-error','classList','login-btn','ป้องกันการทุจริต','font-mono\x20text-sm\x20whitespace-pre\x20text-gray-600\x20px-1','max','files','Enter','onerror','\x20(แบบ:\x20','exists','key','hidden','createElement','156163wBZwTb','querySelectorAll','<p\x20class=\x22text-gray-500\x22>ยังไม่มีผู้ใช้งาน</p>','Error\x20adding\x20password:','execCommand','admin-add-btn','ประถม','คำเตือน:\x20การลบผู้ใช้นี้จะลบข้อมูลไฟล์ทั้งหมดที่ผู้ใช้นี้อัปโหลดไว้ด้วย\x20ยืนยันหรือไม่?','<p\x20class=\x22text-gray-500\x22>กำลังโหลด...</p>','filter','วิทยาศาสตร์และเทคโนโลยีพื้นฐาน','remove','array','semester-info','<p\x20class=\x22text-red-500\x22>Initialization\x20failed:\x20','fill','span','<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-blue-600\x20mb-2\x20whitespace-nowrap\x22>','toLowerCase','visual-reading','AIzaSyBHmJ7M5qf20lKPTB9_aE2Ppa0-jTryuuI','readAsArrayBuffer','SheetNames','3526GaGXTr','textarea','admin-name-input','extractedData','error-text','hover:bg-green-600','projectId','error','ปีการศึกษา','message','คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้ที่มีรหัสผ่าน\x20\x22','template','bg-green-500','find','กำลังประมวลผลไฟล์\x20','primary','scoresLines','การงานอาชีพ','การงานอาชีพพื้นฐาน','onload','visual-competency','map','error-message','compLines','copy-btn-2','appendChild','Error\x20deleting\x20password:','readingLines','output-reading','ไม่พบชีต\x20‘Home’\x20ในไฟล์:\x20','Initialization\x20failed:','value','tab-content-','G-W19QNQQR25','เกิดข้อผิดพลาดในการอ่านไฟล์\x20','100','encode_cell','copy-btn-5','data','forEach','name','100\x09100\x09100','\x22\x20class=\x22admin-edit-btn\x20text-blue-500\x20hover:text-blue-700\x20font-medium\x20text-sm\x20mr-3\x22>แก้ไข</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','join','ignored','opacity','progress-status','trimEnd','รหัสผ่าน\x20Admin\x20ไม่ถูกต้อง','Home','login-screen','.admin-edit-btn','กรุณาใส่รหัสผ่าน\x20Admin:','1728472eUIqIb','add','visual-attributes','bg-blue-500','เกิดข้อผิดพลาด:\x20','Debug','parse','default-app-id','admin-close-btn','2064764LICCai','visual-rm','กรุณากรอกทั้งชื่อและรหัสผ่าน','พลศึกษา','สังคมศึกษา\x20ศาสนาและวัฒนธรรม','includes','semesterInfo','.tab-btn','103191aKYSzE','bg-red-500','active','</div>','4713183eLtqEE','\x20border-r-2\x20border-dashed\x20border-gray-300',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','length','ไม่สามารถล้างข้อมูลบนเซิร์ฟเวอร์ได้:\x20','/public/data/user_data/','attrLines','reset-data-btn','target','progress-text','แก้ไขชื่อสำหรับรหัส\x20\x22','รหัสผ่านนี้ถูกใช้แล้ว','font-mono\x20text-sm\x20whitespace-pre\x20px-1','กำลังจัดเรียงข้อมูล...','Initialization\x20failed:\x20','unshift','nameList','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-gray-500\x20ml-2\x22>(รหัส:\x20','text-blue-600','keys','คณิตศาสตร์เพิ่มเติม','welcome-message','415403943738','วิทยาศาสตร์และเทคโนโลยีเพิ่มเติม','showTab','มัธยม','keypress','copy','body','</p>','width','programpp-91f08','progress-bar','2741','store','admin-error','secondary','programpp-91f08.firebasestorage.app','getElementById','DOMContentLoaded','textContent','ตลอดปี','flex-shrink-0\x20p-3\x20pr-4\x20border-r-2\x20border-gray-300','div','Login\x20error:','42LLxLII','passwords'];_0x5002=function(){return _0xe3a8a6;};return _0x5002();}async function adminDeletePassword(_0x321c7d){const _0x42f7f6=_0x45a38f;if(!confirm(_0x42f7f6(0x183)+_0x321c7d+'\x22?'))return;if(!confirm(_0x42f7f6(0x169)))return;try{const _0x3cbbd6=_0x42f7f6(0x138)+appId+_0x42f7f6(0xef)+_0x321c7d,_0x36c164=doc(db,_0x3cbbd6);await deleteDoc(_0x36c164);const _0x31d5af=await getDoc(passwordListDocRef),_0x1a8817=_0x31d5af[_0x42f7f6(0x19f)]()?.[_0x42f7f6(0x118)]||[],_0x376c37=_0x1a8817[_0x42f7f6(0x16b)](_0x1025ad=>_0x1025ad[_0x42f7f6(0x12d)]!==_0x321c7d);await setDoc(passwordListDocRef,{'passwords':_0x376c37}),await loadAdminPasswordList();}catch(_0x4ef4fc){console[_0x42f7f6(0x180)](_0x42f7f6(0x193),_0x4ef4fc),adminError['textContent']=_0x42f7f6(0xd9)+_0x4ef4fc[_0x42f7f6(0x182)],adminError[_0x42f7f6(0x155)]['remove'](_0x42f7f6(0x160));}}function findLastStudentRowIndex(_0x3fa699,_0x1a6974,_0x52971d,_0x4357ea){const _0x3194bd=_0x45a38f;for(let _0x5022a3=_0x52971d;_0x5022a3>=_0x1a6974;_0x5022a3--){const _0x2e5e07=getCellValue(_0x3fa699,_0x5022a3,_0x4357ea);if(_0x2e5e07&&_0x2e5e07[_0x3194bd(0x131)]()!=='')return _0x5022a3;}return _0x1a6974-0x1;}function createEmptyData(_0x512cd3){const _0x3979c9=_0x45a38f;if(_0x512cd3<0x0)_0x512cd3=0x0;const _0x1bde8c=_0x512cd3+0x1,_0xb27378=Array(_0x512cd3)[_0x3979c9(0x171)](''),_0x5234c5=['\x09\x09',...Array(_0x512cd3)['fill']('\x09\x09')],_0x2f6a51=Array(_0x512cd3)[_0x3979c9(0x171)](''),_0x5f584a=currentUserTemplate===_0x3979c9(0x188)?_0x3979c9(0x1a2):_0x3979c9(0x19c),_0x5018fe=currentUserTemplate===_0x3979c9(0x188)?'\x09\x09':'',_0x20c0a5=[_0x5f584a,...Array(_0x512cd3)[_0x3979c9(0x171)](_0x5018fe)],_0x2cdfca=[Array(0x8)['fill'](_0x3979c9(0x19c))[_0x3979c9(0x1a4)]('\x09'),...Array(_0x512cd3)[_0x3979c9(0x171)]('\x09\x09\x09\x09\x09\x09\x09')],_0x37a719=[Array(0x5)['fill'](_0x3979c9(0x19c))[_0x3979c9(0x1a4)]('\x09'),...Array(_0x512cd3)[_0x3979c9(0x171)](_0x3979c9(0x13f))];return{'scoresLines':_0x5234c5,'rmLines':_0x2f6a51,'readingLines':_0x20c0a5,'attrLines':_0x2cdfca,'compLines':_0x37a719,'nameList':_0xb27378,'numStudentRows':_0x512cd3};}function padExtractedData(_0x4c6f90,_0x205e57){const _0x263c98=_0x45a38f,_0x56ab94=_0x4c6f90[_0x263c98(0xfa)]&&_0x4c6f90[_0x263c98(0xfa)][_0x263c98(0xed)]||0x0;if(_0x56ab94>=_0x205e57)return _0x4c6f90;const _0x48e47b=_0x205e57-_0x56ab94;if(_0x48e47b<=0x0)return _0x4c6f90;const _0x162b2=currentUserTemplate===_0x263c98(0x188)?'\x09\x09':'';return{'nameList':[..._0x4c6f90['nameList'],...Array(_0x48e47b)['fill']('')],'scoresLines':[..._0x4c6f90[_0x263c98(0x189)],...Array(_0x48e47b)[_0x263c98(0x171)]('\x09\x09')],'rmLines':[..._0x4c6f90[_0x263c98(0x141)],...Array(_0x48e47b)[_0x263c98(0x171)]('')],'readingLines':[..._0x4c6f90[_0x263c98(0x194)],...Array(_0x48e47b)['fill'](_0x162b2)],'attrLines':[..._0x4c6f90['attrLines'],...Array(_0x48e47b)[_0x263c98(0x171)](_0x263c98(0x12f))],'compLines':[..._0x4c6f90[_0x263c98(0x190)],...Array(_0x48e47b)[_0x263c98(0x171)](_0x263c98(0x13f))],'numStudentRows':_0x205e57};}function _0x515f(_0x5dc92a,_0x4e62de){const _0x5002b8=_0x5002();return _0x515f=function(_0x515f20,_0x17b744){_0x515f20=_0x515f20-0xd1;let _0x145aea=_0x5002b8[_0x515f20];return _0x145aea;},_0x515f(_0x5dc92a,_0x4e62de);}async function handleFile(_0x38fd1a){const _0x1d90cb=_0x45a38f;if(!currentUserTemplate||!userDataDocRef){showError('เกิดข้อผิดพลาด:\x20ไม่ได้เข้าสู่ระบบ');return;}const _0xa2fd91=_0x38fd1a[_0x1d90cb(0xf2)][_0x1d90cb(0x15a)];if(!_0xa2fd91||_0xa2fd91['length']===0x0)return;const _0x391dde=_0xa2fd91['length'];resetUI(),resultsDiv[_0x1d90cb(0x155)][_0x1d90cb(0xd6)](_0x1d90cb(0x160)),errorDiv['classList']['add'](_0x1d90cb(0x160)),progressContainer[_0x1d90cb(0x155)][_0x1d90cb(0x16d)]('hidden'),progressStatus[_0x1d90cb(0x155)][_0x1d90cb(0x16d)]('hidden'),progressBar[_0x1d90cb(0x11d)][_0x1d90cb(0x108)]='0%',progressText[_0x1d90cb(0x112)]='0%',progressStatus['textContent']='กำลังเตรียมไฟล์...\x20(0/'+_0x391dde+')';const _0x14cff8=currentUserTemplate==='primary'?PRIMARY_TEMPLATE:SECONDARY_TEMPLATE;let _0xfa8c6a=[];try{for(let _0xbff668=0x0;_0xbff668<_0x391dde;_0xbff668++){const _0x4a0312=_0xa2fd91[_0xbff668];progressStatus[_0x1d90cb(0x112)]=_0x1d90cb(0x187)+(_0xbff668+0x1)+'\x20จาก\x20'+_0x391dde+':\x20'+_0x4a0312['name'];const _0x193236=await new Promise((_0x16929a,_0x33d75c)=>{const _0x4d63e9=_0x1d90cb,_0x1d12d1=new FileReader();_0x1d12d1[_0x4d63e9(0x18c)]=_0x5c8a59=>{const _0x5d0125=_0x4d63e9;try{const _0x4e2ecf=new Uint8Array(_0x5c8a59['target']['result']),_0x28288b=XLSX[_0x5d0125(0x12c)](_0x4e2ecf,{'type':_0x5d0125(0x16e)}),_0x3ac92e='รายงาน1',_0x316759=_0x5d0125(0xd1);if(!_0x28288b[_0x5d0125(0x178)][_0x5d0125(0xe3)](_0x3ac92e))_0x33d75c(_0x5d0125(0x146)+_0x4a0312[_0x5d0125(0x1a1)]);if(!_0x28288b['SheetNames'][_0x5d0125(0xe3)](_0x316759))_0x33d75c(_0x5d0125(0x196)+_0x4a0312[_0x5d0125(0x1a1)]);const _0x2b8b22=_0x28288b[_0x5d0125(0x140)][_0x3ac92e],_0x30a402=_0x28288b['Sheets'][_0x316759];let _0x4180b4=getCellValue(_0x30a402,0xa,0x2)||_0x4a0312['name'];const _0x55d8e6={'semesterLabel':getCellValue(_0x30a402,0x3,0x4),'yearLabel':getCellValue(_0x30a402,0x4,0x4),'semesterValue':getCellValue(_0x30a402,0x3,0x5),'yearValue':getCellValue(_0x30a402,0x4,0x5)};if(_0x14cff8[_0x5d0125(0xe3)](_0x4180b4)){const _0x15b9ff=extractDataFromSheet(_0x2b8b22,currentUserTemplate);processedDataStore[_0x4180b4]={'extractedData':_0x15b9ff,'semesterInfo':_0x55d8e6},_0x16929a({'fileIdentifier':_0x4180b4,'extractedData':_0x15b9ff,'semesterInfo':_0x55d8e6,'ignored':![]});}else _0x16929a({'fileIdentifier':_0x4180b4,'extractedData':null,'semesterInfo':_0x55d8e6,'ignored':!![]});}catch(_0x41e546){_0x33d75c(_0x5d0125(0x19b)+_0x4a0312['name']+':\x20'+_0x41e546[_0x5d0125(0x182)]);}},_0x1d12d1[_0x4d63e9(0x15c)]=()=>_0x33d75c(_0x4d63e9(0x11f)+_0x4a0312['name']+'\x20ได้'),_0x1d12d1[_0x4d63e9(0x177)](_0x4a0312);});!_0x193236[_0x1d90cb(0x1a5)]&&_0xfa8c6a[_0x1d90cb(0x11e)](_0x193236);const _0x353b44=Math['round']((_0xbff668+0x1)/_0x391dde*0x64);progressBar[_0x1d90cb(0x11d)][_0x1d90cb(0x108)]=_0x353b44+'%',progressText[_0x1d90cb(0x112)]=_0x353b44+'%';}if(_0xfa8c6a[_0x1d90cb(0xed)]>0x0)displaySemesterInfo(_0xfa8c6a[0x0][_0x1d90cb(0xe4)]);else{if(Object['keys'](processedDataStore)[_0x1d90cb(0xed)]>0x0){const _0x4471bc=_0x14cff8['find'](_0x39cf2e=>processedDataStore[_0x39cf2e]);_0x4471bc&&displaySemesterInfo(processedDataStore[_0x4471bc][_0x1d90cb(0xe4)]);}else displaySemesterInfo(null);}progressStatus[_0x1d90cb(0x112)]=_0x1d90cb(0xf7);const _0xcdbb45=Math[_0x1d90cb(0x159)](0x0,...Object[_0x1d90cb(0x134)](processedDataStore)[_0x1d90cb(0x18e)](_0x3b02ec=>_0x3b02ec[_0x1d90cb(0x17c)][_0x1d90cb(0xfa)]&&_0x3b02ec[_0x1d90cb(0x17c)][_0x1d90cb(0xfa)][_0x1d90cb(0xed)]||0x0)),_0x554750=_0x14cff8['map'](_0x551d2c=>processedDataStore[_0x551d2c])['find'](_0x1b4e2f=>_0x1b4e2f&&_0x1b4e2f[_0x1d90cb(0x17c)][_0x1d90cb(0xfa)]['length']>0x0);let _0x550efe=_0x554750?_0x554750[_0x1d90cb(0x17c)][_0x1d90cb(0xfa)]:[];_0x550efe[_0x1d90cb(0xed)]<_0xcdbb45&&(_0x550efe=[..._0x550efe,...Array(_0xcdbb45-_0x550efe[_0x1d90cb(0xed)])[_0x1d90cb(0x171)]('')]);activeResults=_0x14cff8[_0x1d90cb(0x18e)](_0x341750=>{const _0x349dcd=processedDataStore[_0x341750];if(_0x349dcd){const _0x4cb3d9=padExtractedData(_0x349dcd['extractedData'],_0xcdbb45);return{'fileIdentifier':_0x341750,'extractedData':_0x4cb3d9};}else return{'fileIdentifier':_0x341750,'extractedData':createEmptyData(_0xcdbb45)};});try{await setDoc(userDataDocRef,{'store':processedDataStore});}catch(_0x2dbbe8){showError('ไม่สามารถบันทึกข้อมูลไฟล์ได้:\x20'+_0x2dbbe8[_0x1d90cb(0x182)]);}mergeAndDisplayResults(activeResults,_0x550efe,_0xcdbb45),resultsDiv[_0x1d90cb(0x155)][_0x1d90cb(0x16d)](_0x1d90cb(0x160)),showTab(0x1),progressStatus[_0x1d90cb(0x112)]=_0x1d90cb(0x151),setTimeout(()=>{const _0x2a679b=_0x1d90cb;progressContainer[_0x2a679b(0x155)][_0x2a679b(0xd6)](_0x2a679b(0x160)),progressStatus[_0x2a679b(0x155)][_0x2a679b(0xd6)](_0x2a679b(0x160));},0x5dc);const _0x2b29b3=_0x14cff8[_0x1d90cb(0x14a)](_0x658d18=>processedDataStore[_0x658d18]);_0x2b29b3?completionBar[_0x1d90cb(0x155)]['remove'](_0x1d90cb(0x160)):completionBar[_0x1d90cb(0x155)][_0x1d90cb(0xd6)](_0x1d90cb(0x160));}catch(_0x3d86de){showError(_0x3d86de),fileInput[_0x1d90cb(0x198)]='',progressContainer[_0x1d90cb(0x155)]['add']('hidden'),progressStatus[_0x1d90cb(0x155)][_0x1d90cb(0xd6)]('hidden');}}function resetUI(){const _0x5f4314=_0x45a38f;outputScores[_0x5f4314(0x112)]='',outputReading['textContent']='',outputRm['textContent']='',outputAttributes[_0x5f4314(0x112)]='',outputCompetency['textContent']='',visualScores[_0x5f4314(0x119)]='',visualReading['innerHTML']='',visualRm[_0x5f4314(0x119)]='',visualAttributes[_0x5f4314(0x119)]='',visualCompetency[_0x5f4314(0x119)]='';if(semesterInfoEl)semesterInfoEl[_0x5f4314(0x112)]='';if(completionBar)completionBar[_0x5f4314(0x155)][_0x5f4314(0xd6)](_0x5f4314(0x160));[copyBtn1,copyBtn2,copyBtn3,copyBtn4,copyBtn5]['forEach'](_0x527615=>{const _0x7a1b68=_0x5f4314;_0x527615&&(_0x527615['textContent']='คัดลอก\x20(เฉพาะข้อมูล)',_0x527615[_0x7a1b68(0x155)]['remove'](_0x7a1b68(0xd8),_0x7a1b68(0xe7)),_0x527615[_0x7a1b68(0x155)][_0x7a1b68(0xd6)]('bg-green-500',_0x7a1b68(0x17e)));});if(progressContainer)progressContainer[_0x5f4314(0x155)]['add'](_0x5f4314(0x160));if(progressStatus)progressStatus['classList'][_0x5f4314(0xd6)](_0x5f4314(0x160));}function showError(_0x41ef12){const _0x1f5d35=_0x45a38f;errorText['textContent']=_0x41ef12,errorDiv[_0x1f5d35(0x155)][_0x1f5d35(0x16d)]('hidden');}function getCellValue(_0x12b402,_0x486b4d,_0x2e7e04){const _0x5151d3=_0x45a38f,_0x58ad7e=_0x12b402[XLSX[_0x5151d3(0x13b)][_0x5151d3(0x19d)]({'r':_0x486b4d,'c':_0x2e7e04})];if(!_0x58ad7e)return'';return _0x58ad7e['w']!==null&&_0x58ad7e['w']!==undefined?String(_0x58ad7e['w']):_0x58ad7e['v']!==null&&_0x58ad7e['v']!==undefined?String(_0x58ad7e['v']):'';}function displaySemesterInfo(_0x24f019){const _0x306078=_0x45a38f;if(!semesterInfoEl)return;if(!_0x24f019){semesterInfoEl['textContent']='';return;}const {semesterLabel:_0xbd4860,yearLabel:_0x355719,semesterValue:_0x4eab7d,yearValue:_0x8705be}=_0x24f019;let _0x114d35='';_0x4eab7d&&_0x8705be&&(_0x4eab7d[_0x306078(0xe3)](_0x306078(0x113))?_0x114d35='ตลอดปีการศึกษา\x20'+_0x8705be:_0x114d35=(_0xbd4860||'ภาคเรียนที่')+'\x20'+_0x4eab7d+'\x20'+(_0x355719||_0x306078(0x181))+'\x20'+_0x8705be),semesterInfoEl[_0x306078(0x112)]=_0x114d35;}function extractDataFromSheet(_0x1c2636,_0x19737c){const _0xcf90c=_0x45a38f,_0x16c722=findLastStudentRowIndex(_0x1c2636,0x6,0x37,0x3),_0x6687fb=_0x16c722<0x6?0x0:_0x16c722-0x6+0x1;let _0x256aa8=[],_0x5e17d7=[],_0x5df66f=[],_0x8d6c5a=[],_0x520ac9=[],_0x4beaf7=[];if(_0x6687fb>0x0){for(let _0x58337c=0x6;_0x58337c<=_0x16c722;_0x58337c++){_0x256aa8['push'](getCellValue(_0x1c2636,_0x58337c,0x3));}for(let _0x19249a=0x5;_0x19249a<=_0x16c722;_0x19249a++){_0x5e17d7[_0xcf90c(0x11e)]([getCellValue(_0x1c2636,_0x19249a,0x4),getCellValue(_0x1c2636,_0x19249a,0x5),getCellValue(_0x1c2636,_0x19249a,0x6)][_0xcf90c(0x1a4)]('\x09'));}for(let _0x4f3544=0x6;_0x4f3544<=_0x16c722;_0x4f3544++){let _0x2724ce=getCellValue(_0x1c2636,_0x4f3544,0x7)[_0xcf90c(0x131)]();_0x5df66f[_0xcf90c(0x11e)](_0x2724ce==='ร'||_0x2724ce==='มส'?_0x2724ce:'');}if(_0x19737c===_0xcf90c(0x188)){_0x8d6c5a[_0xcf90c(0x11e)](_0xcf90c(0x1a2));for(let _0x37cd6a=0x6;_0x37cd6a<=_0x16c722;_0x37cd6a++){_0x8d6c5a[_0xcf90c(0x11e)]([getCellValue(_0x1c2636,_0x37cd6a,0x8),getCellValue(_0x1c2636,_0x37cd6a,0x9),getCellValue(_0x1c2636,_0x37cd6a,0xa)]['join']('\x09'));}}else{_0x8d6c5a[_0xcf90c(0x11e)]('100');for(let _0x1c34ad=0x6;_0x1c34ad<=_0x16c722;_0x1c34ad++){_0x8d6c5a['push'](getCellValue(_0x1c2636,_0x1c34ad,0xb));}}let _0x4a6b7a=[];for(let _0x3c3b25=0xd;_0x3c3b25<=0x14;_0x3c3b25++)_0x4a6b7a[_0xcf90c(0x11e)](_0xcf90c(0x19c));_0x520ac9[_0xcf90c(0x11e)](_0x4a6b7a['join']('\x09'));for(let _0x58d2cd=0x6;_0x58d2cd<=_0x16c722;_0x58d2cd++){let _0x522742=[];for(let _0x1880f0=0xd;_0x1880f0<=0x14;_0x1880f0++)_0x522742[_0xcf90c(0x11e)](getCellValue(_0x1c2636,_0x58d2cd,_0x1880f0));_0x520ac9['push'](_0x522742[_0xcf90c(0x1a4)]('\x09'));}let _0x5c6055=[];for(let _0x12a22f=0x19;_0x12a22f<=0x1d;_0x12a22f++)_0x5c6055['push'](_0xcf90c(0x19c));_0x4beaf7[_0xcf90c(0x11e)](_0x5c6055[_0xcf90c(0x1a4)]('\x09'));for(let _0x12401b=0x6;_0x12401b<=_0x16c722;_0x12401b++){let _0x5c111f=[];for(let _0x4c504f=0x19;_0x4c504f<=0x1d;_0x4c504f++)_0x5c111f[_0xcf90c(0x11e)](getCellValue(_0x1c2636,_0x12401b,_0x4c504f));_0x4beaf7[_0xcf90c(0x11e)](_0x5c111f[_0xcf90c(0x1a4)]('\x09'));}}else{_0x5e17d7[_0xcf90c(0x11e)]('\x09\x09'),_0x8d6c5a[_0xcf90c(0x11e)](_0x19737c===_0xcf90c(0x188)?_0xcf90c(0x1a2):_0xcf90c(0x19c));let _0x53b2b6=[];for(let _0x53cdcc=0xd;_0x53cdcc<=0x14;_0x53cdcc++)_0x53b2b6[_0xcf90c(0x11e)](_0xcf90c(0x19c));_0x520ac9[_0xcf90c(0x11e)](_0x53b2b6[_0xcf90c(0x1a4)]('\x09'));let _0x5a77f6=[];for(let _0x9970fd=0x19;_0x9970fd<=0x1d;_0x9970fd++)_0x5a77f6[_0xcf90c(0x11e)](_0xcf90c(0x19c));_0x4beaf7[_0xcf90c(0x11e)](_0x5a77f6[_0xcf90c(0x1a4)]('\x09'));}return{'scoresLines':_0x5e17d7,'rmLines':_0x5df66f,'readingLines':_0x8d6c5a,'attrLines':_0x520ac9,'compLines':_0x4beaf7,'nameList':_0x256aa8,'numStudentRows':_0x6687fb};}function buildVisualBlock(_0x1a5e99,_0x5eea88,_0x33b732,_0x2674e0,_0x5c4aa2){const _0x6d315b=_0x45a38f;_0x33b732[_0x6d315b(0x119)]='';const _0x12f69d=_0x2674e0,_0x6d9b8a=document[_0x6d315b(0x161)](_0x6d315b(0x115));_0x6d9b8a['className']=_0x6d315b(0x114),_0x6d9b8a['innerHTML']='<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-gray-700\x20mb-2\x20whitespace-nowrap\x22>ชื่อ-สกุล</div>';const _0x1fb7bd=document[_0x6d315b(0x161)](_0x6d315b(0x115));_0x6d9b8a['appendChild'](_0x1fb7bd);let _0x5f07f5=[..._0x12f69d];if(_0x5eea88!==_0x6d315b(0x141)&&_0x5f07f5[_0x6d315b(0xed)]>0x0)_0x5f07f5[_0x6d315b(0xf9)]('');else _0x5eea88!=='rmLines'&&_0x5f07f5['length']===0x0&&_0x5f07f5['unshift']('');_0x5f07f5['forEach']((_0x75ebdc,_0x107bcd)=>{const _0x15648c=_0x6d315b,_0x598ad9=document[_0x15648c(0x161)](_0x15648c(0x115));_0x598ad9[_0x15648c(0x153)]=_0x15648c(0x158);if(_0x107bcd%0x2!==0x0)_0x598ad9[_0x15648c(0x155)][_0x15648c(0xd6)]('bg-gray-100');_0x598ad9['textContent']=_0x75ebdc||'\u00a0',_0x1fb7bd[_0x15648c(0x192)](_0x598ad9);}),_0x33b732[_0x6d315b(0x192)](_0x6d9b8a),_0x1a5e99[_0x6d315b(0x1a0)]((_0x4230b2,_0x283f03)=>{const _0x2f2843=_0x6d315b,{fileIdentifier:_0x55d19c,extractedData:_0x318f8e}=_0x4230b2,_0x39aa92=document['createElement']('div');_0x39aa92[_0x2f2843(0x153)]=_0x2f2843(0x12b);if(_0x283f03<_0x1a5e99[_0x2f2843(0xed)]-0x1)_0x39aa92[_0x2f2843(0x153)]+=_0x2f2843(0xeb);_0x39aa92[_0x2f2843(0x119)]=_0x2f2843(0x173)+_0x55d19c+_0x2f2843(0xe9);const _0x40457a=document[_0x2f2843(0x161)](_0x2f2843(0x115));_0x39aa92[_0x2f2843(0x192)](_0x40457a);const _0x23f695=_0x318f8e&&_0x318f8e[_0x5eea88]?_0x318f8e[_0x5eea88]:createEmptyData(_0x5c4aa2)[_0x5eea88];_0x23f695[_0x2f2843(0x1a0)]((_0x1f91d5,_0x45bbb6)=>{const _0x8c231b=_0x2f2843,_0x531850=document[_0x8c231b(0x161)]('div');_0x531850[_0x8c231b(0x153)]=_0x8c231b(0xf6);if(_0x45bbb6%0x2!==0x0)_0x531850['classList'][_0x8c231b(0xd6)](_0x8c231b(0x149));_0x531850['textContent']=_0x1f91d5||'\u00a0',_0x40457a[_0x8c231b(0x192)](_0x531850);}),_0x33b732[_0x2f2843(0x192)](_0x39aa92);});}function mergeAndDisplayResults(_0x2695f5,_0x574588,_0x1d2178){const _0x5830cf=_0x45a38f,_0x482800=(_0x35e453,_0x2dae83)=>{const _0x482d04=_0x515f;let _0x5da5db='';for(let _0x10ab47=0x0;_0x10ab47<_0x2dae83;_0x10ab47++){let _0x450959=[];for(const _0x45fe57 of _0x2695f5){const _0x4e1be2=_0x45fe57['extractedData']&&_0x45fe57[_0x482d04(0x17c)][_0x35e453]&&_0x45fe57[_0x482d04(0x17c)][_0x35e453][_0x10ab47]!==undefined?_0x45fe57[_0x482d04(0x17c)][_0x35e453][_0x10ab47]:createEmptyData(_0x1d2178)[_0x35e453][_0x10ab47];_0x35e453===_0x482d04(0x194)&&currentUserTemplate!==_0x482d04(0x188)?_0x450959[_0x482d04(0x11e)](_0x4e1be2+'\x09\x09'):_0x450959[_0x482d04(0x11e)](_0x4e1be2);}_0x5da5db+=_0x450959['join']('\x09')+'\x0a';}return _0x5da5db[_0x482d04(0x1a8)]();},_0x582cf9={'scoresLines':_0x1d2178+0x1,'rmLines':_0x1d2178,'readingLines':_0x1d2178+0x1,'attrLines':_0x1d2178+0x1,'compLines':_0x1d2178+0x1};outputScores[_0x5830cf(0x112)]=_0x482800('scoresLines',_0x582cf9[_0x5830cf(0x189)]),outputRm['textContent']=_0x482800('rmLines',_0x582cf9[_0x5830cf(0x141)]),outputReading[_0x5830cf(0x112)]=_0x482800(_0x5830cf(0x194),_0x582cf9[_0x5830cf(0x194)]),outputAttributes[_0x5830cf(0x112)]=_0x482800(_0x5830cf(0xf0),_0x582cf9['attrLines']),outputCompetency['textContent']=_0x482800(_0x5830cf(0x190),_0x582cf9['compLines']),buildVisualBlock(_0x2695f5,_0x5830cf(0x189),visualScores,_0x574588,_0x1d2178),buildVisualBlock(_0x2695f5,_0x5830cf(0x141),visualRm,_0x574588,_0x1d2178),buildVisualBlock(_0x2695f5,_0x5830cf(0x194),visualReading,_0x574588,_0x1d2178),buildVisualBlock(_0x2695f5,'attrLines',visualAttributes,_0x574588,_0x1d2178),buildVisualBlock(_0x2695f5,_0x5830cf(0x190),visualCompetency,_0x574588,_0x1d2178);}function copyToClipboard(_0x27a28b,_0x20dd09){const _0x305999=_0x45a38f,_0x16b7a7=document[_0x305999(0x161)](_0x305999(0x17a));_0x16b7a7[_0x305999(0x198)]=_0x27a28b,_0x16b7a7[_0x305999(0x11d)][_0x305999(0x142)]=_0x305999(0x14c),_0x16b7a7['style'][_0x305999(0x1a6)]=0x0,document[_0x305999(0x106)][_0x305999(0x192)](_0x16b7a7),_0x16b7a7['select']();try{document[_0x305999(0x166)](_0x305999(0x105));const _0x26b5a9=_0x20dd09[_0x305999(0x112)];_0x20dd09[_0x305999(0x112)]='คัดลอกแล้ว!',_0x20dd09[_0x305999(0x155)]['remove'](_0x305999(0x185),_0x305999(0x17e)),_0x20dd09['classList'][_0x305999(0xd6)](_0x305999(0xd8)),setTimeout(()=>{const _0x2a5016=_0x305999;_0x20dd09[_0x2a5016(0x112)]=_0x26b5a9,_0x20dd09['classList'][_0x2a5016(0x16d)](_0x2a5016(0xd8)),_0x20dd09['classList'][_0x2a5016(0xd6)]('bg-green-500',_0x2a5016(0x17e));},0x5dc);}catch(_0x4f7b67){console[_0x305999(0x180)](_0x305999(0x130),_0x4f7b67);}document[_0x305999(0x106)][_0x305999(0x13c)](_0x16b7a7);}
