const _0x5b0717=_0x1810;(function(_0x5224e8,_0x55374b){const _0x130c99=_0x1810,_0x280f1c=_0x5224e8();while(!![]){try{const _0x5738a7=-parseInt(_0x130c99(0xbb))/0x1*(-parseInt(_0x130c99(0x7d))/0x2)+parseInt(_0x130c99(0x79))/0x3+parseInt(_0x130c99(0x124))/0x4+-parseInt(_0x130c99(0x10b))/0x5+-parseInt(_0x130c99(0xa4))/0x6*(parseInt(_0x130c99(0xd5))/0x7)+-parseInt(_0x130c99(0x123))/0x8+-parseInt(_0x130c99(0xee))/0x9;if(_0x5738a7===_0x55374b)break;else _0x280f1c['push'](_0x280f1c['shift']());}catch(_0x1c21e5){_0x280f1c['push'](_0x280f1c['shift']());}}}(_0x34ab,0x59d7c));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously,signInWithCustomToken}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,doc,getDoc,setDoc,deleteDoc,setLogLevel}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const SUBJECT_DATA={'primary':{'subjects':[_0x5b0717(0x71),_0x5b0717(0xe0),'วิทยาศาสตร์และเทคโนโลยี','สังคมศึกษา\x20ศาสนาและวัฒนธรรม',_0x5b0717(0xe2),'สุขศึกษาและพลศึกษา',_0x5b0717(0xaf),_0x5b0717(0x10a),_0x5b0717(0xd0),_0x5b0717(0x14e),_0x5b0717(0x119)],'abbreviations':[_0x5b0717(0xb8),'คณิต','วิทย์','สังคม','ประวัติ',_0x5b0717(0x15b),'ศิลปะ','การงานอาชีพ',_0x5b0717(0xd7),_0x5b0717(0x8f),'ต้านทุจริต'],'credits':[0x4,0x4,0x3,0x2,0x1,0x1,0x2,0x2,0x2,0x1,0x1]},'secondary':{'subjects':['ภาษาไทย',_0x5b0717(0xcf),_0x5b0717(0x11f),_0x5b0717(0xea),'วิทยาศาสตร์และเทคโนโลยีเพิ่มเติม',_0x5b0717(0x11d),_0x5b0717(0xe2),_0x5b0717(0x14f),_0x5b0717(0x136),'ศิลปะ',_0x5b0717(0xb1),_0x5b0717(0x145),'ภาษาอังกฤษพื้นฐาน',_0x5b0717(0x14e),'ป้องกันการทุจริต'],'abbreviations':[_0x5b0717(0xb8),_0x5b0717(0x11c),_0x5b0717(0x139),'วิทย์',_0x5b0717(0x117),_0x5b0717(0x134),'ประวัติ',_0x5b0717(0x164),_0x5b0717(0x15b),_0x5b0717(0xaf),'การงาน',_0x5b0717(0x112),_0x5b0717(0xd7),'อังกฤษเพิ่ม','ต้านทุจริต'],'credits':[1.5,1.5,0.5,1.5,0.5,1.5,0.5,0.5,0.5,0x1,0x1,0.5,1.5,0.5,0.5]}};let db,auth,appId=_0x5b0717(0xf9),passwordListDocRef,userDataDocRef,currentUserPassword=null,currentUserName=null,currentUserTemplate=null,activeResults=[],processedDataStore={};const loginScreen=document[_0x5b0717(0xc5)]('login-screen'),adminPanel=document[_0x5b0717(0xc5)]('admin-panel'),mainApp=document[_0x5b0717(0xc5)](_0x5b0717(0x14d)),adminBtn=document[_0x5b0717(0xc5)](_0x5b0717(0x73)),loginBtn=document[_0x5b0717(0xc5)](_0x5b0717(0xbc)),passwordInput=document[_0x5b0717(0xc5)]('password-input'),loginError=document[_0x5b0717(0xc5)](_0x5b0717(0x7a)),logoutBtn=document[_0x5b0717(0xc5)](_0x5b0717(0x143)),resetDataBtn=document[_0x5b0717(0xc5)]('reset-data-btn'),adminCloseBtn=document[_0x5b0717(0xc5)](_0x5b0717(0x10e)),adminNameInput=document[_0x5b0717(0xc5)](_0x5b0717(0x78)),adminPassInput=document[_0x5b0717(0xc5)]('admin-pass-input'),adminTemplateSelect=document[_0x5b0717(0xc5)]('admin-template-select'),adminAddBtn=document[_0x5b0717(0xc5)](_0x5b0717(0x14c)),adminUserListContainer=document[_0x5b0717(0xc5)](_0x5b0717(0x113)),adminError=document['getElementById'](_0x5b0717(0x160)),fileInput=document[_0x5b0717(0xc5)](_0x5b0717(0x83)),resultsDiv=document['getElementById']('results'),errorDiv=document[_0x5b0717(0xc5)](_0x5b0717(0x8e)),errorText=document[_0x5b0717(0xc5)](_0x5b0717(0xeb)),outputScores=document[_0x5b0717(0xc5)](_0x5b0717(0xf5)),outputReading=document[_0x5b0717(0xc5)](_0x5b0717(0x111)),outputRm=document[_0x5b0717(0xc5)]('output-rm'),outputAttributes=document['getElementById'](_0x5b0717(0x104)),outputCompetency=document[_0x5b0717(0xc5)](_0x5b0717(0xbd)),visualScores=document[_0x5b0717(0xc5)](_0x5b0717(0xb2)),visualReading=document[_0x5b0717(0xc5)](_0x5b0717(0x146)),visualRm=document['getElementById'](_0x5b0717(0x14a)),visualAttributes=document[_0x5b0717(0xc5)]('visual-attributes'),visualCompetency=document[_0x5b0717(0xc5)]('visual-competency'),copyBtn1=document['getElementById'](_0x5b0717(0x99)),copyBtn2=document[_0x5b0717(0xc5)](_0x5b0717(0x10d)),copyBtn3=document['getElementById'](_0x5b0717(0xef)),copyBtn4=document[_0x5b0717(0xc5)](_0x5b0717(0x8a)),copyBtn5=document[_0x5b0717(0xc5)](_0x5b0717(0x12e)),semesterInfoEl=document[_0x5b0717(0xc5)](_0x5b0717(0x15e)),outputIndividual=document[_0x5b0717(0xc5)](_0x5b0717(0xfa)),visualIndividual=document['getElementById'](_0x5b0717(0xc4)),copyBtn6=document['getElementById'](_0x5b0717(0xa8)),progressContainer=document['getElementById'](_0x5b0717(0x84)),progressBar=document[_0x5b0717(0xc5)]('progress-bar'),progressText=document[_0x5b0717(0xc5)]('progress-text'),progressStatus=document[_0x5b0717(0xc5)](_0x5b0717(0xf3)),completionBar=document['getElementById'](_0x5b0717(0x118));function showTab(_0x4c08fb){const _0x22f637=_0x5b0717;document[_0x22f637(0xe1)](_0x22f637(0x140))['forEach'](_0x564603=>_0x564603['classList'][_0x22f637(0x158)](_0x22f637(0x154),_0x22f637(0x169),_0x22f637(0x12c),'font-medium')),document[_0x22f637(0xe1)](_0x22f637(0x163))['forEach'](_0x1ce696=>_0x1ce696[_0x22f637(0xf7)][_0x22f637(0x148)](_0x22f637(0xb5)));const _0x53dc68=document[_0x22f637(0xc5)](_0x22f637(0xc9)+_0x4c08fb),_0x41b4d0=document[_0x22f637(0xc5)](_0x22f637(0x72)+_0x4c08fb);if(_0x53dc68)_0x53dc68['classList'][_0x22f637(0x148)](_0x22f637(0x154),_0x22f637(0x169),_0x22f637(0x12c),'font-medium');if(_0x41b4d0)_0x41b4d0[_0x22f637(0xf7)]['remove']('hidden');}window[_0x5b0717(0x11a)]=showTab;function scoreToGrade(_0x51bfe2){const _0x272767=parseFloat(_0x51bfe2);if(isNaN(_0x272767))return 0x0;if(_0x272767>=0x50)return 0x4;if(_0x272767>=0x4b)return 3.5;if(_0x272767>=0x46)return 0x3;if(_0x272767>=0x41)return 2.5;if(_0x272767>=0x3c)return 0x2;if(_0x272767>=0x37)return 1.5;if(_0x272767>=0x32)return 0x1;return 0x0;}function calculateAndDisplayGPA(_0x285600,_0x2d4bae,_0x20c683){const _0x4e9f3c=_0x5b0717;if(_0x20c683===0x0){if(visualIndividual)visualIndividual[_0x4e9f3c(0x130)]='';if(outputIndividual)outputIndividual['textContent']='';return;}const _0x56e5e1=currentUserTemplate==='primary'?SUBJECT_DATA[_0x4e9f3c(0x7f)]:SUBJECT_DATA[_0x4e9f3c(0x96)],{abbreviations:_0x308437,credits:_0x4c093f}=_0x56e5e1;let _0x26ed2f=[];for(let _0x29aa59=0x0;_0x29aa59<_0x20c683;_0x29aa59++){let _0x4c43d1=0x0,_0x33c879=0x0,_0x1c5b42=[];const _0x40cdc9=_0x2d4bae[_0x29aa59];for(let _0x4a2692=0x0;_0x4a2692<_0x285600[_0x4e9f3c(0xf4)];_0x4a2692++){const _0xbe530f=_0x285600[_0x4a2692],_0x5e0be6=_0x4c093f[_0x4a2692];let _0x415eb9=0x0;if(_0xbe530f&&_0xbe530f['extractedData']){const _0x5b8f8f=_0xbe530f['extractedData'][_0x4e9f3c(0x97)][_0x29aa59]?_0xbe530f[_0x4e9f3c(0x70)]['rmLines'][_0x29aa59]['trim']():'';if(_0x5b8f8f==='ร'||_0x5b8f8f==='มส')_0x415eb9=0x0,_0x1c5b42['push'](_0x5b8f8f);else{const _0x154fc4=_0xbe530f['extractedData'][_0x4e9f3c(0x126)][_0x29aa59+0x1],_0x500888=_0x154fc4?_0x154fc4[_0x4e9f3c(0x7b)]('\x09')[0x2]:'0';_0x415eb9=scoreToGrade(_0x500888),_0x1c5b42[_0x4e9f3c(0x8b)](_0x415eb9[_0x4e9f3c(0x92)](0x1));}_0x4c43d1+=_0x415eb9*_0x5e0be6,_0x33c879+=_0x5e0be6;}else _0x1c5b42['push']('-');}const _0x996e14=_0x33c879>0x0?_0x4c43d1/_0x33c879:0x0;_0x26ed2f['push']({'name':_0x40cdc9,'grades':_0x1c5b42,'gpa':_0x996e14,'originalIndex':_0x29aa59});}let _0x505767=0x1,_0xf95d50=-0x1,_0x3b1da4=[];const _0x3a36d2=[..._0x26ed2f][_0x4e9f3c(0xe8)]((_0x58e612,_0x26dd6e)=>_0x26dd6e[_0x4e9f3c(0xb7)]-_0x58e612['gpa']);for(let _0x23b5d1=0x0;_0x23b5d1<_0x3a36d2[_0x4e9f3c(0xf4)];_0x23b5d1++){_0x3a36d2[_0x23b5d1]['gpa']!==_0xf95d50&&(_0x505767=_0x23b5d1+0x1,_0xf95d50=_0x3a36d2[_0x23b5d1][_0x4e9f3c(0xb7)]),_0x3b1da4[_0x4e9f3c(0x8b)]({..._0x3a36d2[_0x23b5d1],'rank':_0x505767});}const _0x30e370=_0x3b1da4[_0x4e9f3c(0xe8)]((_0x4939a2,_0x30ccee)=>_0x4939a2[_0x4e9f3c(0x12b)]-_0x30ccee[_0x4e9f3c(0x12b)]);let _0x3d6072='';const _0x2dcb66=document['createElement']('table'),_0x173a45=document['createElement'](_0x4e9f3c(0x8c)),_0x3f4845=document[_0x4e9f3c(0x156)]('tbody'),_0x1bb3b0=['ชื่อ-สกุล',_0x4e9f3c(0x12a),_0x4e9f3c(0x103),..._0x308437];let _0x4e2170=_0x4e9f3c(0x76);_0x1bb3b0[_0x4e9f3c(0x13e)](_0x4b7eb9=>{const _0x28f1c5=_0x4e9f3c;_0x4e2170+='<th>'+_0x4b7eb9+_0x28f1c5(0x150);}),_0x4e2170+=_0x4e9f3c(0x9d),_0x173a45[_0x4e9f3c(0x130)]=_0x4e2170,_0x3d6072=_0x1bb3b0[_0x4e9f3c(0xf0)]('\x09')+'\x0a',_0x30e370['forEach']((_0x5a87e8,_0x112af0)=>{const _0x5c3449=_0x4e9f3c;let _0x15c612=_0x5c3449(0x153)+_0x5a87e8['name']+_0x5c3449(0x125);_0x15c612+=_0x5c3449(0x144)+_0x5a87e8['gpa']['toFixed'](0x2)+_0x5c3449(0x125),_0x15c612+=_0x5c3449(0x144)+_0x5a87e8[_0x5c3449(0x7c)]+_0x5c3449(0x125);let _0x4ac110=_0x5a87e8['name']+'\x09'+_0x5a87e8[_0x5c3449(0xb7)][_0x5c3449(0x92)](0x2)+'\x09'+_0x5a87e8[_0x5c3449(0x7c)]+'\x09';_0x5a87e8[_0x5c3449(0x11e)]['forEach']((_0x8bc3c2,_0x1ae64d)=>{const _0x36c7ef=_0x5c3449,_0x2ba1ae=_0x8bc3c2===0x0||_0x8bc3c2==='0'||_0x8bc3c2===_0x36c7ef(0x16b)||_0x8bc3c2==='ร'||_0x8bc3c2==='มส',_0x5eed02=_0x2ba1ae?_0x36c7ef(0x87):'';_0x15c612+=_0x36c7ef(0x133)+_0x5eed02+'>'+_0x8bc3c2+_0x36c7ef(0x125),_0x4ac110+=_0x8bc3c2+'\x09';}),_0x15c612+=_0x5c3449(0x9d),_0x3f4845[_0x5c3449(0x130)]+=_0x15c612,_0x3d6072+=_0x4ac110[_0x5c3449(0x138)]()+'\x0a';}),_0x2dcb66[_0x4e9f3c(0x168)](_0x173a45),_0x2dcb66['appendChild'](_0x3f4845),visualIndividual&&(visualIndividual[_0x4e9f3c(0x130)]='',visualIndividual['appendChild'](_0x2dcb66),_0x3f4845[_0x4e9f3c(0x105)](_0x4e9f3c(0xf8),_0x1de461=>{const _0x495012=_0x4e9f3c,_0x54b290=_0x1de461[_0x495012(0x129)][_0x495012(0x15f)]('tr');if(!_0x54b290)return;const _0x844e56=_0x3f4845['querySelector'](_0x495012(0x106));_0x844e56&&_0x844e56['classList'][_0x495012(0x158)](_0x495012(0x80)),_0x844e56!==_0x54b290&&_0x54b290[_0x495012(0xf7)][_0x495012(0x148)]('row-highlight');})),outputIndividual&&(outputIndividual[_0x4e9f3c(0xf1)]=_0x3d6072[_0x4e9f3c(0x13f)]());}async function main(){const _0x429bc6=_0x5b0717;try{const _0x465353={'apiKey':_0x429bc6(0x91),'authDomain':_0x429bc6(0x157),'projectId':_0x429bc6(0xf6),'storageBucket':_0x429bc6(0x167),'messagingSenderId':_0x429bc6(0xfe),'appId':_0x429bc6(0xe9),'measurementId':'G-W19QNQQR25'},_0x12ea39=typeof __firebase_config!==_0x429bc6(0x108)?JSON[_0x429bc6(0xdf)](__firebase_config):_0x465353;appId=typeof __app_id!==_0x429bc6(0x108)?__app_id:_0x429bc6(0xf9);if(!_0x12ea39[_0x429bc6(0x89)])throw new Error(_0x429bc6(0x162));const _0x1fd67b=initializeApp(_0x12ea39);db=getFirestore(_0x1fd67b),auth=getAuth(_0x1fd67b),setLogLevel(_0x429bc6(0x9b));typeof __initial_auth_token!==_0x429bc6(0x108)&&__initial_auth_token?await signInWithCustomToken(auth,__initial_auth_token):await signInAnonymously(auth);const _0x2e6f9a=_0x429bc6(0xe7)+appId+_0x429bc6(0xba);passwordListDocRef=doc(db,_0x2e6f9a),loginBtn['addEventListener'](_0x429bc6(0xf8),loginUser),adminBtn[_0x429bc6(0x105)](_0x429bc6(0xf8),promptAdminAccess),adminCloseBtn['addEventListener'](_0x429bc6(0xf8),closeAdminPanel),adminAddBtn['addEventListener']('click',adminAddPassword),logoutBtn[_0x429bc6(0x105)](_0x429bc6(0xf8),logoutUser),resetDataBtn[_0x429bc6(0x105)]('click',resetAllData),passwordInput[_0x429bc6(0x105)](_0x429bc6(0x16f),_0x1ca816=>{const _0x371fc1=_0x429bc6;if(_0x1ca816['key']===_0x371fc1(0x166))loginUser();}),fileInput['addEventListener'](_0x429bc6(0xbf),handleFile),copyBtn1[_0x429bc6(0x105)]('click',()=>copyToClipboard(outputScores[_0x429bc6(0xf1)],copyBtn1)),copyBtn2[_0x429bc6(0x105)](_0x429bc6(0xf8),()=>copyToClipboard(outputRm[_0x429bc6(0xf1)],copyBtn2)),copyBtn3['addEventListener'](_0x429bc6(0xf8),()=>copyToClipboard(outputReading['textContent'],copyBtn3)),copyBtn4[_0x429bc6(0x105)](_0x429bc6(0xf8),()=>copyToClipboard(outputAttributes[_0x429bc6(0xf1)],copyBtn4)),copyBtn5[_0x429bc6(0x105)](_0x429bc6(0xf8),()=>copyToClipboard(outputCompetency[_0x429bc6(0xf1)],copyBtn5)),copyBtn6[_0x429bc6(0x105)](_0x429bc6(0xf8),()=>copyToClipboard(outputIndividual[_0x429bc6(0xf1)],copyBtn6)),loginScreen[_0x429bc6(0xf7)][_0x429bc6(0x158)](_0x429bc6(0xb5)),adminPanel[_0x429bc6(0xf7)][_0x429bc6(0x148)]('hidden'),mainApp[_0x429bc6(0xf7)][_0x429bc6(0x148)](_0x429bc6(0xb5));}catch(_0x47281f){console[_0x429bc6(0xb6)](_0x429bc6(0x9a),_0x47281f),showError('Initialization\x20failed:\x20'+_0x47281f['message']),loginScreen[_0x429bc6(0x130)]='<p\x20class=\x22text-red-500\x22>Initialization\x20failed:\x20'+_0x47281f[_0x429bc6(0x131)]+_0x429bc6(0xbe);}}document['addEventListener'](_0x5b0717(0x107),main);function _0x34ab(){const _0xdf3f43=['passwords','includes','\x20class=\x22text-danger\x22','\x20border-r-2\x20border-dashed\x20border-gray-300','projectId','copy-btn-4','push','thead','utils','error-message','อังกฤษเพิ่ม','semesterInfo','AIzaSyBHmJ7M5qf20lKPTB9_aE2Ppa0-jTryuuI','toFixed','span','values','Home','secondary','rmLines','onerror','copy-btn-1','Initialization\x20failed:','Debug','result','</tr>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-medium\x20text-gray-800\x22>','keys','array','รหัสผ่านนี้ถูกใช้แล้ว','max','bg-blue-500','666KKfJSm','welcome-message','className','100','copy-btn-6','\x22\x20class=\x22admin-delete-btn\x20text-red-500\x20hover:text-red-700\x20font-medium\x20text-sm\x22>ลบ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','removeChild','unshift','กรุณากรอกทั้งชื่อและรหัสผ่าน','ตลอดปีการศึกษา\x20','body','ศิลปะ','Sheets','การงานอาชีพพื้นฐาน','visual-scores','data','value','hidden','error','gpa','ไทย','เกิดข้อผิดพลาดในการอ่านไฟล์\x20','/public/data/passwords/password_list','1uTqpef','login-btn','output-competency','</p>','change','</div>','\x20(แบบ:\x20','คัดลอกแล้ว!','dataset','visual-individual','getElementById','ไม่สามารถบันทึกข้อมูลไฟล์ได้:\x20','style','มัธยม','tab-btn-','\x22\x20class=\x22admin-edit-btn\x20text-blue-500\x20hover:text-blue-700\x20font-medium\x20text-sm\x20mr-3\x22>แก้ไข</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','exists','\x20จาก\x20','ภาคเรียนที่','flex-shrink-0\x20p-3\x20pr-4\x20border-r-2\x20border-gray-300','คณิตศาสตร์พื้นฐาน','ภาษาอังกฤษ','ไม่สามารถล้างข้อมูลบนเซิร์ฟเวอร์ได้:\x20','กำลังจัดเรียงข้อมูล...','fill','Error\x20adding\x20password:','6139sYtBlm','100\x09100\x09100','อังกฤษ','คัดลอก\x20(เฉพาะข้อมูล)','รหัสผ่าน\x20Admin\x20ไม่ถูกต้อง','\x20ข้อมูลไฟล์ที่อัปโหลดไว้ทั้งหมดจะถูกลบ\x20ยืนยันหรือไม่?','bg-red-500','copy','Error\x20editing\x20user:','ประมวลผลเสร็จสิ้น!','parse','คณิตศาสตร์','querySelectorAll','ประวัติศาสตร์','pass','files','ยินดีต้อนรับ,\x20','ประถม','/artifacts/','sort','1:415403943738:web:f56ec72de49f81f0315203','วิทยาศาสตร์และเทคโนโลยีพื้นฐาน','error-text','div','some','1379331ANGDFj','copy-btn-3','join','textContent','/public/data/user_data/','progress-status','length','output-scores','programpp-91f08','classList','click','default-app-id','output-individual','nameList','fixed','\x20ได้','415403943738','\x09\x09\x09\x09','width','bg-gray-100','opacity','อันดับ','output-attributes','addEventListener','tr.row-highlight','DOMContentLoaded','undefined','flex\x20items-center\x20justify-between\x20p-2.5\x20bg-white\x20border\x20border-gray-300\x20rounded-lg','การงานอาชีพ','2719865weRrGc','template','copy-btn-2','admin-close-btn','ปีการศึกษา','find','output-reading','การงานเพิ่ม','admin-user-list-container','hover:bg-green-600','read','2741','วิทย์เพิ่ม','completion-bar','ป้องกันการทุจริต','showTab','ไม่พบชีต\x20‘รายงาน1’\x20ในไฟล์:\x20','คณิต','สังคมศึกษา\x20ศาสนาและวัฒนธรรม','grades','คณิตศาสตร์เพิ่มเติม','subjects','every','เกิดข้อผิดพลาด:\x20','802664PrPtWH','1202308XnHXvE','</td>','scoresLines','คัดลอกล้มเหลว','readAsArrayBuffer','target','เกรดเฉลี่ย','originalIndex','text-blue-600','bg-green-500','copy-btn-5','select','innerHTML','message','ตลอดปี','<td','สังคม',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20data-pass=\x22','พลศึกษา','compLines','trimEnd','คณิตเพิ่ม','SheetNames','<p\x20class=\x22text-red-500\x22>ไม่สามารถโหลดรายชื่อได้:\x20','เกิดข้อผิดพลาด:\x20ไม่ได้เข้าสู่ระบบ','กำลังประมวลผลไฟล์\x20','forEach','trim','.tab-btn','querySelector','\x09\x09\x09\x09\x09\x09\x09','logout-btn','<td>','การงานอาชีพเพิ่มเติม','visual-reading','คำเตือน:\x20การลบผู้ใช้นี้จะลบข้อมูลไฟล์ทั้งหมดที่ผู้ใช้นี้อัปโหลดไว้ด้วย\x20ยืนยันหรือไม่?','add','<p\x20class=\x22text-gray-500\x22>ยังไม่มีผู้ใช้งาน</p>','visual-rm','ไม่พบผู้ใช้ที่ต้องการแก้ไข','admin-add-btn','main-app','ภาษาอังกฤษเพิ่มเติม','สุขศึกษา','</th>','ไม่พบชีต\x20‘Home’\x20ในไฟล์:\x20','store','<tr><td>','active','<p\x20class=\x22text-gray-500\x22>กำลังโหลด...</p>','createElement','programpp-91f08.firebaseapp.com','remove','คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้ที่มีรหัสผ่าน\x20\x22','map','พละ','<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-blue-600\x20mb-2\x20whitespace-nowrap\x22>','font-mono\x20text-sm\x20whitespace-pre\x20px-1','semester-info','closest','admin-error','position','\x22projectId\x22\x20not\x20provided','.tab-content','สุข','Failed\x20to\x20copy\x20text:\x20','Enter','programpp-91f08.firebasestorage.app','appendChild','border-blue-600','name','0.0','attrLines','password','Error\x20loading\x20password\x20list:','keypress','readingLines','extractedData','ภาษาไทย','tab-content-','admin-btn','round',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-blue-600\x20ml-2\x20font-medium\x22>(แบบ:\x20','<tr>','toLowerCase','admin-name-input','1060704gtXIBE','login-error','split','rank','1217526haStwH','Error\x20deleting\x20password:','primary','row-highlight','flex-shrink-0\x20p-3','แก้ไขชื่อสำหรับรหัส\x20\x22','file-upload','progress-container'];_0x34ab=function(){return _0xdf3f43;};return _0x34ab();}function loadDataFromStore(){const _0x283b63=_0x5b0717;if(Object[_0x283b63(0x9f)](processedDataStore)[_0x283b63(0xf4)]===0x0){resultsDiv['classList'][_0x283b63(0x148)]('hidden');return;}const _0x1b3f4c=currentUserTemplate===_0x283b63(0x7f)?SUBJECT_DATA[_0x283b63(0x7f)][_0x283b63(0x120)]:SUBJECT_DATA[_0x283b63(0x96)][_0x283b63(0x120)];let _0x418526=null;const _0x58b185=Math['max'](0x0,...Object[_0x283b63(0x94)](processedDataStore)[_0x283b63(0x15a)](_0x8fe8d0=>_0x8fe8d0[_0x283b63(0x70)]['nameList']&&_0x8fe8d0[_0x283b63(0x70)]['nameList'][_0x283b63(0xf4)]||0x0)),_0x17e02c=_0x1b3f4c[_0x283b63(0x15a)](_0x550d54=>processedDataStore[_0x550d54])['find'](_0x2987a1=>_0x2987a1&&_0x2987a1['extractedData'][_0x283b63(0xfb)][_0x283b63(0xf4)]>0x0);let _0x137896=_0x17e02c?_0x17e02c[_0x283b63(0x70)][_0x283b63(0xfb)]:[];_0x137896['length']<_0x58b185&&(_0x137896=[..._0x137896,...Array(_0x58b185-_0x137896[_0x283b63(0xf4)])['fill']('')]);activeResults=_0x1b3f4c[_0x283b63(0x15a)](_0x41d55f=>{const _0x20508a=_0x283b63,_0x2aaf90=processedDataStore[_0x41d55f];if(_0x2aaf90){if(!_0x418526)_0x418526=_0x2aaf90[_0x20508a(0x90)];const _0x2a9fa3=padExtractedData(_0x2aaf90[_0x20508a(0x70)],_0x58b185);return{'fileIdentifier':_0x41d55f,'extractedData':_0x2a9fa3};}else return{'fileIdentifier':_0x41d55f,'extractedData':createEmptyData(_0x58b185)};}),displaySemesterInfo(_0x418526),mergeAndDisplayResults(activeResults,_0x137896,_0x58b185),resultsDiv[_0x283b63(0xf7)][_0x283b63(0x158)](_0x283b63(0xb5)),showTab(0x1);const _0x4ffda2=_0x1b3f4c[_0x283b63(0x121)](_0x304f70=>processedDataStore[_0x304f70]);_0x4ffda2?completionBar[_0x283b63(0xf7)][_0x283b63(0x158)](_0x283b63(0xb5)):completionBar['classList'][_0x283b63(0x148)](_0x283b63(0xb5));}async function loginUser(){const _0x3611d3=_0x5b0717,_0x586743=passwordInput[_0x3611d3(0xb4)];if(!_0x586743)return;loginError['classList'][_0x3611d3(0x148)]('hidden');try{const _0x367cf5=await getDoc(passwordListDocRef),_0x137fa5=_0x367cf5['data']()?.[_0x3611d3(0x85)]||[],_0x1c7fd5=_0x137fa5[_0x3611d3(0x110)](_0x36a88e=>_0x36a88e['password']===_0x586743);if(_0x1c7fd5){currentUserPassword=_0x586743,currentUserName=_0x1c7fd5[_0x3611d3(0x16a)],currentUserTemplate=_0x1c7fd5[_0x3611d3(0x10c)]||_0x3611d3(0x7f);const _0x12a39d='/artifacts/'+appId+_0x3611d3(0xf2)+currentUserPassword;userDataDocRef=doc(db,_0x12a39d);const _0x32a871=await getDoc(userDataDocRef);_0x32a871[_0x3611d3(0xcb)]()?processedDataStore=_0x32a871[_0x3611d3(0xb3)]()[_0x3611d3(0x152)]||{}:processedDataStore={};loginScreen[_0x3611d3(0xf7)][_0x3611d3(0x148)](_0x3611d3(0xb5)),mainApp[_0x3611d3(0xf7)][_0x3611d3(0x158)]('hidden'),adminBtn['classList'][_0x3611d3(0x148)]('hidden');const _0x220756=document[_0x3611d3(0xc5)](_0x3611d3(0xa5));_0x220756&&(_0x220756[_0x3611d3(0xf1)]=_0x3611d3(0xe5)+currentUserName+_0x3611d3(0xc1)+(currentUserTemplate===_0x3611d3(0x7f)?_0x3611d3(0xe6):_0x3611d3(0xc8))+')'),fileInput[_0x3611d3(0xb4)]='',resetUI(),loadDataFromStore();}else loginError['classList'][_0x3611d3(0x158)]('hidden');}catch(_0x5bafd2){console[_0x3611d3(0xb6)]('Login\x20error:',_0x5bafd2),loginError[_0x3611d3(0x141)](_0x3611d3(0x93))[_0x3611d3(0xf1)]=_0x3611d3(0x122)+_0x5bafd2['message'],loginError[_0x3611d3(0xf7)][_0x3611d3(0x158)](_0x3611d3(0xb5));}}function logoutUser(){const _0x259072=_0x5b0717;currentUserPassword=null,currentUserName=null,currentUserTemplate=null,processedDataStore={},userDataDocRef=null,mainApp[_0x259072(0xf7)][_0x259072(0x148)](_0x259072(0xb5)),loginScreen[_0x259072(0xf7)][_0x259072(0x158)](_0x259072(0xb5)),adminBtn[_0x259072(0xf7)][_0x259072(0x158)]('hidden'),passwordInput[_0x259072(0xb4)]='',loginError[_0x259072(0xf7)][_0x259072(0x148)](_0x259072(0xb5));const _0x2615a2=document[_0x259072(0xc5)]('welcome-message');_0x2615a2&&(_0x2615a2[_0x259072(0xf1)]='');}async function resetAllData(){const _0x588f69=_0x5b0717;if(!userDataDocRef)return;const _0x31883d=confirm('คุณแน่ใจหรือไม่ว่าต้องการล้างข้อมูลที่อัปโหลดทั้งหมด?\x20(ไฟล์ที่อัปโหลดจะหายไป)');if(_0x31883d){processedDataStore={};try{await setDoc(userDataDocRef,{'store':{}});}catch(_0x5cfedb){showError(_0x588f69(0xd1)+_0x5cfedb['message']);}resetUI(),resultsDiv[_0x588f69(0xf7)][_0x588f69(0x148)](_0x588f69(0xb5)),completionBar[_0x588f69(0xf7)]['add'](_0x588f69(0xb5)),fileInput[_0x588f69(0xb4)]='';}}function promptAdminAccess(){const _0xa8bb13=_0x5b0717,_0x3353d9=prompt('กรุณาใส่รหัสผ่าน\x20Admin:');if(_0x3353d9===_0xa8bb13(0x116))loginScreen[_0xa8bb13(0xf7)][_0xa8bb13(0x148)]('hidden'),adminPanel[_0xa8bb13(0xf7)][_0xa8bb13(0x158)]('hidden'),loadAdminPasswordList();else _0x3353d9&&alert(_0xa8bb13(0xd9));}function closeAdminPanel(){const _0x479815=_0x5b0717;adminPanel['classList']['add'](_0x479815(0xb5)),loginScreen[_0x479815(0xf7)][_0x479815(0x158)](_0x479815(0xb5)),adminError['classList']['add'](_0x479815(0xb5));}async function loadAdminPasswordList(){const _0x49dfc3=_0x5b0717;adminUserListContainer[_0x49dfc3(0x130)]=_0x49dfc3(0x155);try{const _0x313876=await getDoc(passwordListDocRef),_0x4ac7c0=_0x313876[_0x49dfc3(0xb3)]()?.[_0x49dfc3(0x85)]||[];adminUserListContainer[_0x49dfc3(0x130)]='';if(_0x4ac7c0[_0x49dfc3(0xf4)]===0x0){adminUserListContainer[_0x49dfc3(0x130)]=_0x49dfc3(0x149);return;}_0x4ac7c0[_0x49dfc3(0x13e)](_0x2053d7=>{const _0x21df64=_0x49dfc3,_0x315dad=document[_0x21df64(0x156)](_0x21df64(0xec));_0x315dad['className']=_0x21df64(0x109);const _0x36267d=_0x2053d7[_0x21df64(0x10c)]===_0x21df64(0x96)?_0x21df64(0xc8):'ประถม';_0x315dad[_0x21df64(0x130)]=_0x21df64(0x9e)+_0x2053d7['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20text-gray-500\x20ml-2\x22>(รหัส:\x20'+_0x2053d7[_0x21df64(0x16d)]+_0x21df64(0x75)+_0x36267d+_0x21df64(0x135)+_0x2053d7['password']+_0x21df64(0xca)+_0x2053d7['password']+_0x21df64(0xa9),adminUserListContainer['appendChild'](_0x315dad);}),document[_0x49dfc3(0xe1)]('.admin-delete-btn')[_0x49dfc3(0x13e)](_0x26c5e6=>{const _0x246b7c=_0x49dfc3;_0x26c5e6[_0x246b7c(0x105)](_0x246b7c(0xf8),()=>adminDeletePassword(_0x26c5e6['dataset'][_0x246b7c(0xe3)]));}),document['querySelectorAll']('.admin-edit-btn')['forEach'](_0x402756=>{const _0x4d422b=_0x49dfc3;_0x402756[_0x4d422b(0x105)](_0x4d422b(0xf8),()=>adminEditUser(_0x402756[_0x4d422b(0xc3)]['pass']));});}catch(_0xa45c8c){console[_0x49dfc3(0xb6)](_0x49dfc3(0x16e),_0xa45c8c),adminUserListContainer['innerHTML']=_0x49dfc3(0x13b)+_0xa45c8c[_0x49dfc3(0x131)]+_0x49dfc3(0xbe);}}async function adminAddPassword(){const _0x33647f=_0x5b0717,_0x40a1fe=adminNameInput[_0x33647f(0xb4)]['trim'](),_0x15d5e7=adminPassInput['value']['trim'](),_0x5a46a4=adminTemplateSelect[_0x33647f(0xb4)];adminError[_0x33647f(0xf7)]['add']('hidden');if(!_0x40a1fe||!_0x15d5e7){adminError[_0x33647f(0xf1)]=_0x33647f(0xac),adminError[_0x33647f(0xf7)][_0x33647f(0x158)](_0x33647f(0xb5));return;}try{const _0x2944d3=await getDoc(passwordListDocRef),_0x304fa7=_0x2944d3['data']()?.[_0x33647f(0x85)]||[];if(_0x304fa7[_0x33647f(0xed)](_0x20ed19=>_0x20ed19['password']===_0x15d5e7)){adminError[_0x33647f(0xf1)]=_0x33647f(0xa1),adminError[_0x33647f(0xf7)][_0x33647f(0x158)](_0x33647f(0xb5));return;}const _0x1dcbc0=[..._0x304fa7,{'name':_0x40a1fe,'password':_0x15d5e7,'template':_0x5a46a4}];await setDoc(passwordListDocRef,{'passwords':_0x1dcbc0}),adminNameInput[_0x33647f(0xb4)]='',adminPassInput[_0x33647f(0xb4)]='',await loadAdminPasswordList();}catch(_0x2becba){console[_0x33647f(0xb6)](_0x33647f(0xd4),_0x2becba),adminError[_0x33647f(0xf1)]=_0x33647f(0x122)+_0x2becba[_0x33647f(0x131)],adminError[_0x33647f(0xf7)]['remove'](_0x33647f(0xb5));}}async function adminEditUser(_0x45a5a3){const _0x4f9f11=_0x5b0717;try{const _0x1a9113=await getDoc(passwordListDocRef),_0xa41126=_0x1a9113[_0x4f9f11(0xb3)]()?.[_0x4f9f11(0x85)]||[],_0x24f254=_0xa41126[_0x4f9f11(0x110)](_0x38dcb4=>_0x38dcb4[_0x4f9f11(0x16d)]===_0x45a5a3);if(!_0x24f254){alert(_0x4f9f11(0x14b));return;}const _0x3e16de=prompt(_0x4f9f11(0x82)+_0x24f254[_0x4f9f11(0x16d)]+'\x22\x20(กด\x20OK\x20เพื่อคงชื่อเดิม):',_0x24f254[_0x4f9f11(0x16a)]);if(_0x3e16de===null)return;const _0x49a5d1=_0x24f254['template']||_0x4f9f11(0x7f),_0xb7d5ca=prompt('แก้ไข\x20\x22แบบ\x22\x20สำหรับ\x20'+_0x24f254[_0x4f9f11(0x16a)]+'\x20(พิมพ์\x20\x27primary\x27\x20หรือ\x20\x27secondary\x27):',_0x49a5d1);if(_0xb7d5ca===null)return;const _0x179bd7=_0x3e16de[_0x4f9f11(0x13f)]()===''?_0x24f254[_0x4f9f11(0x16a)]:_0x3e16de[_0x4f9f11(0x13f)](),_0x345220=_0xb7d5ca[_0x4f9f11(0x13f)]()[_0x4f9f11(0x77)]()===_0x4f9f11(0x96)?'secondary':_0x4f9f11(0x7f);if(_0x345220!==_0x49a5d1){if(confirm('คุณได้เปลี่ยน\x20\x22แบบ\x22\x20ของผู้ใช้\x20'+_0x179bd7+_0x4f9f11(0xda))){const _0x45920f='/artifacts/'+appId+'/public/data/user_data/'+_0x45a5a3,_0x2e5fd7=doc(db,_0x45920f);await setDoc(_0x2e5fd7,{'store':{}});}else return;}const _0x46c33d=_0xa41126['map'](_0x1205a8=>{const _0x3fa04b=_0x4f9f11;if(_0x1205a8[_0x3fa04b(0x16d)]===_0x45a5a3)return{..._0x1205a8,'name':_0x179bd7,'template':_0x345220};return _0x1205a8;});await setDoc(passwordListDocRef,{'passwords':_0x46c33d}),await loadAdminPasswordList();}catch(_0x4899c2){console[_0x4f9f11(0xb6)](_0x4f9f11(0xdd),_0x4899c2),adminError['textContent']=_0x4f9f11(0x122)+_0x4899c2[_0x4f9f11(0x131)],adminError[_0x4f9f11(0xf7)][_0x4f9f11(0x158)](_0x4f9f11(0xb5));}}function _0x1810(_0x2b87a6,_0x4709fe){const _0x34ab44=_0x34ab();return _0x1810=function(_0x1810c0,_0x1149c6){_0x1810c0=_0x1810c0-0x6f;let _0x54a6be=_0x34ab44[_0x1810c0];return _0x54a6be;},_0x1810(_0x2b87a6,_0x4709fe);}async function adminDeletePassword(_0x52db19){const _0x19804c=_0x5b0717;if(!confirm(_0x19804c(0x159)+_0x52db19+'\x22?'))return;if(!confirm(_0x19804c(0x147)))return;try{const _0x35f2a6=_0x19804c(0xe7)+appId+_0x19804c(0xf2)+_0x52db19,_0x47805e=doc(db,_0x35f2a6);await deleteDoc(_0x47805e);const _0x1df2fe=await getDoc(passwordListDocRef),_0x2281ab=_0x1df2fe['data']()?.[_0x19804c(0x85)]||[],_0x55ec34=_0x2281ab['filter'](_0x444b47=>_0x444b47[_0x19804c(0x16d)]!==_0x52db19);await setDoc(passwordListDocRef,{'passwords':_0x55ec34}),await loadAdminPasswordList();}catch(_0x17aaa8){console[_0x19804c(0xb6)](_0x19804c(0x7e),_0x17aaa8),adminError[_0x19804c(0xf1)]='เกิดข้อผิดพลาด:\x20'+_0x17aaa8[_0x19804c(0x131)],adminError['classList'][_0x19804c(0x158)](_0x19804c(0xb5));}}function findLastStudentRowIndex(_0x27a889,_0x3e41ed,_0x394e83,_0x59a279){const _0x2af7cf=_0x5b0717;for(let _0x544b98=_0x394e83;_0x544b98>=_0x3e41ed;_0x544b98--){const _0x5e0d73=getCellValue(_0x27a889,_0x544b98,_0x59a279);if(_0x5e0d73&&_0x5e0d73[_0x2af7cf(0x13f)]()!=='')return _0x544b98;}return _0x3e41ed-0x1;}function createEmptyData(_0x5e67bc){const _0x23bee2=_0x5b0717;if(_0x5e67bc<0x0)_0x5e67bc=0x0;const _0x470827=_0x5e67bc+0x1,_0x216856=Array(_0x5e67bc)[_0x23bee2(0xd3)](''),_0x30a404=['\x09\x09',...Array(_0x5e67bc)['fill']('\x09\x09')],_0x4cf19f=Array(_0x5e67bc)[_0x23bee2(0xd3)](''),_0x4e769a=currentUserTemplate===_0x23bee2(0x7f)?_0x23bee2(0xd6):_0x23bee2(0xa7),_0x531b40=currentUserTemplate===_0x23bee2(0x7f)?'\x09\x09':'',_0x32e9f2=[_0x4e769a,...Array(_0x5e67bc)[_0x23bee2(0xd3)](_0x531b40)],_0x333f7e=[Array(0x8)['fill'](_0x23bee2(0xa7))['join']('\x09'),...Array(_0x5e67bc)[_0x23bee2(0xd3)](_0x23bee2(0x142))],_0x23afa8=[Array(0x5)[_0x23bee2(0xd3)](_0x23bee2(0xa7))['join']('\x09'),...Array(_0x5e67bc)[_0x23bee2(0xd3)]('\x09\x09\x09\x09')];return{'scoresLines':_0x30a404,'rmLines':_0x4cf19f,'readingLines':_0x32e9f2,'attrLines':_0x333f7e,'compLines':_0x23afa8,'nameList':_0x216856,'numStudentRows':_0x5e67bc};}function padExtractedData(_0x2c02e2,_0x4d7ea){const _0x4f2beb=_0x5b0717,_0x1ae019=_0x2c02e2['nameList']&&_0x2c02e2['nameList'][_0x4f2beb(0xf4)]||0x0;if(_0x1ae019>=_0x4d7ea)return _0x2c02e2;const _0x1a75f9=_0x4d7ea-_0x1ae019;if(_0x1a75f9<=0x0)return _0x2c02e2;const _0x4a317d=currentUserTemplate===_0x4f2beb(0x7f)?'\x09\x09':'';return{'nameList':[..._0x2c02e2[_0x4f2beb(0xfb)],...Array(_0x1a75f9)['fill']('')],'scoresLines':[..._0x2c02e2[_0x4f2beb(0x126)],...Array(_0x1a75f9)[_0x4f2beb(0xd3)]('\x09\x09')],'rmLines':[..._0x2c02e2[_0x4f2beb(0x97)],...Array(_0x1a75f9)['fill']('')],'readingLines':[..._0x2c02e2[_0x4f2beb(0x6f)],...Array(_0x1a75f9)[_0x4f2beb(0xd3)](_0x4a317d)],'attrLines':[..._0x2c02e2[_0x4f2beb(0x16c)],...Array(_0x1a75f9)[_0x4f2beb(0xd3)](_0x4f2beb(0x142))],'compLines':[..._0x2c02e2['compLines'],...Array(_0x1a75f9)[_0x4f2beb(0xd3)](_0x4f2beb(0xff))],'numStudentRows':_0x4d7ea};}async function handleFile(_0x31931c){const _0x1c6422=_0x5b0717;if(!currentUserTemplate||!userDataDocRef){showError(_0x1c6422(0x13c));return;}const _0x149bc3=_0x31931c[_0x1c6422(0x129)][_0x1c6422(0xe4)];if(!_0x149bc3||_0x149bc3['length']===0x0)return;const _0x55ebf=_0x149bc3[_0x1c6422(0xf4)];resetUI(),resultsDiv[_0x1c6422(0xf7)]['add'](_0x1c6422(0xb5)),errorDiv[_0x1c6422(0xf7)]['add'](_0x1c6422(0xb5)),progressContainer[_0x1c6422(0xf7)][_0x1c6422(0x158)](_0x1c6422(0xb5)),progressStatus[_0x1c6422(0xf7)][_0x1c6422(0x158)](_0x1c6422(0xb5)),progressBar[_0x1c6422(0xc7)][_0x1c6422(0x100)]='0%',progressText[_0x1c6422(0xf1)]='0%',progressStatus[_0x1c6422(0xf1)]='กำลังเตรียมไฟล์...\x20(0/'+_0x55ebf+')';const _0x9b878b=currentUserTemplate===_0x1c6422(0x7f)?SUBJECT_DATA[_0x1c6422(0x7f)][_0x1c6422(0x120)]:SUBJECT_DATA['secondary'][_0x1c6422(0x120)];let _0x4ffaa9=[];try{for(let _0x3ad483=0x0;_0x3ad483<_0x55ebf;_0x3ad483++){const _0x537904=_0x149bc3[_0x3ad483];progressStatus[_0x1c6422(0xf1)]=_0x1c6422(0x13d)+(_0x3ad483+0x1)+_0x1c6422(0xcc)+_0x55ebf+':\x20'+_0x537904[_0x1c6422(0x16a)];const _0x127789=await new Promise((_0x1648cb,_0x5976ae)=>{const _0x12c7df=_0x1c6422,_0x208fab=new FileReader();_0x208fab['onload']=_0x4a4b45=>{const _0x3c6c85=_0x1810;try{const _0x4e1464=new Uint8Array(_0x4a4b45[_0x3c6c85(0x129)][_0x3c6c85(0x9c)]),_0x430671=XLSX[_0x3c6c85(0x115)](_0x4e1464,{'type':_0x3c6c85(0xa0)}),_0x2b205b='รายงาน1',_0x3d68b2=_0x3c6c85(0x95);if(!_0x430671[_0x3c6c85(0x13a)][_0x3c6c85(0x86)](_0x2b205b))_0x5976ae(_0x3c6c85(0x11b)+_0x537904[_0x3c6c85(0x16a)]);if(!_0x430671[_0x3c6c85(0x13a)][_0x3c6c85(0x86)](_0x3d68b2))_0x5976ae(_0x3c6c85(0x151)+_0x537904[_0x3c6c85(0x16a)]);const _0x3a53db=_0x430671[_0x3c6c85(0xb0)][_0x2b205b],_0x5d52aa=_0x430671[_0x3c6c85(0xb0)][_0x3d68b2];let _0x236bad=getCellValue(_0x5d52aa,0xa,0x2)||_0x537904[_0x3c6c85(0x16a)];const _0x4c490a={'semesterLabel':getCellValue(_0x5d52aa,0x3,0x4),'yearLabel':getCellValue(_0x5d52aa,0x4,0x4),'semesterValue':getCellValue(_0x5d52aa,0x3,0x5),'yearValue':getCellValue(_0x5d52aa,0x4,0x5)};if(_0x9b878b['includes'](_0x236bad)){const _0x307100=extractDataFromSheet(_0x3a53db,currentUserTemplate);processedDataStore[_0x236bad]={'extractedData':_0x307100,'semesterInfo':_0x4c490a},_0x1648cb({'fileIdentifier':_0x236bad,'extractedData':_0x307100,'semesterInfo':_0x4c490a,'ignored':![]});}else _0x1648cb({'fileIdentifier':_0x236bad,'extractedData':null,'semesterInfo':_0x4c490a,'ignored':!![]});}catch(_0xbb9614){_0x5976ae(_0x3c6c85(0xb9)+_0x537904[_0x3c6c85(0x16a)]+':\x20'+_0xbb9614[_0x3c6c85(0x131)]);}},_0x208fab[_0x12c7df(0x98)]=()=>_0x5976ae('ไม่สามารถอ่านไฟล์\x20'+_0x537904['name']+_0x12c7df(0xfd)),_0x208fab[_0x12c7df(0x128)](_0x537904);});!_0x127789['ignored']&&_0x4ffaa9[_0x1c6422(0x8b)](_0x127789);const _0x338b05=Math[_0x1c6422(0x74)]((_0x3ad483+0x1)/_0x55ebf*0x64);progressBar[_0x1c6422(0xc7)][_0x1c6422(0x100)]=_0x338b05+'%',progressText[_0x1c6422(0xf1)]=_0x338b05+'%';}if(_0x4ffaa9['length']>0x0)displaySemesterInfo(_0x4ffaa9[0x0]['semesterInfo']);else{if(Object[_0x1c6422(0x9f)](processedDataStore)[_0x1c6422(0xf4)]>0x0){const _0x47b8f5=_0x9b878b[_0x1c6422(0x110)](_0x14972b=>processedDataStore[_0x14972b]);_0x47b8f5&&displaySemesterInfo(processedDataStore[_0x47b8f5]['semesterInfo']);}else displaySemesterInfo(null);}progressStatus[_0x1c6422(0xf1)]=_0x1c6422(0xd2);const _0x1ee443=Math[_0x1c6422(0xa2)](0x0,...Object[_0x1c6422(0x94)](processedDataStore)['map'](_0x40027e=>_0x40027e[_0x1c6422(0x70)][_0x1c6422(0xfb)]&&_0x40027e[_0x1c6422(0x70)][_0x1c6422(0xfb)][_0x1c6422(0xf4)]||0x0)),_0x2acc2c=_0x9b878b['map'](_0x3aab5b=>processedDataStore[_0x3aab5b])[_0x1c6422(0x110)](_0x37a312=>_0x37a312&&_0x37a312['extractedData'][_0x1c6422(0xfb)][_0x1c6422(0xf4)]>0x0);let _0x4b5b3f=_0x2acc2c?_0x2acc2c[_0x1c6422(0x70)][_0x1c6422(0xfb)]:[];_0x4b5b3f[_0x1c6422(0xf4)]<_0x1ee443&&(_0x4b5b3f=[..._0x4b5b3f,...Array(_0x1ee443-_0x4b5b3f['length'])[_0x1c6422(0xd3)]('')]);activeResults=_0x9b878b[_0x1c6422(0x15a)](_0x5e8692=>{const _0x28627f=_0x1c6422,_0x304b80=processedDataStore[_0x5e8692];if(_0x304b80){const _0x1a23d9=padExtractedData(_0x304b80[_0x28627f(0x70)],_0x1ee443);return{'fileIdentifier':_0x5e8692,'extractedData':_0x1a23d9};}else return{'fileIdentifier':_0x5e8692,'extractedData':createEmptyData(_0x1ee443)};});try{await setDoc(userDataDocRef,{'store':processedDataStore});}catch(_0x32b3d4){showError(_0x1c6422(0xc6)+_0x32b3d4[_0x1c6422(0x131)]);}mergeAndDisplayResults(activeResults,_0x4b5b3f,_0x1ee443),resultsDiv[_0x1c6422(0xf7)][_0x1c6422(0x158)]('hidden'),showTab(0x1),progressStatus[_0x1c6422(0xf1)]=_0x1c6422(0xde),setTimeout(()=>{const _0x286918=_0x1c6422;progressContainer[_0x286918(0xf7)][_0x286918(0x148)]('hidden'),progressStatus[_0x286918(0xf7)][_0x286918(0x148)](_0x286918(0xb5));},0x5dc);const _0x28451f=_0x9b878b[_0x1c6422(0x121)](_0x2bd60a=>processedDataStore[_0x2bd60a]);_0x28451f?completionBar['classList']['remove']('hidden'):completionBar[_0x1c6422(0xf7)][_0x1c6422(0x148)](_0x1c6422(0xb5));}catch(_0x4ecf16){showError(_0x4ecf16),fileInput[_0x1c6422(0xb4)]='',progressContainer[_0x1c6422(0xf7)][_0x1c6422(0x148)](_0x1c6422(0xb5)),progressStatus[_0x1c6422(0xf7)][_0x1c6422(0x148)](_0x1c6422(0xb5));}}function resetUI(){const _0x3c5531=_0x5b0717;outputScores[_0x3c5531(0xf1)]='',outputReading[_0x3c5531(0xf1)]='',outputRm['textContent']='',outputAttributes[_0x3c5531(0xf1)]='',outputCompetency[_0x3c5531(0xf1)]='',visualScores[_0x3c5531(0x130)]='',visualReading[_0x3c5531(0x130)]='',visualRm[_0x3c5531(0x130)]='',visualAttributes[_0x3c5531(0x130)]='',visualCompetency[_0x3c5531(0x130)]='';if(outputIndividual)outputIndividual[_0x3c5531(0xf1)]='';if(visualIndividual)visualIndividual[_0x3c5531(0x130)]='';if(semesterInfoEl)semesterInfoEl[_0x3c5531(0xf1)]='';if(completionBar)completionBar[_0x3c5531(0xf7)][_0x3c5531(0x148)](_0x3c5531(0xb5));[copyBtn1,copyBtn2,copyBtn3,copyBtn4,copyBtn5,copyBtn6]['forEach'](_0x4e7846=>{const _0x2a0017=_0x3c5531;_0x4e7846&&(_0x4e7846['textContent']=_0x2a0017(0xd8),_0x4e7846[_0x2a0017(0xf7)][_0x2a0017(0x158)](_0x2a0017(0xa3),'bg-red-500'),_0x4e7846[_0x2a0017(0xf7)][_0x2a0017(0x148)](_0x2a0017(0x12d),_0x2a0017(0x114)));});if(progressContainer)progressContainer[_0x3c5531(0xf7)][_0x3c5531(0x148)](_0x3c5531(0xb5));if(progressStatus)progressStatus[_0x3c5531(0xf7)]['add'](_0x3c5531(0xb5));}function showError(_0x3922ce){const _0xb0ae55=_0x5b0717;errorText[_0xb0ae55(0xf1)]=_0x3922ce,errorDiv['classList'][_0xb0ae55(0x158)](_0xb0ae55(0xb5));}function getCellValue(_0x2e4fd6,_0x489b81,_0x63acf4){const _0x11c449=_0x5b0717,_0x29c32b=_0x2e4fd6[XLSX[_0x11c449(0x8d)]['encode_cell']({'r':_0x489b81,'c':_0x63acf4})];if(!_0x29c32b)return'';return _0x29c32b['w']!==null&&_0x29c32b['w']!==undefined?String(_0x29c32b['w']):_0x29c32b['v']!==null&&_0x29c32b['v']!==undefined?String(_0x29c32b['v']):'';}function displaySemesterInfo(_0x4aae2d){const _0x5cb742=_0x5b0717;if(!semesterInfoEl)return;if(!_0x4aae2d){semesterInfoEl[_0x5cb742(0xf1)]='';return;}const {semesterLabel:_0x3edfa8,yearLabel:_0x44669c,semesterValue:_0x46150b,yearValue:_0x50644c}=_0x4aae2d;let _0x41d561='';_0x46150b&&_0x50644c&&(_0x46150b['includes'](_0x5cb742(0x132))?_0x41d561=_0x5cb742(0xad)+_0x50644c:_0x41d561=(_0x3edfa8||_0x5cb742(0xcd))+'\x20'+_0x46150b+'\x20'+(_0x44669c||_0x5cb742(0x10f))+'\x20'+_0x50644c),semesterInfoEl[_0x5cb742(0xf1)]=_0x41d561;}function extractDataFromSheet(_0x22719f,_0x21f023){const _0x2f800e=_0x5b0717,_0x5dc337=findLastStudentRowIndex(_0x22719f,0x6,0x37,0x3),_0x1fff03=_0x5dc337<0x6?0x0:_0x5dc337-0x6+0x1;let _0x2e7ddc=[],_0x5d0494=[],_0x2feec9=[],_0x562dd2=[],_0x695804=[],_0x9bdbf1=[];if(_0x1fff03>0x0){for(let _0x1c8d75=0x6;_0x1c8d75<=_0x5dc337;_0x1c8d75++){_0x2e7ddc[_0x2f800e(0x8b)](getCellValue(_0x22719f,_0x1c8d75,0x3));}for(let _0x5791f3=0x5;_0x5791f3<=_0x5dc337;_0x5791f3++){_0x5d0494[_0x2f800e(0x8b)]([getCellValue(_0x22719f,_0x5791f3,0x4),getCellValue(_0x22719f,_0x5791f3,0x5),getCellValue(_0x22719f,_0x5791f3,0x6)]['join']('\x09'));}for(let _0x4bb13a=0x6;_0x4bb13a<=_0x5dc337;_0x4bb13a++){let _0xb37f50=getCellValue(_0x22719f,_0x4bb13a,0x7)[_0x2f800e(0x13f)]();_0x2feec9['push'](_0xb37f50==='ร'||_0xb37f50==='มส'?_0xb37f50:'');}if(_0x21f023==='primary'){_0x562dd2['push']('100\x09100\x09100');for(let _0x722137=0x6;_0x722137<=_0x5dc337;_0x722137++){_0x562dd2[_0x2f800e(0x8b)]([getCellValue(_0x22719f,_0x722137,0x8),getCellValue(_0x22719f,_0x722137,0x9),getCellValue(_0x22719f,_0x722137,0xa)][_0x2f800e(0xf0)]('\x09'));}}else{_0x562dd2[_0x2f800e(0x8b)](_0x2f800e(0xa7));for(let _0x18a6a3=0x6;_0x18a6a3<=_0x5dc337;_0x18a6a3++){_0x562dd2[_0x2f800e(0x8b)](getCellValue(_0x22719f,_0x18a6a3,0xb));}}let _0x19d56c=[];for(let _0x491b35=0xd;_0x491b35<=0x14;_0x491b35++)_0x19d56c['push']('100');_0x695804[_0x2f800e(0x8b)](_0x19d56c[_0x2f800e(0xf0)]('\x09'));for(let _0x1bdd84=0x6;_0x1bdd84<=_0x5dc337;_0x1bdd84++){let _0x450745=[];for(let _0x2d4bad=0xd;_0x2d4bad<=0x14;_0x2d4bad++)_0x450745[_0x2f800e(0x8b)](getCellValue(_0x22719f,_0x1bdd84,_0x2d4bad));_0x695804[_0x2f800e(0x8b)](_0x450745[_0x2f800e(0xf0)]('\x09'));}let _0xe416a=[];for(let _0xc1bf82=0x19;_0xc1bf82<=0x1d;_0xc1bf82++)_0xe416a[_0x2f800e(0x8b)](_0x2f800e(0xa7));_0x9bdbf1[_0x2f800e(0x8b)](_0xe416a['join']('\x09'));for(let _0x1f7668=0x6;_0x1f7668<=_0x5dc337;_0x1f7668++){let _0x496c33=[];for(let _0x519ce6=0x19;_0x519ce6<=0x1d;_0x519ce6++)_0x496c33[_0x2f800e(0x8b)](getCellValue(_0x22719f,_0x1f7668,_0x519ce6));_0x9bdbf1['push'](_0x496c33['join']('\x09'));}}else{_0x5d0494[_0x2f800e(0x8b)]('\x09\x09'),_0x562dd2['push'](_0x21f023===_0x2f800e(0x7f)?_0x2f800e(0xd6):_0x2f800e(0xa7));let _0x781d40=[];for(let _0x5d9f87=0xd;_0x5d9f87<=0x14;_0x5d9f87++)_0x781d40[_0x2f800e(0x8b)](_0x2f800e(0xa7));_0x695804[_0x2f800e(0x8b)](_0x781d40[_0x2f800e(0xf0)]('\x09'));let _0x330844=[];for(let _0x1223db=0x19;_0x1223db<=0x1d;_0x1223db++)_0x330844[_0x2f800e(0x8b)](_0x2f800e(0xa7));_0x9bdbf1[_0x2f800e(0x8b)](_0x330844[_0x2f800e(0xf0)]('\x09'));}return{'scoresLines':_0x5d0494,'rmLines':_0x2feec9,'readingLines':_0x562dd2,'attrLines':_0x695804,'compLines':_0x9bdbf1,'nameList':_0x2e7ddc,'numStudentRows':_0x1fff03};}function buildVisualBlock(_0x5aae92,_0x228624,_0x5d9f49,_0x1583ed,_0x5b35b3){const _0x29159a=_0x5b0717;_0x5d9f49[_0x29159a(0x130)]='';const _0x57ba89=_0x1583ed,_0x6c56c2=document['createElement']('div');_0x6c56c2[_0x29159a(0xa6)]=_0x29159a(0xce),_0x6c56c2[_0x29159a(0x130)]='<div\x20class=\x22text-center\x20font-bold\x20text-sm\x20text-gray-700\x20mb-2\x20whitespace-nowrap\x22>ชื่อ-สกุล</div>';const _0x3c7060=document[_0x29159a(0x156)](_0x29159a(0xec));_0x6c56c2[_0x29159a(0x168)](_0x3c7060);let _0x241b92=[..._0x57ba89];if(_0x228624!==_0x29159a(0x97)&&_0x241b92[_0x29159a(0xf4)]>0x0)_0x241b92[_0x29159a(0xab)]('');else _0x228624!==_0x29159a(0x97)&&_0x241b92[_0x29159a(0xf4)]===0x0&&_0x241b92[_0x29159a(0xab)]('');_0x241b92[_0x29159a(0x13e)]((_0x1987a9,_0x124683)=>{const _0x3e2f67=_0x29159a,_0x2ef61f=document['createElement']('div');_0x2ef61f[_0x3e2f67(0xa6)]='font-mono\x20text-sm\x20whitespace-pre\x20text-gray-600\x20px-1';if(_0x124683%0x2!==0x0)_0x2ef61f[_0x3e2f67(0xf7)]['add'](_0x3e2f67(0x101));_0x2ef61f[_0x3e2f67(0xf1)]=_0x1987a9||'\u00a0',_0x3c7060['appendChild'](_0x2ef61f);}),_0x5d9f49[_0x29159a(0x168)](_0x6c56c2),_0x5aae92[_0x29159a(0x13e)]((_0x2b61b7,_0x495d48)=>{const _0x336c01=_0x29159a,{fileIdentifier:_0x33e509,extractedData:_0x16ff5e}=_0x2b61b7,_0x15e1b5=document[_0x336c01(0x156)](_0x336c01(0xec));_0x15e1b5[_0x336c01(0xa6)]=_0x336c01(0x81);if(_0x495d48<_0x5aae92['length']-0x1)_0x15e1b5[_0x336c01(0xa6)]+=_0x336c01(0x88);_0x15e1b5['innerHTML']=_0x336c01(0x15c)+_0x33e509+_0x336c01(0xc0);const _0x2e034f=document[_0x336c01(0x156)](_0x336c01(0xec));_0x15e1b5['appendChild'](_0x2e034f);const _0x56d206=_0x16ff5e&&_0x16ff5e[_0x228624]?_0x16ff5e[_0x228624]:createEmptyData(_0x5b35b3)[_0x228624];_0x56d206[_0x336c01(0x13e)]((_0x3fa759,_0x57d132)=>{const _0x2a7184=_0x336c01,_0x57db5b=document[_0x2a7184(0x156)](_0x2a7184(0xec));_0x57db5b[_0x2a7184(0xa6)]=_0x2a7184(0x15d);if(_0x57d132%0x2!==0x0)_0x57db5b[_0x2a7184(0xf7)][_0x2a7184(0x148)]('bg-gray-100');_0x57db5b['textContent']=_0x3fa759||'\u00a0',_0x2e034f[_0x2a7184(0x168)](_0x57db5b);}),_0x5d9f49[_0x336c01(0x168)](_0x15e1b5);});}function mergeAndDisplayResults(_0x330061,_0x5affe5,_0x3b145d){const _0x566f6b=_0x5b0717,_0x275c8c=(_0x529a9a,_0x2091be)=>{const _0x5d37fb=_0x1810;let _0x118518='';for(let _0x18aa22=0x0;_0x18aa22<_0x2091be;_0x18aa22++){let _0x35e28a=[];for(const _0x866d7d of _0x330061){const _0x4c287b=_0x866d7d[_0x5d37fb(0x70)]&&_0x866d7d[_0x5d37fb(0x70)][_0x529a9a]&&_0x866d7d['extractedData'][_0x529a9a][_0x18aa22]!==undefined?_0x866d7d[_0x5d37fb(0x70)][_0x529a9a][_0x18aa22]:createEmptyData(_0x3b145d)[_0x529a9a][_0x18aa22];_0x529a9a===_0x5d37fb(0x6f)&&currentUserTemplate!==_0x5d37fb(0x7f)?_0x35e28a[_0x5d37fb(0x8b)](_0x4c287b+'\x09\x09'):_0x35e28a[_0x5d37fb(0x8b)](_0x4c287b);}_0x118518+=_0x35e28a[_0x5d37fb(0xf0)]('\x09')+'\x0a';}return _0x118518[_0x5d37fb(0x138)]();},_0x317d6a={'scoresLines':_0x3b145d+0x1,'rmLines':_0x3b145d,'readingLines':_0x3b145d+0x1,'attrLines':_0x3b145d+0x1,'compLines':_0x3b145d+0x1};outputScores[_0x566f6b(0xf1)]=_0x275c8c(_0x566f6b(0x126),_0x317d6a[_0x566f6b(0x126)]),outputRm['textContent']=_0x275c8c(_0x566f6b(0x97),_0x317d6a[_0x566f6b(0x97)]),outputReading['textContent']=_0x275c8c(_0x566f6b(0x6f),_0x317d6a[_0x566f6b(0x6f)]),outputAttributes['textContent']=_0x275c8c('attrLines',_0x317d6a[_0x566f6b(0x16c)]),outputCompetency[_0x566f6b(0xf1)]=_0x275c8c(_0x566f6b(0x137),_0x317d6a['compLines']),buildVisualBlock(_0x330061,_0x566f6b(0x126),visualScores,_0x5affe5,_0x3b145d),buildVisualBlock(_0x330061,_0x566f6b(0x97),visualRm,_0x5affe5,_0x3b145d),buildVisualBlock(_0x330061,_0x566f6b(0x6f),visualReading,_0x5affe5,_0x3b145d),buildVisualBlock(_0x330061,'attrLines',visualAttributes,_0x5affe5,_0x3b145d),buildVisualBlock(_0x330061,'compLines',visualCompetency,_0x5affe5,_0x3b145d),calculateAndDisplayGPA(_0x330061,_0x5affe5,_0x3b145d);}function copyToClipboard(_0x1b9aaa,_0x52601d){const _0x250418=_0x5b0717,_0x15b45b=document[_0x250418(0x156)]('textarea');_0x15b45b['value']=_0x1b9aaa,_0x15b45b[_0x250418(0xc7)][_0x250418(0x161)]=_0x250418(0xfc),_0x15b45b[_0x250418(0xc7)][_0x250418(0x102)]=0x0,document['body'][_0x250418(0x168)](_0x15b45b),_0x15b45b[_0x250418(0x12f)]();try{document['execCommand'](_0x250418(0xdc));const _0x3fb02e=_0x52601d[_0x250418(0xf1)];_0x52601d[_0x250418(0xf1)]=_0x250418(0xc2),_0x52601d[_0x250418(0xf7)][_0x250418(0x158)](_0x250418(0x12d),_0x250418(0x114)),_0x52601d[_0x250418(0xf7)][_0x250418(0x148)](_0x250418(0xa3)),setTimeout(()=>{const _0x2e2b52=_0x250418;_0x52601d[_0x2e2b52(0xf1)]=_0x3fb02e,_0x52601d[_0x2e2b52(0xf7)][_0x2e2b52(0x158)]('bg-blue-500'),_0x52601d[_0x2e2b52(0xf7)]['add'](_0x2e2b52(0x12d),_0x2e2b52(0x114));},0x5dc);}catch(_0x23978c){console[_0x250418(0xb6)](_0x250418(0x165),_0x23978c);const _0x306501=_0x52601d[_0x250418(0xf1)];_0x52601d[_0x250418(0xf1)]=_0x250418(0x127),_0x52601d['classList'][_0x250418(0x158)](_0x250418(0x12d),_0x250418(0x114)),_0x52601d[_0x250418(0xf7)][_0x250418(0x148)](_0x250418(0xdb)),setTimeout(()=>{const _0x26dccc=_0x250418;_0x52601d['textContent']=_0x306501,_0x52601d[_0x26dccc(0xf7)]['remove'](_0x26dccc(0xdb)),_0x52601d[_0x26dccc(0xf7)][_0x26dccc(0x148)](_0x26dccc(0x12d),_0x26dccc(0x114));},0x7d0);}document[_0x250418(0xae)][_0x250418(0xaa)](_0x15b45b);}
